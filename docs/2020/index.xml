<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" 
     xmlns:atom="http://www.w3.org/2005/Atom"
     xmlns:content="http://purl.org/rss/1.0/modules/content/"
     xmlns:dc="http://purl.org/dc/elements/1.1/"
     xmlns:media="http://search.yahoo.com/mrss/">
  <channel>
    <title>2020s auf Nicky Reinert</title>
    <link>https://nickyreinert.de/2020/</link>
    <description>Blog &amp; Projekte von Nicky Reinert (Institut für digitale Herausforderungen): Webentwicklung &amp; Software Development, SEO &amp; Analytics, Hosting &amp; DevOps, WordPress &amp; Hugo, Tools &amp; Projekte, Datenschutz und digitale Kultur – plus Texte zu KI sowie Autismus &amp; Gesellschaft.</description>
    <generator>Hugo 0.148.2</generator>
    <language>de</language>
    <managingEditor></managingEditor>
    <webMaster></webMaster>
    <copyright></copyright>
    <lastBuildDate>Wed, 09 Dec 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://nickyreinert.de/2020/index.xml" rel="self" type="application/rss+xml" /><item>
      <title>Einführung in Stemming und Lemmatisierung deutscher Texte mit Python</title>
      <link>https://nickyreinert.de/2020/2020-12-09-einfuehrung-in-stemming-und-lemmatisierung-deutscher-texte-mit-python/</link>
      <pubDate>Wed, 09 Dec 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-12-09-einfuehrung-in-stemming-und-lemmatisierung-deutscher-texte-mit-python/</guid>
      <description>Um beim Text Mining zusammengehörende Wörter zu gruppieren, bedient man sich im Natural Language Processing (NLP) zweier Methoden: Lemmatisierung (lemmatising) …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine technische Einführung und ein Vergleich verschiedener Python-Bibliotheken für das Stemming und die Lemmatisierung deutscher Texte. Der Artikel erklärt die Konzepte, stellt Bibliotheken wie NLTK, SpaCy, HannoverTagger und IWNLP vor, zeigt deren Installation und Anwendung anhand von Code-Beispielen und vergleicht ihre Ergebnisse bei der Normalisierung deutscher Wörter.</p>
          
          
          <p><strong>Hauptthemen:</strong> Python, Natural Language Processing, NLP, Text Mining, Stemming, Lemmatisierung, Data Science</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p>Um beim <strong>Text Mining</strong> zusammengehörende Wörter zu gruppieren, bedient man sich im <strong>Natural Language Processing</strong> (<strong>NLP</strong>) zweier Methoden: <strong>Lemmatisierung</strong> (lemmatising) und <strong>Stemming</strong>. Das ist notwendig, um z.B. einen Text besser kategorisieren bzw. mit Stichworten versehen zu können. Eines der wichtigsten Anwendungsgebiete ist sicherlich die Indexierung von Dokumenten durch eine Suchmaschine. Ein ganz einfaches Beispiel: Enthält ein Dokument sehr oft das Wort <em>Häuser</em> und der Nutzer sucht nach dem Begriff <em>Haus</em>, wird das relevante Dokument wohl nicht in den Suchergebnissen auftauchen.</p>
<p>Um das zu umgehen, müssen flektierte und abgeleitete Wörter zu Ihrer Grundform zurückgeführt werden. Beim <strong>Stemming</strong> werden dazu einfache heuritische Methoden angewendet, bei dem das Suffix der Wörter entfernt wird. Aus dem Wort <em>Katzen</em> wird so dessen Grundform <em>Katze</em>. Bei der Plural-Form <em>Häuser</em> ist das etwas schwieriger. Mit dem Abschneiden des Suffixes kommt man hier nicht weit, weshalb man sich bei der <strong>Lemmatisierung</strong> an Listen bzw. Datenbanken orientiert, die die reflektierte Formen enthalten und so eine sichere Verknüpfung von <em>Häuser</em> zur Singular-Form <em>Haus</em> erlauben.</p>
<p>Soviel zur Theorie. In der Praxis gibt es <strong>Python</strong> und eine Vielzahl von Modulen, die einem eine Menge Arbeit abnehmen. Im Folgenden vergleiche ich ein halbes Dutzend Module, die die <strong>Lemmatisierung</strong> und das <strong>Stemming</strong> beherrschen und auch für <strong>Deutsche Texte</strong> anwendbar sind.</p>
<p><em>Hinweis: Zur Vorbereitung beim Text Mining gehören natürlich auch das Säubern des Textes, Entfernen von Stop-Wörtern und das <strong>Tokenizing</strong>, also Aufbrechen eines Satzes in seine einzelnen Bestandteile. Diesen Schritt überspringe ich hier.</em></p>
<h2 id="stemming-mit-porter-lancaster-und-snowball">Stemming mit Porter, Lancaster und Snowball</h2>
<p>Für das Stemming habe ich mir drei Module angeschaut:</p>
<ul>
<li>Porter Stemmer</li>
<li>Lancaster Stemmer</li>
<li>Snowball Stemmer</li>
</ul>
<p>Der <strong>Porter Stemmer</strong> wurde bereits 1979 von <strong>Martin F. Porter</strong> entwickelt und <a href="https://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html">gilt zumindest in der englischen Sprache als sehr effektiv</a>. Der <strong>Lancaster Stammer</strong> geht auf den Ende der 1980er Jahre an der Lancaster University von <strong>Chris Paice</strong> und <strong>Gareth Husk</strong> entwickelten Paice-Husk Stemming Algorithmus zurück. Im Gegensatz zum festen Regelsatz von Porter wird <a href="https://www.scientificpsychic.com/paice/paice.html">beim Lancaster mit externen Regeln gearbeitet</a>, womit der Algorithmus flexibler ist.</p>
<p>Der Snowball Stemmer ist eigentlich kein eigener Algorithmus, <a href="https://www.datacamp.com/community/tutorials/stemming-lemmatization-python">sondern eine Sprache</a>, um einen eigenen Stemmer zu schreiben.</p>
<h3 id="installation-und-anwendung">Installation und Anwendung</h3>
<p>Alle drei Module sind Bestandteil des <a href="https://www.nltk.org/">Natural Language Toolkit</a> und können dementsprechend sehr unkompliziert mit <strong>pip install nltk</strong> installiert werden. Danach sieht ein Anwendungsbeispiel folgendermaßen aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl"> from nltk.stem import PorterStemmer
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"> from nltk.stem import LancasterStemmer
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"> from nltk.stem.snowball import SnowballStemmer
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"> porter = PorterStemmer()
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"> lancaster = LancasterStemmer()
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"> snowball = SnowballStemmer(&#34;german&#34;)
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"> word = &#39;Katzen&#39;
</span></span><span class="line"><span class="ln">10</span><span class="cl"> 
</span></span><span class="line"><span class="ln">11</span><span class="cl"> print (&#39;Porter: &#39; + porter.stem(word))
</span></span><span class="line"><span class="ln">12</span><span class="cl"> print (&#39;Lancaster: &#39; + lancaster.stem(word))
</span></span><span class="line"><span class="ln">13</span><span class="cl"> print (&#39;Snowball: &#39; + snowball.stem(word))
</span></span></code></pre></div><p>Da Snowball mehrere Sprachen unterstützt, muss hier vorher festgelegt werden, mit welcher Sprache wir arbeiten. Der Rest ist eigentlich ziemlich straight forward. Das Ergebnis zeigt aber die Schwächen des Stemmings:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Porter: katzen 
</span></span><span class="line"><span class="ln">2</span><span class="cl">Lancaster: katz 
</span></span><span class="line"><span class="ln">3</span><span class="cl">Snowball: katz 
</span></span></code></pre></div><p>Keiner der Stemmer kommt auf <em>Katze</em>. Klar: Hier werden einfach nur ein paar Buchstaben abgeschnitten. Da Porter nicht für die deutsche Sprache ausgelegt ist, wird hier sogar die reflektierte Form zurückgegeben. Das Stemming kann also dabei helfen, reflektierte Wörter auf einen gemeinsamen Stamm zu reduzieren. Die Bedeutung geht dabei aber oft verloren.</p>
<p>Genau deshalb gibt es die <strong>Lemmatisierung</strong>&hellip;</p>
<h2 id="lemmatisieren-mit-hannovertagger-wordnet-spacy-und-iwnlp">Lemmatisieren mit HannoverTagger, WordNet, Spacy und IWNLP</h2>
<p>Für die Lemmatisierung habe ich vier Module herausgesucht. Vor allem <a href="https://www.machinelearningplus.com/nlp/lemmatization-examples-python/">für die englische Sprache ist die Auswahl aber weitaus größer</a>, für deutsche Texte ist es hingegen schwierig, aktuelle und gepflegte Module zu finden.</p>
<ul>
<li>WordNet</li>
<li>SpaCy</li>
<li>HannoverTagger</li>
<li>IWNLP</li>
</ul>
<p>Das <strong>WordNet</strong> Modul gehört ebenfalls zum NLTK und ist einer der am weitesten verbreiteten Lemmatiser. Das Modul wurde 2001 entwickelt; <strong>WordNet</strong> selber ist eine riesige lexikalische Datenbank, die seit 1985 an der <strong>Princeton University</strong> entwickelt wird und mittlerweile über 200 Sprachen unterstützt.</p>
<p><strong>SpaCy</strong> ist vergleichsweise jung (2015) aber mittlerweile auch sehr weit verbreitet. Im Gegensatz zum NLTK, dass eine Vielzahl von Lösungen und Algorithmen mitbringt, konzentriert sich SpaCy auf genau einen Algorithmus, um ein Problem zu lösen und ist damit ein wenig fokussierter als das NLTK. Während das NLTK eher im Forschungsbereich anzutreffen ist, wird SpaCy vornehmlich im produktiven Bereich verwendet.</p>
<p>Der <strong>HannoverTagger</strong>, kurz <strong>HanTa</strong> - <a href="https://www.rki.de/DE/Content/Infekt/EpidBull/Merkblaetter/Ratgeber_Hantaviren.html">nicht zu verwechseln mit dem gleichnamigen Virus</a>, wurde 2019 <a href="https://textmining.wp.hs-hannover.de/Preprocessing.html">an der Hochschule Hannover</a> entwickelt. HanTa wurde mit dem Ziel entwickelt, auch für deutsche Texte eine vernünftige Lemmatisierungs-Lösung zu besitzen.</p>
<p>Daneben gibt es noch <a href="https://github.com/Liebeck/spacy-iwnlp">IWNLP</a> von <strong>Matthias Liebeck</strong>. IWNLP ist der Name der entsprechenden SpaCy-Erweiterung für <a href="https://github.com/Liebeck/iwnlp-py">IWNLP-py</a>, was wiederum die Python-Implementierung von IWNLP ist: <strong>Inverse Wiktionary for Natural Language Processing</strong>. IWNLP nutzt zur Lemmatisierung einfach den Deutschen Bereich des Wiktionaries.</p>
<h3 id="was-ist-mit-germalemma-und-german-lemmatizer">Was ist mit GermaLemma und German Lemmatizer?</h3>
<p><strong><a href="https://github.com/WZBSocialScienceCenter/germalemma">GermaLemma</a></strong> ist ein weiteres, recht junges Modul von <strong>Markus Konrad</strong>, das aber leider die <strong>POS</strong> der Wörter erfordert. POS steht für <strong>Part-Of-Speech</strong>, also die Wortart, wie z.B. Substantiv, Verb, Adjektiv und so weiter. Da alle anderen Lemmatizer ohne die POS arbeiten und ich die einfachste Lösung gesucht habe, bleibt dieses Modul außen vor.</p>
<p>Eine weitere Lösung wäre <a href="https://pypi.org/project/german-lemmatizer/">Docker-Image</a> mit dem Namen <strong>German Lemmatizer</strong> gewesen, dass die Funktionen von <strong>INWLP</strong> und <strong>GermaLemma</strong> kombiniert. Das ganze lässt sich aber leider nur mit etwas Mehraufwand auch außerhalb von Docker nutzen, weshalb ich auch den <strong>German Lemmatizer</strong> hier nicht berücksichtigt habe.</p>
<p><strong>WordNet</strong> kann Wörter übrigens ohne POS lemmatisieren, die Ergebnisse sind mit POS aber weitaus genauer. Die Klassifizierung des POS ist freilich keine Raketenwissenschaft und <a href="https://www.machinelearningplus.com/nlp/lemmatization-examples-python/">z.B. hier recht gut beschrieben</a>.</p>
<h3 id="installation-und-anwendung-1">Installation und Anwendung</h3>
<p>Da wir oben schon das NLTK installiert haben, können wir direkt auf WordNet zugreifen. SpaCy installieren wir mit <strong>pip install spacy</strong>, dort wird dann auch gleich IWNLP mitgeliefert. Der HanTa lässt sich ebenfalls unkompliziert installieren: <strong>pip install HanTa</strong>.</p>
<p>Um IWNLP zum Laufen zu bringen, benötigen wir noch <a href="http://lager.cs.uni-duesseldorf.de/NLP/IWNLP/">den letzten Dump von hier</a> (letzter Stand 2018/10/01). Das Archiv enthälte eine JSON-Datei - das Lexikon mit etwa drölfizigtausend Lemmas. Um SpaCy für die deutsche Sprache anwendbar zumachen, <a href="https://spacy.io/models/de/">müssen wir hier ein komplettes Modell herunterladen</a>. Das übernimmt SpaCy für uns mit folgendem Befehl:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spacy</span> <span class="n">download</span> <span class="n">de_core_news_md</span>
</span></span></code></pre></div><p><em>(Es gibt drei verschieden große Modelle, ich habe mich für die goldene Mitte entschieden).</em></p>
<p>Die Implementierung ist dann etwas aufwendiger, da bei der Lemmatisierung Trainingsmodelle eingesetzt werden, und nicht nur &ldquo;einfache&rdquo; Algorithmen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"> <span class="n">from</span> <span class="n">HanTa</span> <span class="n">import</span> <span class="n">HanoverTagger</span> <span class="n">as</span> <span class="n">ht</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"> <span class="n">from</span> <span class="n">nltk</span><span class="o">.</span><span class="n">stem</span> <span class="n">import</span> <span class="n">WordNetLemmatizer</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"> <span class="n">from</span> <span class="n">spacy_iwnlp</span> <span class="n">import</span> <span class="n">spaCyIWNLP</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"> <span class="n">import</span> <span class="n">spacy</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"> <span class="n">hannover</span> <span class="o">=</span> <span class="n">ht</span><span class="o">.</span><span class="n">HanoverTagger</span><span class="p">(</span><span class="s1">&#39;morphmodel_ger.pgz&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"> <span class="n">wordnet</span> <span class="o">=</span> <span class="n">WordNetLemmatizer</span><span class="p">()</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"> <span class="n">spc</span> <span class="o">=</span>  <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/usr/local/lib/python3.9/site-packages/de_core_news_md/de_core_news_md-2.3.0&#39;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;parser&#39;</span><span class="p">,</span> <span class="s1">&#39;ner&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl"> 
</span></span><span class="line"><span class="ln">11</span><span class="cl"> <span class="n">iwnlp</span> <span class="o">=</span> <span class="n">spc</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"> <span class="n">iwnlp_pipe</span> <span class="o">=</span> <span class="n">spaCyIWNLP</span><span class="p">(</span><span class="n">lemmatizer_path</span><span class="o">=</span><span class="s1">&#39;/Users/user1/Downloads/IWNLP.Lemmatizer_20181001.json&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"> <span class="n">iwnlp</span><span class="o">.</span><span class="n">add_pipe</span><span class="p">(</span><span class="n">iwnlp_pipe</span><span class="p">)</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"> 
</span></span><span class="line"><span class="ln">15</span><span class="cl"> <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;HanTa:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">hannover</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">word</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl"> <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Wordnet:&#39;</span> <span class="o">+</span> <span class="n">wordnet</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="s1">&#39;NN&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"> <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;SpaCy:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">token</span><span class="o">.</span><span class="n">lemma_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">spc</span><span class="p">(</span><span class="n">word</span><span class="p">)][</span><span class="mi">0</span><span class="p">]))</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"> <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;IWNLP:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">([</span><span class="n">token</span><span class="o">.</span><span class="n">lemma_</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">iwnlp</span><span class="p">(</span><span class="n">word</span><span class="p">)][</span><span class="mi">0</span><span class="p">]))</span>
</span></span></code></pre></div><p>Dem HannoverTagger wird bei der Initialisierung das entsprechende Modell mitgegeben. WordNet benötigt keine weiteren Parameter. Der <strong>SpaCy-Lemmatiser</strong> (hier spc) wird mit dem deutschen News Paket über <em>spacy.load()</em> initialisiert. Alternativ funktioniert die Initialisierung auch über den Shortcut <em>de</em>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"> <span class="n">spc</span> <span class="o">=</span> <span class="n">spacy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;de&#39;</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;parser&#39;</span><span class="p">,</span> <span class="s1">&#39;ner&#39;</span><span class="p">])</span>
</span></span></code></pre></div><p>Um den Vorgang etwas zu beschleunigen, deaktivieren wir die Funktionen <em>parser</em> und <em>ner</em>. Der Parser macht bei der Verarbeitung von Sätzen Sinn, <em>ner</em> steht für <strong>Name Entity Recognition</strong>, sprich die Erkennung von Eigennamen. Das ist bei der Lemmatisierung durchaus wichtig, möchte ich hier aber erstmal nicht berücksichtigen.</p>
<p>Da <strong>IWNLP</strong> ebenfalls über SpaCy aktiviert wird, klonen wir das Objekt einfach und fügen dann unsere eigene Pipeline hinzu <em>add_pipe()</em>. Diese muss auf das Lexikon als JSON-Datei verweisen, den wir vorher heruntergeladen haben. Das wars auch schon, danach sehen wir, wie sich die Module untereinander und im Vergleich zum Stemming schlagen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">HanTa:Katze 
</span></span><span class="line"><span class="ln">2</span><span class="cl">Wordnet:Katzen
</span></span><span class="line"><span class="ln">3</span><span class="cl">SpaCy:Katze
</span></span><span class="line"><span class="ln">4</span><span class="cl">IWNLP:Katze 
</span></span></code></pre></div><p>Das Ergebnis überrascht nur ein kleines bisschen: Obwohl die eigentliche WordNet-Datenbank 200 Sprachen unterstützt, schafft es das Modul nicht, das richtige Lemma zuzuordnen. Ich finde leider auch keine Informationen dazu, wie WordNet auf Deutsch getrimmt werden kann. Die Ergebnisse von HanTa, SpaCy und IWNLP passen allerdings. IWNLP (und demnach auch SpaCy) liefern bei Bedarf übrigens mehr als nur ein Lemma zurück:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl"> print (str([token._.iwnlp_lemmas for token in iwnlp(word)][0]))
</span></span><span class="line"><span class="ln">2</span><span class="cl"> print (str([token.pos_ for token in iwnlp(word)][0]))
</span></span></code></pre></div><p>Mit <strong>pos_</strong> und <strong>_.iwnlp_lemmas</strong> bekommt man einerseits den Part-Of-Speech und in IWNLP sogar eine Liste aller denkbaren Lemmas - sofern zutreffend.</p>
<p>Wer den Vergleich etwas hübscher aufbereitet für mehrer Wörter nutzen will, <a href="https://gist.github.com/nickyreinert/72548ce88d812f9203687ece93c608d8">kann dazu folgendes Jupyter-Notebook nutzen</a>. Ich hab das ganze mal <a href="https://www.spiegel.de/wissenschaft/mensch/uno-bericht-ueber-klimaziele-auf-dem-weg-zu-drei-grad-erderwaermung-a-05ecdcdb-2f84-4aa0-84b6-a7a2d8c71c80">für eine beliebige Schlagzeile von Spiegel Online</a> durchgespielt und folgendes Ergebnis erhalten. Der Original-Satz lautet:</p>
<blockquote>
<p>Der weltweite CO₂-Ausstoß steigt weiter – trotz Corona-Knick, heißt es im neuen Bericht des Uno-Umweltprogramms. Ohne grüne Konjunkturpakete sei das Pariser Zwei-Grad-Limit nicht mehr zu retten.</p></blockquote>
<p>Und das ist das Ergebnis nach dem <strong>Steming</strong> und <strong>Lemmatisieren</strong>:</p>
<p><a href="https://www.nickyreinert.de/files/eine-kleine-einfuhrung-in-das-stemming-lemmatisieren-deutscher-texte/grafik.png"><img src="/2020/2020-12-09-einfuehrung-in-stemming-und-lemmatisierung-deutscher-texte-mit-python/images/grafik-700x249.png" alt=""></a></p>
<p>7 Methoden zum Stemming und Lemmatisieren im Vergleich</p>
<p>Das Stemming liefert, naturgemäß, ein relativ grobes Ergebnis ab. Um die Wörter in einem Text schnell zu kategorisieren reicht das sicherlich aus. Bei der Lemmatisierung fällt auf, das SpaCy trotz deutscher Sprachpakete nicht ganz zufriedenstellend arbeitet. So wird aus &ldquo;das&rdquo; z.B. &ldquo;der&rdquo;. Dafür wird &ldquo;trotz&rdquo; korrekt &ldquo;trotzen&rdquo; zugeordenet - was dem HanTa nicht gelingt. HanTa wiederum kennt als einziger den Singular von Konjunkturpakete.</p>
<h2 id="fazit">Fazit</h2>
<p>Die Verarbeitung englischer Texte ist, aufgrund der großen Verbreitung der Sprache, gar kein Problem. Bei deutschen Texten wird es schon etwas schwieriger, allerdings liefern <strong>HanTa</strong>, <strong>IWNLP</strong> und auch <strong>SpaCy</strong> recht gute Ergebnisse ab. Mein subjektiver Favorit ist <strong>HanTa</strong>. Aber die Stichprobe ist viel zu gering, um hier einen klaren Favoriten identifizieren zu können.</p>
<p>Der Vergleich dient eher nicht als repräsentivate Untersuchung aller denkbaren Varianten, soll aber einen kleinen Einblick in <strong>NLP</strong> und die automatisierte Text-Verarbeitung im <strong>Text-Mining</strong> geben und ein paar Code-Beispiele liefern, um den Einsteig in Python zu erleichtern. Ich hoffe das ist gelungen!</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> Python, NLP, Tutorial, Data-Science, Text-Mining</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Einführung in Stemming und Lemmatisierung deutscher Texte mit Python - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>technical_comparison</dc:type>
      
      
    </item><item>
      <title>Wie funktionieren Dateirechte?</title>
      <link>https://nickyreinert.de/2020/2020-11-05-wie-funktionieren-dateirechte/</link>
      <pubDate>Thu, 05 Nov 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-11-05-wie-funktionieren-dateirechte/</guid>
      <description>Die korrekten Dateirechte sollten eine wichtige Rolle spielen, wenn du an einem Sicherheitskonzept für deine Webseite bzw. Wordpress arbeitest. Leider wird das …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine detaillierte Anleitung zum Verständnis und zur korrekten Konfiguration von Dateirechten auf einem Linux-Webserver, speziell für WordPress. Der Artikel erklärt die Grundlagen von Benutzern, Gruppen und den Rechten (Lesen, Schreiben, Ausführen) und demonstriert die Anwendung von &#39;chmod&#39; und &#39;chown&#39;. Es werden sichere, praxisnahe Konfigurationen und Skripte zur Härtung einer WordPress-Installation vorgestellt.</p>
          
          
          <p><strong>Hauptthemen:</strong> Linux, Server-Administration, Web-Sicherheit, WordPress, Dateirechte, SysAdmin</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p>Die korrekten <strong>Dateirechte</strong> sollten eine wichtige Rolle spielen, wenn du an einem Sicherheitskonzept für deine Webseite bzw. Wordpress arbeitest. Leider wird das Thema Dateirechte oft stiefmütterlich behandelt, nicht zuletzt weil es fälschlicherweise als zu kompliziert angesehen wird. Dabei muss es das gar nicht sein: Das Grundprinzip ist einfach: Du willst nicht, dass jedermann Dateien <strong>ändern</strong>, <strong>ausführen</strong> oder <strong>lesen</strong> kann. Sicherlich gibt es feine Abstufungen. und genau die möchte ich hier erklären.</p>
<p>Achtung: Das Ziel dieses Beitrags ist nicht, dir eine fertige Lösung für deine WordPress-Installation bzw. dein Projekt zu geben. Das ist nicht möglich. Warum? Es gibt zig unterschiedliche Konfigurationen. Es mag allgemeingültige Lösungen geben, diese sind aber bei weitem nicht sicher. Stichwort: chmod 777 * -R</p>
<p>Du solltest nach der Lektüre aber das Konzept verstehen und vielleicht sogar in der Lage sein, die Dateirechte selbstständig zu setzen.</p>
<h2 id="die-grundlagen-wie-verarbeitet-ein-web-server-anfragen">Die Grundlagen: Wie verarbeitet ein Web-Server Anfragen?</h2>
<p>Jetzt fragst du dich sicherlich, was das mit Dateirechten zu tun hat? Was passiert, wenn du auf einer Webseite surfst? Folgende Vereinfachung dürfte das konzept hilfreich beschreibe: Der Web-Server schickt eine Datei an deinen Browser. Und du kannst Dateien an den Web-Server schicken, sprich hochladen. Wer also verstehen will, wie Dateirechte gesetzt werden müssen, sollte das Grundkonzept eines Servers verstehen.</p>
<p>Wie sieht diese Kommunikation mit dem Server also im Detail aus? Du schickst über deinen Browser eine Anfrage (<a href="https://nickyreinert.de/index.html">http://nickyreinert.de/index.html</a>) an den Server (was auch nur irgendein anderer Computer auf der Welt ist, egal ob in der Cloud oder in einem Keller). Auf dem Server laufen verschiedene Dienste - die verwirrenderweise auch als Server bezeichnet werden.</p>
<p><img src="https://pbs.twimg.com/media/D864DxrWsAAmvXi?format=png&amp;name=small" alt="Bild"></p>
<p>Die Cloud ist auch nur der Computer von jemand anders</p>
<p>Einer dieser Dienste ist der <strong><a href="https://de.wikipedia.org/wiki/Internetdienst#Die_Internetdienste_im_Einzelnen">HTTP-Dienst</a></strong>. Sehr verbreitet sind <strong>Apache2</strong> und <strong>nginx</strong>. Das Konzept ist bei beiden gleich: Sie empfangen deine Anfrage und schicken dir eine Antwort. Bei dieser Antwort unterscheidet man grob zwischen <strong>statische Inhalten</strong> (HTML-Datei, Texte, Bilder, &hellip;), die der <strong>HTTP-Dienst</strong> direkt zurückschickt und <strong>dynamischen Inhalten</strong>. Dynamische Inhalte müssen auf dem Server erst verarbeitet werden, wie z.B. Datenbankabfragen oder ganz simpel die Darstellung der aktuellen Uhrzeit: <a href="https://nickyreinert.de/dynamisch.php">https://nickyreinert.de/dynamisch.php</a>. Das ermöglicht ein <strong>PHP-Dienst</strong> bzw. <strong>PHP-Interpreter</strong>.</p>
<p>Im Kontext der Dateirechte muss man hier eine wichtige Unterscheidung treffen: Der PHP-Interpreter ist entweder Teil des HTTP-Dienstes (<strong>PHP-Modul</strong>). Damit ist z.B. <strong>Apache2</strong> in der Lage, die PHP-Datei quasi selber zu interpretieren, und den dynamischen Inhalt für die Antwort zu erzeugen. Oder der PHP-Dienst ist ein getrennt laufender Dienst bzw. Prozess, der über eine Schnittstelle (CGI) vom HTTP-Dienst angesprochen wird (<a href="http://www.php-faq.de/q/q-php-cgi-vs-modul.html">mehr dazu hier</a>).</p>
<p>Um Informationen auf dem Server zu speichern, gibt es zwei Möglichkeiten: Zum einen wäre da die Datenbank, wie z.B. <strong>MySQL</strong> oder <strong>MariaDB</strong>. Der PHP-Dienst nutzt die Datenbank, um Informationen abzulegen, die in der Regel volatil sind. Wie z.B. Kommentare oder Texte für deinen Blog. Und es gibt das <strong>Dateisystem</strong>. Ganz banal ausgedrückt ist das die Festplatte des Servers. Und genau dort brauchst du Dateirechte. Die folgende Abbildung zeigt die beiden oben erwähnten Konfigurationen: In der ersten Konfiguration sind HTTP- und PHP-Dienst getrennte Dienste, in der zweiten Konfiguration nutzt der HTTP-Dienst PHP als integriertes Modul.</p>
<p>Die Abbildung zeigt außerdem ein beispielhaftes Dateisystem mit einigen ausgewählten Dateien und Ordnern, die dir von WordPress bekannt vorkommen dürften.</p>
<ul>
<li>
<p><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/Folie1.png"><img src="/2020/2020-11-05-wie-funktionieren-dateirechte/images/Folie1-700x394.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/Folie2.png"><img src="/2020/2020-11-05-wie-funktionieren-dateirechte/images/Folie2-700x394.png" alt=""></a></p>
</li>
</ul>
<p>Der vierte Dienst im Bunde ist übrigens der <strong>FTP-Dienst</strong>. Dieser ermöglicht es (in der Regel dem Web-Entwickler) sich per <strong>FTP</strong> auf den Server zu verbinden und Dateien über einen FTP-Client hochzuladen, zu bearbeiten oder zu löschen.</p>
<h2 id="lesen-schreiben-ausführen---was-bedeutet-das-eigentlich">Lesen, Schreiben, Ausführen - Was bedeutet das eigentlich?</h2>
<p>Wenn es um die Fähigkeit &ldquo;Ausführen&rdquo; geht, muss man streng zwischen Ordnern und Dateien unterscheiden. Das <strong>Ausführen</strong> von Dateien, egal welche Endung sie haben, ist in <strong>keiner Konfiguration notwendig</strong>! Das Ausführen von Ordern hingegen ermöglicht den Zugriff auf den Ordner. Jeder Ordner deiner WordPress-Installation darf also ausführbar sein.</p>
<p>Das <strong>Lesen</strong> eines Ordners ermöglicht einem Dienst, die Ordner-Inhalte aufzulisten. Das Lesen einer Datei ermöglicht einem Dienst den Inhalt einer Datei darzustellen. Und das ist bereits ein sicherheitskritisches Merkmal: Nicht jeder Dienst muss bzw. darf jede Datei lesen. Der HTTP-Dienst benötigt z.B. keinen lesenden Zugriff auf PHP-Dateien. Und erst Recht nicht auf z.B. die wp-config.php - in der sich ja das Passwort für die Datenbank befindet. Der HTTP-Dienst reicht die Anfrage für die dynamische PHP-Datei in der Regel an den PHP-Dienst weiter. Gleichwohl muss der HTTP-Dienst statische Inhalte lesen können. Vor allem bei den Leserechten gibt es also sehr viele Feinheiten zu beachten.</p>
<p>Wer <strong>Schreibrechte</strong> für einen Ordner hat, kann darin Dateien anlegen bzw. den Ordner löschen oder umbenennen. Das Schreibrecht für eine Datei ermöglicht das Löschen der Datei und das Ändern der Inhalte. Grundsätzlich sollte kein Dienst Schreibrechte im Dateisystem besitzen. So vermeidet man z.B., dass jemand Schadcode in eine PHP-Datei einfügt. Der PHP-Dienst kann Informationen in der Datenbank ablegen und für den HTTP-Dienst gibt es erstmal keinen Grund, überhaupt Dateien ändern oder anlegen zu müssen.</p>
<p>Natürlich gibt es Ausnahmen. Z.B. benötigt der PHP-Dienst Schreibrechte, wenn Dateien von WordPress oder der Plugins aktualisiert werden müssen. Oder ein Nutzer Dateien hochladen möchte (Hier kommt übrigens eine andere wichtige Sicherheitseinstellung zum Tragen: Man kann unterbinden, dass der PHP-Dienst Dateien aus dem Upload-Ordner als PHP-Dateien verarbeitet.)</p>
<p>Wie wir diese Dateirechte setzen, dazu gleich mehr.</p>
<h2 id="besitzrechte-einer-datei">Besitzrechte einer Datei</h2>
<p>Vorher schauen wir uns noch die Besitzverhältnisse von Dateien und Ordnern an. Diese lassen sich einem <strong>Besitzer</strong> und einer <strong>Gruppe</strong> zuordnen. Jeder der oben genannten Dienste kann, ganz abstrakt betracht, als <strong><em>Nutzer</em></strong> verstanden werden. Und damit entweder <strong>direkt Besitzer</strong> einer Datei oder eines Ordners sein. Oder <strong>indirekt</strong>, über die <strong>Gruppenzugehörigkeit</strong>.</p>
<p>Eine Datei gehört also zu einem Besitzer und zu einer Gruppe von Besitzern. Der Besitzer muss nicht zwingend Teil der Gruppe sein. Der <strong>Besitzer</strong> kann bestimmte Rechte für diese Datei besitzen, wie z.B. <strong>Lesen</strong> und <strong>Schreiben</strong>. Einer <strong>Gruppe</strong> von Besitzern werden auch individuelle Rechte zugesprochen, wie z.B. nur das <strong>Lesen</strong>. Und dann gibt es noch &ldquo;<strong>alle anderen</strong>&rdquo;, die vielleicht gar <strong>keine Zugriffsrechte</strong> auf eine Datei haben. Am Beispiel von <strong>index.html</strong> sieht das folgendermaßen aus:</p>
<p><em>index.html:</em></p>
<ul>
<li><strong>Besitzer</strong>: FTP-Dienst, darf lesen und schreiben,</li>
<li><strong>Gruppe</strong>: WWW-Data, darf lesen,</li>
<li><strong>alle andern</strong>: keine Rechte</li>
</ul>
<p>Und das enstpricht auch schon der klassischen Rechtevergabe von Dateien. Schreibrechte werden nur dem Besitzer eingeräumt. Die Gruppe darf bestenfalls lesen. Natürlich gibt es Sonderfälle, wie das Aktualisieren von WordPress oder von Plugins, dazu später mehr.</p>
<h2 id="wie-funktionieren-chown-und-chmod">Wie funktionieren chown und chmod?</h2>
<p>Du wirst es sicher schon mal gehört haben: Dateirechte werden mit <strong>chown</strong> und <strong>chmod</strong> konfiguriert. chown steht für &ldquo;change owner&rdquo; - also &ldquo;ändere den Besitzer&rdquo; und chmod für &ldquo;change mode&rdquo;, &ldquo;ändere den Modus&rdquo;.</p>
<p>Zu Demonstrationszwecken gehen wir von der folgenden Konfiguration aus, die zwar bei weitem nicht die sicherste, dafür aber weit verbreitet ist:</p>
<p>Die <em>Nutzer</em> für den PHP- und HTTP-Dienst sind in der Gruppe <strong>www-data</strong> zusammengefasst. Daneben gibt es den FTP-Dienst (<strong>ftp-user</strong>).</p>
<p><strong>Ftp-user</strong> bekommt alle Rechte: Lesen, Schreiben, usw. Die Nutzer der Gruppe <strong>www-data</strong> bekommen nur lesenden Zugriff - vorerst!</p>
<p>Jede Datei und jeder Ordner sollen dem <strong>ftp-user</strong> gehören, gleichzeitig aber auch zur Gruppe <strong>www-data</strong>. Das lässt sich mit <strong>chown</strong> folgendermaßen bewerkstelligen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">chown</span> <span class="n">ftp</span><span class="o">-</span><span class="n">user</span><span class="p">:</span><span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">www</span><span class="o">/*</span> <span class="o">--</span><span class="n">recursive</span>
</span></span></code></pre></div><p>Der erste Parameter definiert den Besitzer (ftp-user) und die Gruppenzugehörigkeit (www-data), immer getrent mit einem Doppelpunkt. Danach folgt der betroffene Ordner bzw. die Datei. Mit <strong>--recursive</strong> (oder kürzer <strong>-R</strong>) werden auch alle Unterordner und darin befindlichen Dateien angesprochen.</p>
<p>Bei den Dateirechten wird es etwas aufwendiger, zunächst der Aufruf:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">chmod</span> <span class="mi">640</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">www</span><span class="o">/*</span> <span class="o">-</span><span class="n">R</span>
</span></span></code></pre></div><p>Hier nutzen wir die Kurzschreibweise -R um alle Dateien und Ordner rekursiv zu ändern. Wichtig ist für uns die Ziffer hinter chmod: 640. Genau genommen handelt es sich um drei (oktale) Ziffern, nämlich 6, 4 und 0. Entsprechend der Position regeln sie die Zugriffsrechte für den</p>
<ul>
<li><strong>Besitzer</strong> (ftp-user, die 6 an erster Stelle),</li>
<li>die <strong>Gruppe</strong> (www-data) samt ihrer Mitglieder (HTTP-Dienst, die 4 an zweiter Stelle)</li>
<li>und an letzter Stelle alle anderen (<strong>others</strong> - die 0).</li>
</ul>
<p>Und wie entstehen die Ziffern 6, 4 und 0? Wir erinnern uns an die drei Zugriffsrechte:</p>
<ul>
<li>lesen,</li>
<li>schreiben sowie</li>
<li>ausführen.</li>
</ul>
<p>Jedes Recht besitzt einen Wert:</p>
<ul>
<li>Lesen (bzw. r für read) = 4</li>
<li>Schreiben (bzw. w für write) = 2</li>
<li>Ausführen (bzw. x für eXecute) = 1</li>
<li>Kein Recht = 0</li>
</ul>
<p><a href="https://www.nickyreinert.de/files/2227/berechnung-der-Dateirechte-fu%CC%88r-chmod.png"><img src="images/berechnung-der-Dateirechte-fu%CC%88r-chmod-300x167.png" alt="Die Berechnung der Dateirechte für chmod"></a></p>
<p>Die Berechnung der Dateirechte für chmod</p>
<p>Um Rechte zu kombinieren, bildet man deren Summe. Will man also alle Rechte vergeben, erechnet sich das folgendermaßen:</p>
<ul>
<li>Lesen + Schreiben + Ausführen = 4 + 2+ 1 = 7</li>
</ul>
<p>Nur Lese- und Schreibzugriff errechnet sich demnach so:</p>
<ul>
<li>Lesen + Schreiben = 6</li>
</ul>
<p>Die obene genannte chmod-Anweisung setzt also die folgenden Rechte um:</p>
<ul>
<li>Besitzer (ftp-user): 6 (Lesen, Schreiben)</li>
<li>Gruppe (www-data): 4 (Lesen)</li>
<li>Alle anderen (others): 0 (keine Rechte)</li>
</ul>
<p>Was heißt das? Der FTP-Nutzer darf als Besitzer alles: Dateien hochladen, löschen, bearbeiten usw. Jedes Mitglied der Gruppe www-data darf Dateien nur lesen. Jeder andere Nutzer (bzw. Dienst) darf gar nicht auf die Dateien in deinem WordPress-Projekt zugreifen. Das klingt sehr sicher, führt allerdings zu einem Problem: Dein Server dürfte so nicht funktionieren. Nimm als Beispiel diesen Aufruf: <a href="https://nickyreinert.de/ordner/">https://nickyreinert.de/ordner/</a></p>
<p>Die HTTP-Fehlermeldung <strong>403 Forbidden</strong> erscheint. Das sind die Zugriffsrechte für den Ordner, so wie wir sie eben gesetzt haben:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">drw-r----- 2 ftp-user www-data   4096 Okt 14 11:48 ordner/
</span></span></code></pre></div><p>In der zweiten Spalte sehen wir: Der Ordner gehört <strong>ftp-user</strong> und der Gruppe <strong>www-data</strong>.</p>
<p>Das <strong>d</strong> ganz am Anfang steht für <strong>directory</strong>, lies Ordner. Dann folgen die Dateirechte, die wir eben schon festgelegt haben: Zunächst drei Zeichen, die die Zugriffsrechte für den Besitzer (<strong>ftp-user</strong>) beschreiben: <strong>rw-</strong></p>
<p>Also Lesen (<strong>read)</strong> und Schreiben (<strong>write</strong>) (würde anstelle des <strong>-</strong> ein <strong>x</strong> stehen (<strong>eXecute)</strong>, stünde das für <strong>Ausführen</strong>). Die Gruppe <strong>www-data</strong> und alle ihre Mitglieder dürfen nur Lesen (r&ndash;). Alle anderen dürfen gar nichts (&mdash;).</p>
<p>Nun handelt es sich aber um einen Ordner. Ein Ordner kann aber nur &ldquo;betreten&rdquo; werden, wenn man die Genehmigung zum <strong>Ausführen</strong> hat. Weder der Besitzer noch die Gruppe hat diese Genehmigung. Unsere obere Anweisung reicht also nicht aus! Tatsächlich sollte man also <strong>Zugriffsrechte für Dateien und Ordner immer getrennt</strong> festlegen!</p>
<p>Berechtigung für alle Dateien:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">chmod</span> <span class="mi">640</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">www</span><span class="o">/*</span> <span class="o">-</span><span class="n">R</span>
</span></span></code></pre></div><p>Berechtigung für alle Ordner:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">chmod</span> <span class="mi">750</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">www</span><span class="o">/*</span> <span class="o">-</span><span class="n">R</span>
</span></span></code></pre></div><p>Du siehst, dass das Ermöglichen des Ausführens einfach durch das Addieren von 1 für die beiden ersten Positionen ermöglicht wird.</p>
<p>Tatsächlich findest du diese beiden Befehle auch in vielen Anleitungen zu Dateirechten und damit endet die Anleitung oft auch schon. Doch damit hast du ein Problem. Denn die zweite Anweisung überschreibt das Ergebnis der ersten Anweisung. Aber wir wollen doch Dateien und Ordner individuell einrichten! Abhilfe schafft der Befehl <strong>find</strong>, um Dateien und Ordner getrennt anzusprechen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">640</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">750</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span></code></pre></div><p>Der Parameter <strong>-type f</strong> liefert alle Dateien im angegeben Ordner zurück (f wie file, Datei). Der Punkt hinter htdocs in der ersten Zeile sorgt dafür, dass auch versteckte Dateien, wie z.B. die .htaccess-Datei, gefunden werden. Mit <strong>exec</strong> übergebe ich das Resultat von find, eine Liste die alle gefundenen Dateien enthält, an einen anderen Befehl. In dem Fall also <strong>chmod</strong>.</p>
<p>Vice versa für alle Ordner, die mit <strong>-type d</strong> gefunden werden. Hier wird mit chmod auch das Recht zum Ausführen vergeben.</p>
<h2 id="dateirechte-in-der-realität">Dateirechte in der Realität</h2>
<p>Das klingt erstmal recht einfach, hat aber drei Haken:</p>
<ol>
<li>Es gibt Dateien, die nur für den PHP-Dienst relevant sind, andere wiederum nur für den HTTP-Dienst. Man muss die Besitzrechte also etwas granularer vergeben.</li>
<li>Bei einem Update der Plugins oder WordPress müssen Dateien für die Gruppe www-data wenigstens temporär schreibbar sein.</li>
<li>Wenn man den Upload von Dateien zulassen möchte, muss der Ordner /wp-content/uploads dauerhaft beschreibbar sein.</li>
</ol>
<p>Es gibt also verschiedene <strong>Ordner- und Datei-Kategorien</strong>, die verschiedene Rechte erfordern. Die folgende Matrix zeigt, am Beispiel von WordPress, eine <strong>ideale</strong> Konfiguration:</p>
<p><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/grafik-4.png"><img src="/2020/2020-11-05-wie-funktionieren-dateirechte/images/grafik-4-700x315.png" alt=""></a></p>
<p>Die **.htaccess-**Datei muss für den PHP-Dienst gar nicht sichtbar, geschweige denn beschreibbar sein. Die Datei <strong>wp-config.php</strong> wiederum sollte für den HTTP-Dienst unsichtbar sein. Generell müssen PHP-Dateien, also dynamische Ressourcen, für den HTTP-Dienst gar nicht sichtbar sein. Der Upload-Ordner ist hier beschreibbar, um das Hochladen von Datein zu ermöglichen. Wird ein Cache verwendet, muss natürlich auch dieser Ordner beschreibbar sein.</p>
<p>Solltest du, z.B. auf deinem eigenen Webspace, die Möglichkeit haben, Besitzrechte derart granular zu konfigurieren, kann dir die Matrix vielleicht als Inspiration dienen. In der Realität hilft das aber nicht weiter, da der PHP-Dienst als Modul entweder innerhalb des HTTP-Dienstes läuft oder beide Dienste unter einer Gruppe (www-data) laufen (<a href="https://binary-butterfly.de/artikel/dateirechte-wie-stelle-ich-das-bei-meinem-hoster-ein/">hier wird das Problem noch etwas genauer beleuchtet</a>). Die Konfiguration sieht dann in etwa so aus:</p>
<p><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/grafik-5.png"><img src="/2020/2020-11-05-wie-funktionieren-dateirechte/images/grafik-5-700x288.png" alt=""></a></p>
<p>Nun stellst du dir sicher die Frage, wie du ein derartiges Setup möglichst unkompliziert einrichten kannst. Eins Vorweg: Ohne Zugriff auf die Shell wird das ziemlich aufwendig. Mit Zugriff auf die Kommandozeile kannst du die Dateirechte z.B. folgendermaßen setzen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">640</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">750</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">uploads</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">660</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">uploads</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">770</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">cache</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">660</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">cache</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">770</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span></code></pre></div><p>Wenn du Themes oder Plugins aktualisieren willst, musst du die Rechte folgendermaßen anpassen und somit Datein und Ordner schreibbar machen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">themes</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">660</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">themes</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">770</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">plugins</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">660</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">plugins</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">770</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span></code></pre></div><p>Beim Update von WordPress trifft das natürlich auf die ganze Installation zu:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">f</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">660</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">find</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">nginx</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/.</span> <span class="o">-</span><span class="n">type</span> <span class="n">d</span> <span class="o">-</span><span class="n">exec</span> <span class="n">chmod</span> <span class="mi">770</span> <span class="o">--</span> <span class="p">{}</span> <span class="o">+</span>
</span></span></code></pre></div><p>Wenn du keinen Zugriff auf die Kommandozeile hast, kannst du auch PHP nutzen, insofern du die Rechte dazu hast. Die Funktion lautet <a href="https://www.php.net/manual/de/function.chmod.php">chmod()</a>.</p>
<h2 id="ausführen-von-php-code-in-bestimmten-ordnern-unterbinden">Ausführen von PHP-Code in bestimmten Ordnern unterbinden</h2>
<p>Oben hatte ich das Problem mit dem Upload-Ordner angesprochen. Wenn Nutzer in der Lage sind, dort Dateien zu modifizieren oder abzulegen, ist das ein Sicherheitsrisiko. Du kannst das Risiko aber eindämmen, indem du dafür sorgst, dass Dateien in diesem Ordner schlicht nicht von PHP interpretiert, sprich ausgeführt, werden können.</p>
<p>So kann der Ordner beschreibbar bleiben, das Sicherheitsrisiko wird aber trotzdem reduziert. Dazu erstellst du eine .htaccess-Datei im uploads-Ordner mit diesem Inhalt:</p>
<p>SetHandler !
RemoveHandler .php .phtml .php3
RemoveType .php .phtml .php3
php_admin_value engine Off
php_flag engine off</p>
<p>Die beiden letzten Zeile sind redundant zu den vorherigen. Sie soll sicherstellen, dass PHP hier wirklich nicht funktioniert. Ein Angreifer ist somit vielleicht in der Lage, PHP-Code in diesem Ordner abzulegen aber nicht mehr, diesen auch auszuführen.</p>
<p>Bei nginx kannst du den Upload-Ordner einfach implizit von PHP abnabeln:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">$</span><span class="n">uri</span> <span class="o">!~</span> <span class="s2">&#34;^/uploads/&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">   <span class="n">fastcgi_pass</span> <span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">php</span><span class="o">/</span><span class="n">php</span><span class="o">-</span><span class="n">fpm</span><span class="o">-$</span><span class="n">server</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="fs_method">FS_METHOD</h2>
<p>Wenn du meinst, die Dateirechte korrekt vergeben zu haben und trotzdem fordert dich Wordpress beim Updaten auf, die FTP-Zugangsdaten einzugeben, setze diesen Parameter in der Datei wp-config.php:</p>
<p>define(&lsquo;FS_METHOD&rsquo;, &lsquo;direct&rsquo;);</p>
<p>WordPress weiß nun, dass es Dateien direkt anfassen darf, ohne den Umweg über den FTP-Nutzer zu gehen.</p>
<p>Dieser Parameter kann recht nützlich sein, wenn du die Dateirechte noch restriktiver vergeben willst, sprich: PHP gar keine Schreibrechte einräumst. Du musst dann einen FTP-Nutzer anlegen, über den WordPress sozusagen indirekt auf das Dateisystem zugreifen kann.</p>
<h2 id="wenig-aufwand-viel-nutzen">Wenig Aufwand, viel Nutzen</h2>
<p>Die Einarbeitung in die Benutzerrechte mit <strong>chmod</strong> mag anfangs vielleicht ungewohnt sein, mit etwa Übung hat man den Dreh aber recht schnell raus. Der Nutzen ist immens, denn die falsche Rechte-Vergabe ist ein häufiger Grund, warum bösartige Software sich überhaupt auf einem Server verbreiten kann. Es gibt noch eine Handvoll andere Maßnahmen, die relativ simpel und effektiv sind, denen ich mich in einem anderen Beitrag widmen möchte.</p>
<p>Zuguter Letzt: Willst du wissen, ob die Dateirechte in deiner Installation korrekt gesetzt wurden, kannst du auf dieses Script zurückgreifen. Ich habe dazu das Script von <a href="https://binary-butterfly.de/artikel/dateirechte-warum-eigentlich/">Ernesto Ruge</a> etwas überarbeitet, in der Funktionalität aber unverändert gelassen:</p>
<p><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/grafik-7.png"><img src="/2020/2020-11-05-wie-funktionieren-dateirechte/images/grafik-7-700x366.png" alt=""></a></p>
<p>Die korrekten Datei und Ordner-Rechte für WordPress prüfen</p>
<p><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/testFileFolderPermissions.php_-1.zip">testFileFolderPermissions.php_-1</a><a href="https://www.nickyreinert.de/files/wie-funktionieren-dateirechte/testFileFolderPermissions.php_-1.zip">Herunterladen</a></p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> chmod, dateirechte, sysop, wordpress</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>anleitungen</category>
      
      <category>hosting</category>
      
      <category>wordpress</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Wie funktionieren Dateirechte? - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>comprehensive_guide</dc:type>
      
      
    </item><item>
      <title>Online Marketing killed the Internet Star</title>
      <link>https://nickyreinert.de/2020/2020-10-24-marketing-killed-the-internet-star/</link>
      <pubDate>Sat, 24 Oct 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-10-24-marketing-killed-the-internet-star/</guid>
      <description>Das Internet. Unendliche Weiten. Wir schreiben das Jahr 2020. Das Internet hat eine beachtliche Menge populärer Dienste groß gemacht: E-Mail. Video-Streaming. …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine umfassende kritische Analyse der Entwicklung des Online-Marketings und dessen tiefgreifenden Auswirkungen auf das World Wide Web. Der Essay beleuchtet, wie die Jagd nach Werbeeinnahmen zu einer Verschlechterung der Inhaltsqualität, einem undurchsichtigen MarTech-Ökosystem und erheblichen Datenschutzproblemen geführt hat, und diskutiert mögliche Lösungsansätze für ein faireres Internet.</p>
          
          
          <p><strong>Hauptthemen:</strong> Online-Marketing, Digital-Ethik, Datenschutz, Medienkritik, Internet-Kultur, Ad-Tech, SEO</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p>Das Internet. Unendliche Weiten. Wir schreiben das Jahr 2020. Das Internet hat eine beachtliche Menge populärer Dienste groß gemacht: E-Mail. Video-Streaming. Vernetzte Kühlschränke. Smart-TV. Und allen voran das <strong>World Wide Web</strong>, kurz WWW oder auch das Web - für die meisten wohl der <strong>Star des Internets</strong>.</p>
<p>Online Marketing hat das Web vielleicht nicht umgebracht, aber mindestens nachhaltig geprägt. Doch <a href="https://www.youtube.com/watch?v=W8r-tXRLazs">der Song von The Buggles</a> heißt nun mal nicht <strong>Video hat den Radio-Star nachhaltig geprägt</strong>&hellip;</p>
<h2 id="einleitung">Einleitung</h2>
<blockquote>
<p>„Ich bin zu der Einsicht gelangt, dass Werbung die Ursünde des Web ist“</p>
<p>Ethan Zuckerman, <a href="https://www.horizont.net/medien/nachrichten/Werbung-ist-die-Ursuende-des-Web-Warum-sich-der-Erfinder-der-Pop-ups-fuer-seine-Schoepfung-entschuldigt-121851">horizont.net</a></p></blockquote>
<p>Eins vorweg: <strong>Das Web</strong> <strong>ist nicht das Internet</strong>, das wird oft missverstanden. Das Internet besteht aus vielen Computern, die miteinander vernetzt sind. Das Web besteht aus Webseiten, die z.B. über Hyperlinks miteinander vernetzt sind und über das Internet übertragen werden.</p>
<p>Das <a href="https://web30.web.cern.ch/">Web feierte jüngst seinen 30. Geburtstag</a> und Werbung ist seit jeher ein treuer Begleiter und vielleicht auch ein bisschen Technologietreiber. Mitte der 90er Jahre beschränkte sich die Werbung im Web noch auf triviale Banner.</p>
<ul>
<li>
<p><a href="https://www.nickyreinert.de/files/quo-vadis-www/display-werbung-1994.jpg"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/display-werbung-1994.jpg" alt="Display Werbung in 1994"></a></p>
<p>Display Werbung in 1994</p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/quo-vadis-www/grafik.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-700x379.png" alt="Display Werbung in 2019"></a></p>
<p>Display Werbung in 2019</p>
</li>
</ul>
<p>Der Hauptzweck von Werbung sollte die Finanzierung des Online-Angebots sein; bei den Vorgängern des Internets war Online Werbung <a href="https://web.archive.org/web/20130824150611/http://old.cni.org:80/docs/infopols/NSF.html">sogar explizit untersagt</a>. Die heute so berüchtigten Cookies wurden ursprünglich vor allem dazu genutzt, um z.B. <a href="https://web.archive.org/web/20130824150611/http://old.cni.org:80/docs/infopols/NSF.html">den Warenkorb in Online-Shops zu speichern</a>. Das WWW war ein ausgeglichener, idylischer Ort. Doch die Benutzerzahl stieg an und immer mehr Unternehmen entdeckten das Web für sich.</p>
<p>Der Banner ist Teil der Display Werbung, die zum Instrumentenkoffer des Online Marketings gehört. Im Bereich des Online Marketings entstanden viele neue Geschäftsmodelle und die Komplexität nahm zu. Instrumente und Strukturen evolutionierten in den folgenden drei Jahrzehnten rasant.</p>
<h2 id="was-genau-ist-denn-dieses-online-marketing">Was genau ist denn dieses Online Marketing?</h2>
<blockquote>
<p>Wo hast du diese Brille her? &ndash; Von `ner guten Fee, Kleiner!</p>
<p>Ned Hannister, Sie Leben (1988)</p></blockquote>
<p>Die Grenzen sind, wie so oft, verschwommen und man könnte, wie so oft, ein ganzes Buch damit füllen, Online Marketing zu beschreiben.</p>
<p>Zu Kern des <strong>Online Marketings</strong> gehörte von Anfang an das <strong>Display Marketing</strong>, das ursprünglich aus einfachen Werbebannern bestand. Display Marketing, und vor allem der Banner, sind nunmehr ein kleines Zahnrad in der Online Marketing Maschinerie. Mittlerweile gibt es eine große Auswahl an Kanälen, in denen Online-Marketing betrieben werden kann. Da wäre z.B. das <strong>E-Mail-Marketing</strong>. Spam kann hier als aggressivste Form der Werbung betrachtet werden. Oder <strong>Social Media-Marketing</strong> über Plattformen wie Facebook, LinkedIn, Instagram. Dann gibt es natürlich das Suchmaschinen-Marketing (<strong>SEM</strong>, <strong>Search Engine Marketing</strong>). Hier unterscheidet man in Suchmaschinenoptimierung (<strong>SEO</strong>, <strong>Search Engine Optimization)</strong>, um die Nutzer auf natürliche bzw. organische Weise auf das eigene Angebot zu lenken. Und Suchmaschinenwerbung (<strong>SEA, Search Engine Advertising</strong>), also bezahlte Anzeigen die in den Suchergebnissen angezeigt werden.</p>
<p>Dank der zunehmenden Vernetzung und Digitalisierung lassen sich aber auch klassische Marketing-Kanäle dem Digital- bzw. sogar Online-Marketing zuordnen, wie z.B. Print, TV, Radio oder Außenwerbung.</p>
<p>So bietet die gute alte <strong>Deutsche Post</strong> mit <a href="https://www.deutschepost.de/de/c/consentric/technologie.html">CONCENTRIC</a> ein Produkt an, das die Nutzer einer Webseite mit einem geografischen Standort verknüpft. Damit kann Werbung in Print-Produkten mit online ausgespielten Werbebannern abgeglichen werden. Die Werbebotschaft in deinem Briefkasten begegnet dir im Browser wieder.</p>
<p>Auch die sogenannten Out-Of-Home-Kampagnen, wie z.B. die klassische <strong>Litfaßsäule</strong>, können dank der zunehmenden Vernetzung und Digitalisierung als Teil des Online-Marketings verstanden werden. Wenn eine Gruppe spanischer Touristen in Berlin mit ihren Smartphones vor einer digitalen Werbetafel steht, kann über die Auswertung der Geo-Daten der Smartphones und der entsprechenden Profile entschieden werden, als nächstes eine Anzeige für Museums-Führungen anzuzeigen.</p>
<p>Der Fernseher, noch immer eine der populärsten Freizeitbeschäftigungen, ist längst nicht mehr eine Elektronenröhre, die nur das Fernsehsignal in Richtung Sofa wirft. SmartTVs haben einen Weg geebnet, den Samsung nun unter lauter Kritik beschreitet: <a href="https://www.chip.de/news/Bundeskartellamt-kritisiert-Samsung-TV-Werbung-sei-unzumutbare-Belaestigung_183019728.html">Deren Fernseher blenden personalisierte Werbung ein</a>.</p>
<p>Zusammengefasst lässt sich feststellen, dass jedes Gerät, welches über einen Anschluss an das Internet verfügt, ein potentieller Kanal für das Online-Marketing ist. Aus Unternehmenssicht sind das großartige Aussichten. Aus Nutzersicht sollte das beunruhigen.</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/they_live.jpg"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/they_live-700x335.jpg" alt=""></a></p>
<p>Szene aus &ldquo;Sie Leben&rdquo;, 1988</p>
<p><em>Der Begriff Online Marketing bezieht sich in der Regel auf die Maßnahmen, die im WWW bzw. über das Internet stattfinden, eben &ldquo;online&rdquo;. <em>Eine genaue Abgrenzung zum Offline Marketing ist schwierig, da die zunehmende Vernetzung auch klassische Offline-Kanäle betrifft, wie z.B. Außenwerbung.</em> Der Oberbegriff ist das Digital-Marketing, das darüberhinaus auch andere Werkzeuge beinhaltet, die sich digital steuern lassen. Das alles findet innerhalb des Marketings statt, bei dem es natürlich nicht nur um Werbung geht.</em></p>
<h2 id="ziele-wertschöpfung-und-stakeholder">Ziele, Wertschöpfung und Stakeholder</h2>
<p>In der Logistik gibt es die sogenannte <a href="https://de.wikipedia.org/wiki/Sechs-R-Regel">6R-Regel</a>: Das richtige Produkt, zur richtigen Zeit, am richtigen Ort, in der richtigen Menge, in der richtigen Qualität zu den richtigen Kosten.</p>
<p>Dieses Mantra lässt sich auch auf das <strong>Online Marketing</strong> übertragen: Der <strong>richtige Empfänger</strong> (potentieller Kunde) soll das <strong>richtige Produkt</strong> (die passende Werbemaßnahme), zur <strong>richtigen Zeit</strong> und am <strong>richtigen Ort</strong> (Hustensaftwerbung im Winter, Strandballwerbung auf Mallorca: Targeting) in der <strong>richtigen Menge</strong> (Frequency Capping), in der <strong>richtigen Qualität</strong> (systemgerecht, Smartphone versus Desktop) zu den <strong>richtigen Kosten</strong> (Marketing Controlling) erhalten. Die <strong>7R</strong> des Online Marketings:</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-15.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-15-700x615.png" alt=""></a></p>
<p>7R des Online Marketing (eigene Darstellung)</p>
<p>Nicht nur bei den Zielen gibt es Parallelen zur Logistik. Im Online-Marketing gibt es eine besondere Form der Wertschöpfung.</p>
<p>Aber zunächst zu den vier Kategorien bzw. Hauptakteuren im Online Marketing: Einmal sind das die <strong>Nutzer</strong>, die über ihre Geräte und Browser die Dienste des Internets nutzen. Sie sind die Empfänger der Marketing Maßnahmen. Ihr Interesse gilt weniger der Werbung und mehr den Inhalten.</p>
<p>Dann gibt es die <strong>Werbetreibende</strong> (neudeutsch <strong>Advertiser</strong>), die Marketing Maßnahmen zur Verkaufsförderung für ihre Produkte und Dienstleistungen nutzen.</p>
<p>Daneben gibt es noch die <strong>Publisher</strong> und Inhalteanbieter (im folgenden kürze ich diese Kategorie vereinfacht als Publisher ab), die die Marketing-Maßnahmen gegen Bezahlung umsetzen. Zu dieser Kategorie kann der Betreiber einer kleinen Webseite gehören, der ein paar Werbeanzeigen auf seinem privaten Blog schaltet. Oder aber der große Vermarkter, der die Werbeflächen eines großen Netzwerkes von Online-Portalen verwalten.</p>
<p>Und schließlich gibt es die vierte Gruppe der Marketing Technologie Unternehmen (kurz <strong>MarTech-Unternehmen</strong>), die zwischen den Advertisern und Publishern hängen. Hier spielt sich das eigentlich Marketing-Know-How ab.</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-14.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-14-700x627.png" alt=""></a></p>
<p>Teilnehmer im Online Marketing (eigene Darstellung)</p>
<p>Die Grenzen in diesem Quartett lassen sich in der Realität nur schwer beschreiben. Natürlich können Advertiser inhouse auch MarTech-Aufgaben übernehmen. Genauso vertreten Publisher auch Advertiser-Interessen oder bilden bestimmte MarTech-Aufgaben innerhalb ihres Unternehmens ab.</p>
<p>In diesem System lässt sich eine <strong>Wertschöpfungskette</strong> erkennen, bei der das Geld aus den Marketing-Budgets der Advertiser über die MarTech-Unternehmen zu den Publishern fließt.</p>
<p>Die &ldquo;Wahrnehmung&rdquo; durch den Nutzer kann wie bei einer klassischen Wertschöpfung als &ldquo;Rohstoff&rdquo; verstanden werden, den der Publisher &ldquo;erntet&rdquo;. Die MarTech-Unternehmen reichern diesen Rohstoff mit ihrer Technologie und dem KnowHow an, um die Ziele der <strong>7R-Regel</strong> zu erfüllen. Der Advertiser ist an dieser Stelle der Konsument.</p>
<p>Es entsteht eine Art Kreislauf. Die Marketing-Maßnahmen sind im Produkt-Preis einkalkuliert und werden damit, indirekt, durch den Nutzer finanziert. Der Nutzer wiederum konsumiert die Inhalte der Publisher.</p>
<h2 id="wertschöpfung-in-der-praxis">Wertschöpfung in der Praxis</h2>
<p>Der Einfachheit halber will ich mich zunächst auf die Display-Werbung konzentrieren, um einen kleinen Einblick in die Wertschöpfung in der Praxis zu geben.</p>
<p>Der Publisher wird dafür bezahlt, dass der Nutzer das Werbemittel auf seinem Angebot wahrnimmt - die sog. <strong>Ad Impression</strong>. Je mehr Nutzer die Werbung empfangen, desto mehr Geld erhält der Publisher vom Advertiser. Hier spielt der <strong>Tausender-Kontakt-Preis (TKP</strong>, englisch CPM, Cost per Mille) eine wichtige Rolle: Ein Publisher hat auf seinem Angebot 1 Mio. Besucher und verlangt einen TKP von 5 Euro. Der Publisher erhält also vom Advertiser 5 Euro * 1 Mio. / 1.000 = 5.000 Euro für die Ausspielung von Werbung an 1 Mio. Empfänger. Das ist die <strong>Holzhammer-Methode</strong>.</p>
<p>Etwas zielorientierter ist es, die Interaktion der Nutzer zu bewerten. Der Publisher erhält also eine (in der Regel höhere) Vergütung, sobald der Nutzer auch auf ein Werbemittel klickt. Man spricht dann vom <strong>Cost per Click bzw. Pay per Click (CPC, PPC)</strong>.</p>
<p>Noch erfolgsorientierter ist ein Provisions-Modell, das eine tatsächliche Bestellung im Online-Shop berücksichtigt: <strong>Cost Per Order (CPO)</strong> oder <strong>Cost Per Lead (CPL)</strong>, wenn das Ziel nicht die Bestellung sondern z.B. die Anmeldung bei einem Newsletter ist.</p>
<p>CPM und CPC spielen aber nicht nur bei Werbebannern eine Rolle, sondern z.B. auch beim E-Mail-Marketing, beim Suchmaschinen-Marketing oder im Affiliate-Marketing. Und damit stellen sie das Online Marketing vor eine kleine Herausforderung: Was ist, wenn der Nutzer nicht nach dem Kontakt mit einem Werbemittel auf einer Webseite, sondern zeitlich versetzt den Kauf tätigt? Vielleicht nach dem Lesen eines Newsletters oder Anschauen eines Werbevideos auf YouTube? Der Begriff der <strong>Customer Journey</strong> spielt hier eine wichtige Rolle. Man versucht zu erfassen, über welche Marketing-Maßnahmen (sprich Online-Marketing-Kanäle) der Nutzer angesprochen wurde bevor er einen Kauf getätigt hat, um eine <strong>Provision</strong> <strong>leistungsgerecht</strong> zu verteilen.</p>
<p>Das erfordert allerdings die Erfassung und Verarbeitung eines wichtigen Bestandteils im Online Marketing: <strong>Daten</strong>. Es geht darum herauszubekommen, ob und wann ein Nutzer den Newsletter gelesen, das Video gesehen, die Webseite besucht hat. So entsteht eine <strong>Customer Journey</strong>. Die Reise des Nutzers bis zum Einkauf im Online Shop des Advertises.</p>
<p>MarTech-Unternehmen erfassen und kombinieren Zugriffs-Daten, reichern sie aber noch weiter an. Jede zusätzliche Information über den Nutzer, die eine weitere Kategorisierung ermöglicht, hilft den Algorithmen dabei, die Customer Journey zu optimieren bzw. die 7R des Online-Marketings adäquat zu erfüllen.</p>
<p>MarTech-Unternehmen nutzen dazu demografische, geografische oder sogar persönliche Informationen, die die Nutzer mehr oder weniger freiwillig zur Verfügung stellen. Z.B. über ein Social Media Profil, in dem sie ihre Hobbys auflisten und andere Interessen hinterlegen. Aber natürlich auch über die CRM-Systeme der Advertiser oder schlicht über die Surf-Gewohnheiten im WWW.</p>
<p>All diese Daten werden durch die MarTech-Unternehmen erfasst, kombiniert sowie aggregiert und in Modellen und Algorithmen genutzt, um die sieben Ziele immer besser erfüllen zu können.</p>
<p>Möglich wird das alles durch das <strong>Tracking</strong>. Beim Aufruf einer Webseite werden dem Nutzer nicht nur die Bilder und Texte des Online-Angebots übermittelt. Die Webseite enthält außerdem Verweise zu anderen Servern und Diensten. Oft werden dazu Tracking-Pixel genutzt. Dazu werden mithilfe von JavaScript Anfragen zusammengebaut, die relevante marketingtechnische Informationen enthalten und an andere Server übermittelt werden. Die Antwort ist dann z.B. ein extrem kleines Bild mit genau einem Pixel - daher der Begriff Tracking-Pixel. Diese Anfrage an den Server eines MarTech-Unternehmens ermöglicht außerdem das Setzen eines <strong>Cookies</strong>. Wird das Tracking-Pixel des MarTech-Unternehmens auch auf den Seiten andere Publisher eingesetzt, kann man mihtilfe des Cookies nachvollziehen, auf welchen Seiten ein Nutzer unterwegs war.</p>
<h2 id="verschiebung-der-prioritäten">Verschiebung der Prioritäten</h2>
<blockquote>
<p><em>Journalistische Inhalte sind das Vehikel, um die Aufmerksamkeit des Publikums für die werblichen Inhalte zu erreichen</em></p>
<p><a href="https://www.golem.de/news/adblock-plus-axel-springer-sieht-journalismus-nur-als-vehikel-fuer-werbung-1509-116587.html">Springer-Anwälte</a> in 2015</p></blockquote>
<p>Das ganze führte allerdings im Laufe der Zeit zu einigen Problemen. Wie z.B. die Verschiebung der Prioritäten. Anfangs bestand der Hauptzweck eines Werbebanners, aus Sicht des Publishers, in der Finanzierung seines (kostenlosen) Angebots. Das hat sich an vielen Stellen geändert und der Werbebanner ist der Mittelpunkt bestimmter Geschäftsmodelle geworden.</p>
<p>Die Umsatzgenerierung mit Werbung scheint im Vordergrund zu stehen. Inhalte werden nicht mehr nur von Werbung begleitet, sie werden zum <em>willfährigen Erfüllungsgehilfen</em> degradiert. Die Anwälte des Springer-Verlags hatten die Situation 2015 ganz gut auf den Punkt gebracht: Der Inhalt soll den Nutzer auf die Seite locken, um dort die Werbung zu konsumieren. Der Blogger und Entwickler <a href="https://uglyduck.ca/news-websites-are-dumpster-fires/">Bradley Taunt, drückt es in Bezug auf Nachrichtenseiten noch etwas drastischer aus</a>:</p>
<blockquote>
<p>&ldquo;News Websites Are Dumpster Fires&rdquo;</p>
<p>Bradley Taunt, 29. Mai 2019</p></blockquote>
<p>Die Strategie lautet, möglichst viele Nutzer auf das eigene Online-Angebot zu locken, um möglichst viel Werbung auszuspielen. Eine berüchtigte Methode dürfte den meisten bekannt sein: <strong>Click-Bait-Überschriften:</strong></p>
<p>&ldquo;Dieser Artikel wird dein Leben verändern!&rdquo;</p>
<p>&ldquo;Du glaubst nicht was passierte, als eine Mutter ihre Kinder vom Flughafen abholte&rdquo;.</p>
<p>Dahinter verbergen sich oft Artikel, die vielleicht einen gewissen Unterhaltungswert besitzen, mit Journalismus aber nicht mehr viel zu tun haben.</p>
<p>Die Überschriften müssen dabei gar nicht so reißerisch sein, es geht auch salonfähig und etwas subtiler. Immer mit dem Ziel vor Augen, die Neugier des Nutzers zu wecken und ihn auf einen eigentlich banalen Artikel zu locken. Wie z.B. die folgende Überschrift:</p>
<blockquote>
<p>&ldquo;Gerücht: Neues Assassin&rsquo;s Creed heißt Ragnarok &amp; bringt beliebtes Feature zurück.&rdquo;</p>
<p>(<a href="https://www.gamepro.de/artikel/assassins-creed-ragnarok-geruecht,3351463.html">GamePro am 20.11.2019</a>)</p></blockquote>
<p>Der neue Titel der Assasin&rsquo;s Creed-Reihe stand, <a href="https://www.gamepro.de/artikel/vorsicht-angeblicher-assassins-creed-ragnarok-leak-ist-fake,3343677.html">auch bei GamePro, schon länger fest</a>. Das &ldquo;<strong>beliebte Feature</strong>&rdquo; soll dennoch dazu verleiten, auf den Artikel zu klicken. Um welches Feature es sich dabei handelt (die Rekrutierung), erfährt der Leser zum Ende des Artikels in einem Satz, nachdem er vorher, von zahlreichen Werbebanner begleitet, noch ein paar Mal angeteasert wird.</p>
<p>Man kann dem Beitrag die journalistische Leistung nicht komplett absprechen, trotzdem ist diese Art von Berichterstattung sehr weit verbreitet. Die wichtige Information lässt sich gut in einem Tweet oder regelmäßig aktualisiertem Übersichtsartikel oder sogar der Überschrift unterbringen. Stattdessen wird ein kleines Detail mit Bildern und bereits bekannten Informationen so aufbereitet, dass ein komplett neuer Nachrichten-Beitrag entsteht.</p>
<p>Zur Zeit ist die &ldquo;<strong>PlayStation 5</strong>&rdquo; ein Trend-Thema im Technologie-Bereich. Das Theme ist so bedeutent, dass sogar eigentlich themenfremde Portale wie TV-Movie berichten:</p>
<p><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-3-700x111.png" alt=""></p>
<p>Quelle: <a href="https://www.tvmovie.de/news/ps5-haendler-nennt-den-vorbesteller-preis-und-beunruhigt-alle-114370">tvmovie.de</a> (aufgenommen am 09.09.2020)</p>
<p>So sieht die Seite beim ersten Aufruf aus:</p>
<p><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-4-700x356.png" alt=""></p>
<p>Quelle: <a href="https://www.tvmovie.de/news/ps5-haendler-nennt-den-vorbesteller-preis-und-beunruhigt-alle-114370">tvmovie.de</a> (aufgenommen am 09.09.2020)</p>
<p>Der Vorbesteller-Preis, um den es geht, beträgt <strong>500 Pfund</strong>. Und die beunruhigende Information lautet, dass die PlayStation zum Start bereits ausverkauft sein könnte. Zwei Informationen, die nach einem Pop-Up auf einer Seite präsentiert werden, die 10 mal so lang ist, wie der eigentlich informative Inhalt.</p>
<p>Ich möchte diese Erscheinung &ldquo;<strong>kreativen Mikro-Journalismus</strong>&rdquo; nennen. Der Redakteur muss durchaus Kenntnis von der Sache haben. Die Herausforderung besteht dann aber darin, eine dünne Informationslage mit möglichst viel Text aufzuwerten. Das erfordert Kreativität.</p>
<p>Der Nutzer muss nicht nur auf die Seite gelockt sondern auch dort gehalten werden. Demnach darf der wichtige aber kleine Informationshappen nicht schon im ersten Absatz zu finden sein.</p>
<p>Außerdem kann mithilfe vieler kleiner Informationshappen in unterschiedlichen Artikeln auch die Frequenz der neuen Beiträge künstlich erhöht werden. Das ist ein wichtiger Faktor in der Suchmaschinen-Optimierung (SEO). Die Suchmaschine wird eine Seite höher bewerten, wenn sie feststellt, dass dort regelmäßig neue Beiträge veröffentlicht werden.</p>
<p>Im nächsten Schritt geht es übrigens darum, Artikel nicht mehr von einem Menschen verfassen zu lassen werden. Das Ziel ist die <strong>automatisierte Erstellung von Inhalten.</strong> Berichte über Fussballspiele können mittlerweile <a href="https://uebermedien.de/19028/die-schreib-maschine-die-aus-daten-fussballberichte-macht/">durch eine Software erstellt werden</a>. <a href="https://thisarticledoesnotexist.com/">Diese Seite</a> demonstriert die Erstellung fiktionaler Nachrichten. Wann gänzlich automatisiere Nachrichtentexte geliefert werden, ist wohl nur noch eine Frage <a href="https://entwickler.de/online/machine-learning/openai-language-model-gpt-2-579881547.html">der Zeit und der moralischen Flexibilität</a>.</p>
<p>Dass wir davon nicht mehr weit entfernt, <a href="https://www.wuv.de/tech/wie_gpt_3_zum_blogger_star_wurde">demonstrierte küzrlich der Student <strong>Liam Porr</strong></a>. <a href="https://liamp.substack.com/p/my-gpt-3-blog-got-26-thousand-visitors">Sein Blog,</a> den er dank GPT-3 mit künstlich verfassten Text fütterte, zog in 2 Wochen 26.000 Leser an. Ein Beitrag schaffte es auf dem populären Nachrichten-Aggregator <a href="https://news.ycombinator.com/">Hacker News</a> an die erste Stelle, ohne dass den Lesern klar war, dass die Inhalte von einer KI erstellt wurden.</p>
<h2 id="die-herrschaft-von-seo"><strong>Die Herrschaft von SEO</strong></h2>
<blockquote>
<p>The internet is an SEO landfill</p>
<p><a href="https://docs.sendwithses.com/random-stuff/the-internet-is-an-seo-landfill">unbekannt, 25.09.2020</a></p></blockquote>
<p><strong>Serendepity</strong> bechreibt das zufällige Auffinden interessanter Informationen. Der Klick auf einem Link in einem Blog führt zu einem Partner-Blog. So kann man sich durch das WWW hangeln und neue Inhalte entdecken. Ein Klick auf einen Link einer vermeintlich privaten Seite kann aber auch zu einem kommerziellen Angebot führen. Und hier stellt sich immer öfter die Frage, inwieweit die Seite / der Blog transparent handelt und wirklich eine unabhängige Empfehlung abgegeben hat.</p>
<blockquote>
<p>The Internet of creation disappeared. Now we have the Internet of surveillance and control.</p>
<p>Renata Ávila, <a href="http://lab.cccb.org/en/renata-avila-the-internet-of-creation-disappeared-now-we-have-the-internet-of-surveillance-and-control/">lab.cccb.org</a></p></blockquote>
<p>Der Nutzer folgt dem Pfad, den die Marketing-Technologie für ihn vorgesehen hat. Das passiert einerseits durch die Optimierung der Kampagnen. Unter dem Begriff der <strong>Predictive Customer Journey</strong> wird z.B. eine Maßnahme verstanden, die automatisch die Online-Marketing-Kampagne empfiehlt, die den größten Verkaufserfolg für den individuellen Nutzer verspricht. Klingt kompliziert, ist es auch.</p>
<p>Ein wichtiges und relativ leicht zugängliches aber ungleich aufwendigeres Teilgebiet ist <strong>SEO</strong> - Suchmaschinenoptimierung.</p>
<p>SEO ist eigentlich eine sehr nützliches Werkzeug. Die Aufgabe einer Suchmaschine ist es, Inhalte im WWW objektiv zu bewerten. Dank SEO werden Webseiten für das bestmögliche Benutzererlebnis optimiert. Es geht nicht nur um das Layout (genügend große Schrift), sondern auch um technische (Geschwindigkeit) und inhaltliche Faktoren (Lesbarkeitsindex). Die Suchmaschine nutzt derlei Faktoren, um den Wert einer Seite für den Nutzer zu ermitteln und die Seite entsprechend gut in den Suchergebnissen (<strong>SERP</strong>) zu platzieren.</p>
<p>Allerdings führte auch das mit der Zeit zu einer Umkehr der Prioritäten. Mit der ausreichenden Expertise ausgerüstet, gelingt es SEO-Experten Nutzer auf Seiten zu führen, deren Haupt-Zweck es ist, an Affiliate-Programmen zu verdienen. Der Nutzer soll ausgehende Links zu kommerziellen Angeboten klicken, wodurch dem Seiten-Betreiber eine Provision zugesprochen wird (<strong>CPO</strong>, <strong>CPL</strong>, siehe oben).</p>
<p>Wirklich perfektioniert wurde das Konzept mit dem Aufkommen der <strong>Gutschein-Portale</strong>. Ein Nutzer, der bereits eine feste Kaufabsicht besitzt, macht sich kurz vor dem Kaufabschluss auf die Suche nach Gutscheinen. Vom Gutschein-Portal aus klickte er sich dann zum Online-Shop durch und tätigt den Kauf. Das Gutschein-Portal wurde dann als letzter Kontakt wohlwollend bei der Provision berücksichtigt. Ein Gutschein-Portal anzubieten gehört mittlerweile zum guten Ton, auch bei Seiten, bei denen man das eigentlich nicht erwarten würde, wie <a href="https://gutscheine.welt.de/">welt.de</a>, <a href="https://www.stern.de/gutscheine/shops/">stern.de</a>, ja sogar <a href="https://www.spiegel.de/gutscheine/">spiegel.de</a> und vielen, vielen mehr.</p>
<p>Die <strong>Customer Journey Analyse</strong> und die sogenannten <strong>Attribution</strong> helfen dem Online Marketing Manager übrigens, derartige Portale zu entlarven. Man versucht die Reise des Kunden bis zum Kaufabschluss zu erfassen und anhand statistischer Methoden zu erkennen, welcher Kontakt mit den Online Marketing-Maßnahmen des Advertisers am ehesten zur Festigung der Kaufabsicht beigetragen hat. Gutschein-Portale versuchen oft nur die Provision abzugreifen, ohne einen wichtigen konsum-psychologischen Beitrag zu leisten.</p>
<p>Aber auch bei der Suche nach Kaufempfehlungen und Vergleichsstest spielt SEO (bzw. sogar SEA - also das Schalten von Werbeanzeigen über die Suchmaschine) eine wichtige Rolle. Ich möchte das am Beispiel der Suche nach einer Empfehlung für &ldquo;<a href="https://www.google.com/search?q=Universalfernbedienungen">Universalfernbedienungen</a>&rdquo; zeigen. Gleich an erster Stelle hat sich <a href="https://www.chip.de/artikel/Die-beste-Universalfernbedienung_171333632.html">chip.de</a> platziert. Charakteristisch: Jeder ausgehende Link zu Amazon ist mit einem <strong>Affiliate-Parameter</strong> versehen und soll somit die <strong>Provision</strong> beim Kauf der jeweiligen Produkte sicherstellen. Der Artikel behandelt übrigens vornehmlich <strong>Logitech-Produkte</strong>. Die Produkte der Konkurrenz, die in einigen Absätzen nur kurz abgehandelt werden, sind nicht verlinkt.</p>
<p>Auch die anderen Seiten aus den Suchergebnissen machen deutlich, dass es nicht leicht ist, einen Test zu Universalbedienungen zu finden, der halbwegs vertrauenserweckend erscheint. Ein weiteres Ergebnis führt so z.B. zu <a href="https://www.welt.de/vergleich/elektronik/universalfernbedienung-test/">welt.de</a> - einer Nachrichtenseite. Sicher, auch Nachrichtenportale haben Technik-Ressorts. Aber auch hier wird klar, dass man inhaltlich nicht viel erwarten kann. Nach der Auflistung technischer Details, die so auch in der offiziellen Produktbeschreibung zu fnden sind werden ein paar technische Hintergründe erklärt. Einen richtigen Test gibt es nicht. Dafür aber die besagten <strong>Affiliate-Links</strong>. Nun kann man diesen Seiten vielleicht zugestehen, dass diese &ldquo;Tests&rdquo; der Finanzierung des Hauptprodukts dienen.</p>
<p>Doch auf der 1. Ergebnisseite finden sich auch andere Verteter, bei denen noch klarer wird, wie das Geschäftsmodell SEO + Affiliate funktionieren kann:</p>
<p>Die Seite <a href="http://universalfernbedienungtest.com">universalfernbedienungtest.com</a> ist professionell umgesetzt und enthält einige technische Hintergrundinformationen. Jedes Produkt bekommt sogar einen eigenen Artikel, der im wesentlichen aber nur die technischen Daten und Amazon-Rezensionen zusammenfasst. Es wird nicht deutlich, dass sich jemand inhaltlich ausführlich mit Universalfernbedienungen auseinandergesetzt hat, was zumindest bei chip.de noch der Fall war. Das Impressum verweist auf ein Unternehmen in Las Vegas. Unter den Partner-Seiten werden <a href="http://handdampfreinigertest.com">handdampfreinigertest.com</a> und <a href="https://www.plattenspielertests.net/">plattenspielertests.net</a> aufgeführt, die laut Impressum zum gleichen Unternehmen gehören. Spätestens jetzt dürfte klar sein, dass diese Seiten einzig dazu dienen, Umsatz durch Provisions-Abschöpfung zu generieren.</p>
<p>Fernbedienungen sind keine Ausnahme. Grundsätzlich ist jedes Produkt, das konsumiert wird, dafür prädestiniert, in einem Blog-Artikel &ldquo;getestet&rdquo; und empfohlen zu werden. <a href="https://www.google.com/search?channel=trow2&amp;client=firefox-b-d&amp;q=vergleich&#43;kaffeemaschinen">Kaffeemaschinen</a>. <a href="https://www.google.com/search?q=vergleich&#43;kopfh%C3%B6rer">Kopfhörer</a>. <a href="https://www.google.com/search?q=vergleich&#43;kopfh%C3%B6rer">Kopfhörer</a>. Die Grenze zwischen unabhängigen (und ausführlichem) Test und einfacher Auflistung ist dabei sehr verschwommen.</p>
<p><a href="https://docs.sendwithses.com/random-stuff/the-internet-is-an-seo-landfill">Das Web ist zu einer SEO-Deponie verkommen.</a> Der Ausblick? <a href="https://www.sueddeutsche.de/digital/seo-suchmaschinen-optimierung-google-bing-ki-1.4567188">Man vermutet jetzt schon</a>, dass künstliche Intelligenz die Suchmaschinen mit SEO-Reizen überfluten wird.</p>
<h2 id="ein-undurchschaubares-ökosystem">Ein undurchschaubares Ökosystem</h2>
<blockquote>
<p>Der Tracker wurde programmatisch auf unserer Webseite gesetzt, daher können wir den Werbetreibenden dahinter nicht identifizieren.</p>
<p>unbekannter Publisher</p></blockquote>
<p>Schaut man sich die Akteure im Online Marketing von vor 25 Jahren an, dürfte die Bedeutung der MarTech-Unternehmen neben den Advertisern und Publishern auffallend gering gewesen sein. Arbeitsteilung und technische Innovation führten im Laufe der Zeit dazu, dass deren Rolle immer wichtiger wurde.</p>
<p>Unzählige Plattformen und Anbieter stießen auf den Markt, um ihre Dienstleistungen anzubieten. SSP, DSP, DMP, CMP, AdServer, AdExchanges, AdNetworks, Trading-Desks - und das sind nur die bekanntesten Teilnehmer.</p>
<p>Und all diese haben ein großes Arsenal an Werkzeugen im Gepäck, um die 7R-Ziele immer besser zu erfüllen. Mit <strong>Re-Targeting</strong> werden dem Kunden passgenaue Werbebotschaften übermittelt. Die <strong>Predictive Customer Journey</strong> nutzt ausgefeilte Algorithmen, um die Kaufwahrscheinlichkeit zu ermitteln und entsprechende Maßnahmen zu ergreifen. Da das Vertrauen in die Influencer sinkt, versucht man mit <strong>Micro-Influencern</strong> eine &ldquo;familiäre&rdquo; Bindung zu erschaffen, über die die Werbebotschaft übermittelt werden kann. Die <strong>Geolokalisierung</strong> sorgt dafür, dass dein Smartphone den Besuch des Burgerladens empfiehlt, den du gleich passieren wirst. Und die Werbesendung aus Papier in deinem Briefkasten wurde dank <strong>Adress-Matching</strong> genau auf deine Bedürfnisse abgestimmt. Weitere Buzzwords sind <strong>Programmatic Advertising</strong>, <strong>Machine Learning</strong> oder <strong>Blockhain</strong>. Die Technologie-Maschine läuft auf Hochtouren, <a href="https://www.adzine.de/2019/10/blockchain-und-programmatic-laut-owm-studie-noch-nicht-miteinander-vereinbar/?mc_cid=7be6020411&amp;mc_eid=3897523165">auch wenn die Wirksamkeit zweifelhaft ist</a>. <a href="https://www.sueddeutsche.de/wissen/kuenstliche-intelligenz-software-computer-1.5036926?utm_source=pocket-newtab-global-de-DE">Doch das ist nicht nur ein Problem der Online Marketing-Branche.</a></p>
<ul>
<li>
<p><a href="https://www.nickyreinert.de/files/quo-vadis-www/online-marketing-1994.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/online-marketing-1994-700x394.png" alt="Online Marketing in 1994"></a></p>
<p>Online Marketing in 1994</p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/quo-vadis-www/online-marketing-2019.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/online-marketing-2019-700x394.png" alt="Nur ein Teil des Online Marketings in 2019: Display Werbung"></a></p>
<p>Nur ein Teil des Online Marketings in 2020: Display Werbung</p>
</li>
</ul>
<p>Das Online-Marketing-Ökosystem im Wandel der Zeit (eigene Darstellung)</p>
<p>Zählte man <a href="https://chiefmartec.com/2019/04/marketing-technology-landscape-supergraphic-2019/">in 2011 noch knapp 150 Mar-Tech-Unternehmen, sind es 2020 bereits über 8.000</a>. Bis 2020 erwartet man weltweit Ausgaben von <a href="https://chiefmartec.com/2019/10/martech-now-121-5-billion-market-worldwide/">121,5 Mrd. USD</a> für Marketing Technologien. 2021? <a href="https://de.statista.com/themen/113/online-werbung/">350 Mrd USD</a>.</p>
<p>Eine Ursache für das Wettrüsten im Digital Marketing ist der Konflikt zwischen den Nutzern, die sich dem ständigen Werbedruck entziehen möchten und den Advertisern, die um genau diese Aufmersamkeit mit dem Wettbewerb buhlen. Die MarTech-Unternehmen haben ihre Chane erkannt und antwortet mit einem unsagbaren Innovationsdruck, der natürlich auch das berühmte <strong>Buzzword-Bullshit-Bingo</strong> befeuert.</p>
<p>So ist eine komplexe Industrie entstanden, die Unmengen an technischen und humanen Ressourcen verschlingt. Im Online-Marketing arbeiten extrem begabte Menschen an extrem ausgefeilten Techologien.</p>
<blockquote>
<p>The best minds of my generation are thinking about how to make people click on ads.</p>
<p>Facebook-Engineer, via <a href="https://thecorrespondent.com/100/the-new-dot-com-bubble-is-here-its-called-online-advertising">thecorrespondent</a></p></blockquote>
<p>Während man anderswo alles daran setzt, mit Automatisierung die Produktivität zu erhöhen, um der von Keynes in 1930 proklamierten 30-Stunden-Woche näher zu kommen, scheint man im Online Marketing nicht müde zu werden, neue Beschäftigungsfelder zu entdecken und aufregende Berufsbezeichnungen zu entwicklen.</p>
<p><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/martech-landscape-growth.jpg" alt="https://cdn.chiefmartec.com/wp-content/uploads/2020/04/martech-landscape-growth.jpg"></p>
<p>Anzahl Unternehmen in der MarTech-Branche (Quelle: <a href="https://cdn.chiefmartec.com/wp-content/uploads/2020/04/martech-landscape-growth.jpg">chiefmartec.com</a>)</p>
<p>Der leider kürzlich verstorbene Anthropologe <a href="https://www.heise.de/newsticker/meldung/Anthropologe-Menschen-verdienen-umso-weniger-je-nuetzlicher-ihr-Job-ist-4192979.html">David Graeber definiert Bullshit Jobs</a> übrigens folgendermaßen: &ldquo;Das ist ein Job, von dem die Leute, die ihn machen, glauben: Wenn es diesen Job nicht gäbe, würde dies nicht auffallen, würden die Dinge sogar ein wenig besser&rdquo;. Die aktuelle Coronoa-Krise und der Begriff &ldquo;systemrelevante Berufe&rdquo; geben dieser Aussage einen gewissen Nachdruck.</p>
<p>Jesse Frederik und Maurits Martijn kommen in einem Artikel, der hinter Online-Advertising eine große Blase vermutet, zu einer absurden Erkenntnis. Trotz des ganzen Aufwandes, trotz immer steigender Werbe-Budgets, trotz einem hyperkomplexen Ökosystem, bestehen Zweifel daran, ob Online Advertising überhaupt effektiv funktioniert:</p>
<blockquote>
<p>&ldquo;Is online advertising working? We simply don’t know&rdquo;</p>
<p>Jesse Frederik und Maurits Martijn, <a href="https://thecorrespondent.com/100/the-new-dot-com-bubble-is-here-its-called-online-advertising">thecorrespondent.com</a></p></blockquote>
<h2 id="fettleibigkeit">Fettleibigkeit</h2>
<blockquote>
<p>Werbung dringt in jede Ritze, jede Pore unseres Lebens. Sie überzieht alles mit einem fiesen, grellen Schleim aus Halbwahrheiten, Stereotypen und Habsucht. Werbung ist Spam, der sich hübsch gemacht hat.</p>
<p>Felix Schwenzel, 24.07.2016, <a href="https://wirres.net/article/articleview/10072/1/6/">wirrest.net</a></p></blockquote>
<p>Ein derartiges Ökosystem hinterlässt auf jeder Webseite seine Spuren und führt damit auch zu ganz handfesten technischen Problemen. <a href="https://idlewords.com/talks/website_obesity.htm#fixes">Die Website-Obesity</a> (&ldquo;Fettleibigkeit&rdquo;) ist ein globales Problem, deren Auslöser zugegeben nicht nur das Online Marketing ist.</p>
<p>Eine Ursache für die Fettleibigkeit bei Webseiten dürften zunächst zahlreiche Popups, Popunder und Banner sein. Ethan Zuckermann, ein Entwickler, der Mitte der 90er Jahre für die Entwicklung der Pop-Ups mit zuständig war, <a href="https://www.horizont.net/medien/nachrichten/Werbung-ist-die-Ursuende-des-Web-Warum-sich-der-Erfinder-der-Pop-ups-fuer-seine-Schoepfung-entschuldigt-121851">hat sich übrigens genau dafür entschuldigt</a> und rechnet gleichzeitig mit Werbung im Internet ab.</p>
<p>Eine andere Ursache sind die unzähligen Prozesse, die im Hintergrund ablaufen. Um auf imgur.com <a href="https://imgur.com/gallery/bapJ6lv">eine Grafik</a> mit einer Größe von 538 KByte zu laden, sendet die Seite 9,62 MByte an Daten und startet 465 HTTP-Anfragen. Initial. Je länger man auf der Seite verweilt, desto mehr Datenvolumen wird in Anspruch genommen. <a href="https://publish.twitter.com/?query=https%3A%2F%2Ftwitter.com%2Fcsswizardry%2Fstatus%2F1185604806901207045&amp;widget=Tweet">Imgur hat die Kontrolle über sein Angebot ganz offensichtlich verloren</a>, steht damit aber auch nicht allein da.</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-6.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-6-700x661.png" alt=""></a></p>
<p>Verbindungen, die beim Aufruf eines Bildes auf imgur.com geöffnet werden</p>
<p>Wie diese große Anzahl entstehen kann, möchte ich am Real Time Bidding (<strong>RTB</strong>) erläutern. Beim RTB geht es um den Handel mit Werbeplätzen. Der Nutzer ruft das Angebot des Publishers auf, der Werbeplätze auf seiner Webseite anbietet. Um nun zu ermitteln, welchen Werbebanner der Nutzer tatsächlich sieht, wird eine Anfrage an die sogenannte <strong>Supply Side Plattform</strong> (<strong>SSP</strong>) abgesetzt. Diese Plattform ist eine Art Sammelbecken für freie Werbeflächen von Publishern.</p>
<p>Auch auf Advertiser-Seite gibt es eine solche Plattform - die <strong>Demand Side Plattform</strong> (<strong>DSP</strong>). Hier werden sozusagen die Wünsche der Advertisers gesammelt, eine bestimmte Werbung auszuspielen. Die Advertiser bieten auf die freien Werbeflächen und die Vermittlung des ganzen geschieht über die <strong>Ad Exchange</strong> - eine Art Börse.</p>
<p>Um die Auswahl der freien Werbeflächen zu optimieren, gibt es auf der Advertiser-Seite außerdem eine <strong>Data Management Plattform</strong> (<strong>DMP</strong>). Natürlich bieten Advertiser nicht blind auf freie Werbeplätze, sondern versuchen ihre Zielgruppe möglichst genau zu erreichen. Die DMP kann dazu sogenannte Segment-Informationen liefern. Befindet sich also ein freier Werbeplatz auf einer Automobil-Seite, werden Advertiser aus der Automobil-Branche bevorzugt dafür Gebote abgeben. Jede dieser Plattformen ist beim Aufruf einer Webseite mit einer Anfrage involviert. Und das ist nur ein kleiner Ausschnitt des Sytems.</p>
<p>Das ganze gehört zum großen Feld des <strong>Programmatic Advertising</strong>. Leider ist das System vor Betrügern nicht gefeit. Aufgrund der schieren Komplexität und langen Lieferketten für den Werbebanner kann man kaum noch vermeiden, dass Betrüger das System für sich ausnutzen und völlig sinnfreie Werbeplätze verkaufen. Adobe, einer der Big Player im Online Marketing, räumt ein, <a href="https://www.heise.de/select/ct/2018/21/1539407897209303">dass 3% der Werbeplätze an Betrüger vermittelt werden</a>.</p>
<h2 id="unzufriedenheit">Unzufriedenheit</h2>
<blockquote>
<p>Advertising is a cancer on society.</p>
<p><a href="http://jacek.zlydach.pl/index.html">Jacek Złydach</a>, _02.<em>10</em>._2019</p></blockquote>
<p>Die technischen Problem sind bei weitem nicht alles. <a href="https://voxeu.org/article/advertising-major-source-human-dissatisfaction">Ein Studie mit 1 Mio. Nutzern zeigte</a> jüngst auf, dass Werbung auch eine wichtige Quelle menschlicher Unzufriedenheit ist. Ein Problem ist, dass Werbung nicht nur informiert sondern auch <strong>Bedürfnisse erzeugt</strong>, die nicht alle gedeckt werden können.</p>
<p>Weiterhin wurde untersucht, wie sich die Zunahme und der Rückgang des Werbeaufkommens auf den nationalen Wohlstand auswirken. Offenbar gibt es auch hier einen Zusammenhang: Wenn sich die <strong>Werbeausgaben</strong> verdoppelt haben, nahm die <strong>Lebenszufriedenheit</strong> um 3% ab.</p>
<p>Zwar geht es in dieser Studie um Werbung allgemein. Die Werbung im Web, einem unserer täglichen Begleiter, dürfte daran aber einen erheblichen Anteil haben.</p>
<h2 id="der-datenschutz">Der Datenschutz</h2>
<blockquote>
<p>&ldquo;Das Problem ist nicht der Datenschutz, es ist die Datensammlung.&rdquo;</p>
<p><a href="https://www.zdnet.com/article/gdpr-is-missing-the-point-says-edward-snowden/">Edward Snowden</a></p></blockquote>
<p>Theoretisch wäre es ohne weiteres denkbar, dass der Schutz (persönlicher) Daten und Online Marketing konfliktfrei koeexisieren. Doch die Versuchung ist groß. Je besser sich die Nutzer identifizieren lassen, desto höher ist die Effizienz der meisten Marketing-Maßnahmen.</p>
<p>Die Ziele und der Ideenreichtum des Online Marketings kollidieren demnach massiv mit dem steigenden Datenschutzbewusstsein innerhalb der Gesellschaft und damit einhergehend den gesetzlichen Vorgaben.</p>
<p>Die wichtigste Waffe im Kampf gegen das Tracking sind seit jeher Browsererweiterungen wie <strong>NoScript</strong>, <strong>AdBlockPlus</strong> (*<a href="https://www.gruenderszene.de/allgemein/adblock-plus-kritik">hust</a>*) usw. Auf die Seite der Konsumenten haben sich außerdem zwei Browserhersteller geschlagen. <strong>Apple</strong> hat seinen Browser <strong>Safari</strong> als einer der ersten Anbieter mit einer Technologie ausgestattet, die das sogenannte Tracking erschweren soll (<strong>ITP</strong>, <strong>Intelligent Tracking Prevention</strong>). <strong>Mozilla</strong> zog wenig später nach**: Firefox** blockiert standardmäßig <strong>3rd-Party-Cookies und</strong> bietet einen Schutz vor ungewollter Aktivitätenverfolgung an. Unmöglich wird das Tracking dadurch lange nicht, aber zumindest erschwert.</p>
<p><strong>Google</strong> ist mit seinem Browser <strong>Chrome</strong> noch etwas zurückhaltender. Nicht ohne Grund. 85% der Einnahmen von Google stammen aus dem Werbegeschäft. <a href="https://www.macrotrends.net/stocks/charts/GOOG/alphabet/net-income">Der Nettogewinn der Muttergesellschaft</a> Alphabet stieg von 12 Mrd. USD in 2017 auf 30 Mrd. USD. <a href="https://stadt-bremerhaven.de/google-viel-umsatz-und-viel-gewinn-mit-viel-werbung/">85% der Einnahmen</a> stammen aus dem Werbegeschäft.</p>
<p><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-700x390.png" alt=""></p>
<p>Der hauseigene Tracking-Dienst &ldquo;Google Analytics&rdquo; gehört für viele zum Quasi-Standard. Egal welchen Zweck ein Webseiten-Betreiber mit der Analyse seiner Besucher verfolgt, der erste Griff geht reflexartig zu Google Analytics. Was dabei gerne übersehen oder einfach ignoriert wird: Man überlässt Google die Daten der eigenen Nutzer und Kunden freimütig. Dabei würde eine selbst gehostete, aggregierte Besucherstatistik vielleicht schon genügen.</p>
<blockquote>
<p>Data is the new oil and GA is Deepwater Horizon.</p>
<p>Kemal Ahmed, 21.01.2020, <a href="https://dev.to/goatandsheep/stop-donating-your-customers-data-to-google-analytics-191">dev.to</a></p></blockquote>
<p>So viel Marktmacht bleibt natürlich nicht ungesehen. <a href="https://www.tagesschau.de/wirtschaft/google-kartellverfahren-103.html">Gerade sieht sich Google in den USA einer Kartellrechtsklage</a> ausgesetzt.</p>
<p>Gegenwind bekommt die Online-Marketing-Industrie auch von Seiten des Gesetzgebers (Nicht erst jetzt seit 2018, Datenschutzgesetze gibt es schon länger, <a href="https://de.wikipedia.org/wiki/Hessisches_Datenschutzgesetz">das erste dieser Art stammt sogar aus Hessen</a>).</p>
<p>Mit der in Mai 2018 inkraft getretenen Datenschutzgrundverordnung (<strong>DSGVO</strong>) versucht der europäische Gesetzgeber dem Datenschutz mehr Bedeutung zu verleihen. Bei der DSGVO geht es ganz allgemein um den Schutz personenbezogener Daten, unabhängig davon ob im Internet, beim Bäcker oder einer Behörde. Eine auf die speziellen Anforderungen des Internets zugeschnittene <strong>ePrivacy-Verordnung</strong>, die vor allem dabei helfen sollte, die entstandene Rechtsunsicherheiten zu beseitigen, lässt seit Jahren auf sich warten. Warum? <a href="https://netzpolitik.org/2018/bericht-ueber-lobbyismus-wie-die-datenindustrie-die-eu-bearbeitet/">Die Online Marketing Branche hat eine starke Lobby</a>.</p>
<p>Nichtsdestotrotz urteilten <a href="https://www.e-recht24.de/artikel/datenschutz/12119-bgh-urteil-cookies-einwilligung.html">europäische</a> und auch <a href="https://www.e-recht24.de/artikel/datenschutz/12119-bgh-urteil-cookies-einwilligung.html">deutsche Gerichte</a> erst kürzlich auch zum Thema Cookies und auch das umstrittene Privacy-Shield <a href="https://www.juris.de/jportal/nav/juris_2015/aktuelles/magazin/schrems-ii-videokonferenz.jsp">wurde mittlerweile kassiert</a>.</p>
<p>Für den Nutzer und die Betrieber kleiner Seiten ist die Situation schon lange nicht mehr durchschaubar. Aber auch &ldquo;<em>Europas Regierungen scheitern an der DSGVO</em>&rdquo;, so <a href="https://www.golem.de/news/dsvgo-nichts-weniger-als-staatsversagen-2005-148700.html">Dave Ryan</a>, Datenschutzspezialist beim Browser Brave.</p>
<blockquote>
<p><em>Werden finanzstarke Großunternehmen mal an den Haken genommen, dann schöpfen diese mit Anwaltsarmeen den Rechtsweg bis zur höchsten Instanz aus und betreiben ihre illegalen und lukrativen Geschäftsmodelle über Jahre hinweg weiter.</em></p>
<p><a href="https://www.golem.de/news/dsvgo-nichts-weniger-als-staatsversagen-2005-148700.html">Thilo Weichert, Datenschutzexperte</a></p></blockquote>
<p>Wer personenbezogen Daten erfasst oder verarbeitet, benötigt laut DSGVO eine Rechtsgrundlage. Als Legitimation bietet sie u.a. das <strong>explizite Einverständnis</strong> (engl. <strong>Consent</strong>) des Nutzers oder ein <strong>berechtigtes Interesse</strong> (engl. <strong>legitimate interest</strong>) an.</p>
<p>Damit soll das ungehinderte Erfassen und Verarbeiten personenbezogener Daten erschwert werden. In der Realität sieht das folgendermaßen aus: Die Hausfrau und der Hausmann sind von der neuen Informationsflut wohl eher überfordert und genervt. Der Webseiten-Besucher muss nun beim Aufrufen einer Webseite der Verarbeitung seiner personenbezogner Daten zustimmen und wird darüber maximal transparent aufgeklärt. Der berühmt-berüchtigte <strong>Cookie-Banner</strong> gehört zum gewohnten Bild.</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-10.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-10-700x162.png" alt=""></a></p>
<p>Cookie-Banner von bildderfrau.de (abgerufen am 24.10.2020)</p>
<p>Der prominente grüne Button führt dazu, dass jede Tracking-Maßnahme akzeptiert wird. Wer nur technische notwendige Cookies zulassen möchte, muss sich über die Einstellungen mit den Hintergründen beschäftigen und wird mit über 250 Unternehmen konfrontiert, die beim Besuch einer Webseite involviert sein könnten:</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-11.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-11-700x407.png" alt=""></a></p>
<p>Cookie-Einstellungen von bildderfrau.de (abgerufen am 24.10.2020)</p>
<p>Schon mal was von Teads, Tapad, Taboola oder Tealoum gehört? Der Otto-Normal-Nutzer wird Schwierigkeiten haben zu verstehen, was hier passiert. Der Cookie-Banner wird nur als störend empfunden und vermutlich ungelesen weggeklickt.</p>
<p>Das ist natürlich kein Einzelfall. So sieht der Cookie Banner bei chefkoch.de aus:</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-12.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-12-700x251.png" alt=""></a></p>
<p>Cookie-Banner von chefkoch.de (abgerufen am 24.10.2020)</p>
<p>&ldquo;Auch wenn du <strong>nicht zustimmst</strong>, siehst du weiterhin Werbung.&rdquo; - aber wo befindet sich der Button, um nicht zuzustimmen?</p>
<p>Natürlich ist es im Interesse der Branche, dass der Nutzer seine volle Zustimmung gibt. Um das zu erreichen bedient man sich gerne sogenanter <a href="https://de.wikipedia.org/wiki/Dark_Pattern">Dark Patterns</a>. Dabei wird ein Benutzerinterface so gestaltet, dass der Nutzer eine Entscheidung fällt, die unter Umständen gegen sein eigentliches Interesse ist.</p>
<p>Im Januar 2020 <a href="https://arxiv.org/abs/2001.02479">hat man die Verwendung von Dark Patterns im Lichte der DSVO untersucht</a>. Nur knapp 12% der untersuchten Seiten setzen die Vorgabe der DSGVO minimal rechtskonform um. Bei allen anderen Seiten stellte man den Einsatz von Dark Patterns oder einer Gestaltung fest, die ein bestimmtes Einverständnis bereits im voraus implizierte.</p>
<p>Der ganze Aufwand und die ausgefeilten Texte und Erklären waren am Ende aber doch umsonst, weil die Nutzer <a href="https://ninja-cookie.com/">Browser-Erweiterungen</a> nutzen, die derartige Pop-Ups einfach wegklicken.</p>
<p>Während die Gesetze kleinere Unternehmen oder selbständige Webseiten-Betreiber vor große Herausforderungen stellen und für den Nutzer komplett nutzlos zu sein schein, spielen sie vor allem den Big Playern wie Facebook und Google in die Arme:</p>
<blockquote>
<p>Die größten Gewinner der DSGVO sind denn auch die großen, meist amerikanischen Konzerne, die von einheitlichen Regeln auf dem Binnenmarkt profitieren. Kleine und mittlere Unternehmen leiden hingegen unter der neuen Datenschutzbürokratie. Und die Verbraucher werden weiter ausgeraubt. Ihre kostbaren Daten gibt es immer noch umsonst, trotz DSGVO.</p>
<p>Zwei Jahre Datenschutzgrundverordnung - Für die Nutzer komplett nutzlos, Eric Bonse, 25.06.2020, <a href="https://taz.de/Zwei-Jahre-Datenschutzgrundverordnung/!5691398/">taz.de</a></p></blockquote>
<h2 id="zwei-neue-mitglieder-im-online-marketing-ökosystem">Zwei neue Mitglieder im Online Marketing Ökosystem</h2>
<p>Ein interessanter Effekt, der die Innovationskraft der Branche sehr gut demonstriert, ist die Entstehung und der Aufstieg der <strong>Consent Management Plattformen</strong> (<strong>CMP</strong>). Damit reiht sich eine weitere Dienstleistung in das Ökosystem des Online-Marketings ein. Bei der CMP handelt es sich um eine Plattform, die den Consent der Nutzer zentral verwaltet. Das erleichtert den Publishern das Einbinden eines einheitlichen Cookie-Banners. Der Nutzer profitiert wiederum von der Wiedererkennung der Abfrage und der zentralen Verwaltung seiner Zustimmung.</p>
<p>Im Hintergrund hat das <strong>IAB</strong> - der Branchenverband des Online-Marketings - einen Standard entwickelt, um das Einholen des Einverständnisses auch aus technischer Sicht zu erleichtern: Das <strong>TCF</strong> - <strong>The Consent Framework</strong>.</p>
<p>Beide Dienste, CMP und TCF, sind natürlich kostenpflichtig. Das TCF ist mittlerweile soweit verbreitet, dass es für Advertiser, Publisher und MarTech-Unternehmen kaum einen Weg daran vorbeigibt. Das erleichtert einerseits die Prozesse, ist andererseits aber auch ein erheblicher zusätzlicher Kostenfaktor. <a href="https://vendorlist.consensu.org/v2/vendor-list.json">Aktuell haben sich knapp 900 Vendoren</a>, also MarTech-Unternehmen, für das TCF registriert (Der Jahresbeitrag beträgt übrigens 1.200 Euro - knapp 1 Mio. Euro mehr oder weniger garantierter jährlicher Umsatz für die Pflege eines Standards sind ein hübsches Sümmchen).</p>
<p>Das TCF ist ein Standard von der Industrie für die Industrie. Zweck der Consent-Banner ist es nicht, dem Nutzer Online-Marketing zu erklären - das würde den Rahmen bei weitem sprengen. Das TCF dient dazu, alle notwendigen Informationen zu präsentieren, um rechtskonform zu handeln und sich nicht angreifbar zu machen.</p>
<p>Will man sich mit der Verwendung seiner Daten ausführlicher beschäftigen, darf man sich <a href="https://support.google.com/displayvideo/answer/9496576?hl=de">mit über einem Dutzend von sogenannten Zwecken und Funktionen des Trackings</a> auseinandersetzen. Darunter z.B. &ldquo;Automatisch Geräteeigenschaften zur Identifizierung empfangen und senden&rdquo;, &ldquo;Offline-Datenquellen zusammenführen und kombinieren&rdquo;, &ldquo;Gerätemerkmale aktiv zu Identifizierungszwecken scannen&rdquo;, &ldquo;Anzeigenleistung messen&rdquo; usw. usf.</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/Screenshot_2020-10-24-TechCrunch-ist-jetzt-Teil-von-Verizon-Media.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/Screenshot_2020-10-24-TechCrunch-ist-jetzt-Teil-von-Verizon-Media-150x150.png" alt=""></a></p>
<p>Tracking-Einstellungen von yahoo.com (abgerufen am 24.10.2020)</p>
<p>Noch Fragen?</p>
<h2 id="ein-sündenbock-namens-cookie">Ein Sündenbock namens Cookie</h2>
<p>Der Cookie muss seit dem gestiegenen Datenschutzbewusstsein in der Öffentlichkeit als Sündenbock herhalten. Dabei ist der Cookie, wenn man so will, nur der unschuldige Überbringer der Nachricht.</p>
<p>Ein Cookie kann in der Regel nur von der Webseite gelesen werden, die ihn auch gesetzt hat. Das ist ein wichtiges Sicherheitsmerkmal. Setzt spiegel.de also einen Cookie, kann nur spiegel.de diesen Cookie lesen. Man spricht vom <strong>First-Party-Cookie</strong>. Nutzt spiegel.de die Dienste eines MarTech-Unternehmens, geschieht das oft über sogenannte <strong>Third-Party-Cookies</strong>. Dazu erzeugt spiegel.de auf seiner Seite z.B. mit JavaScript, einen kleinen, für den Nutzer unaufälligen Aufruf, zu einer anderen Webseite, z.B. track.martech-company.de. Dadurch kann auf dem Computer des Nutzers beim Aufrufen von spiegel.de ein zusätzliches Cookie, eine Third-Party-Cookie, von track.martech-company.de gesetzt werden.</p>
<p>Besucht der Nutzer danach heise.de, wo auch die Dienste von track.martech-company.de eingesetzt werden, kann das MarTech-Unternehmen seinen Cookies auslesen. Dadurch kann das MarTech-Unternehmen eine Verbindung herstellen: Der Nutzer war erst auf spiegel.de, dann auf heise.de und so weiter.</p>
<p>Da viele Browser Third-Party-Cookies standarmäßig blockieren, setzen viele MarTech-Unternehmen auf eine einfache Weiterleitung: Der eben erwähnte unaufällige Aufruf geht einfach an martech.spiegel.de und wird von dort intern zu track.martech-company.de weitergeleitet. Damit handelt es sich wieder um einen “vertrauenswürdigen” First-Party-Cookie.</p>
<p>Der Third-Party-Cookie sind also nicht das Problem, geschweige denn der Cookie ansich. Denn es eine ganze Menge anderer Technologien, um den Benutzer in irgendeiner Form im Web zu identifizieren.</p>
<p>Der <strong>ETag</strong> etwa, essentieller Bestandteil von HTTP, kann als eindeutiges Identifizierungsmerkmal genutzt werden. Mit <strong>Finger Printing</strong> lassen sich verschieden technische Merkmale zu einem eindeutigen Hash zusammensetzen. Die <strong>IP-Adresse</strong> ist nach ebenfalls ein essentieller Bestandteil der Kommunikation im Internet - IP steht für Internet Protokoll.</p>
<p>Eine weitere Möglichkeit sind <strong>Identitäts-Plattformen</strong>. Sie werben mit dem Versprechen, mit einem zentralen Konto den Zugriff auf viele Internetdienste zu ermöglichen (<strong>Single-Sign-On</strong>). <strong>Google</strong> und <strong>Facebook</strong> sind zwei der bekanntesten Plattformen.</p>
<p>Das ist bequem, hat aber auch den Effekt, das in einem Facebook-Konto jede Anmeldung zentral erfasst wird. Egal, ob man sich in einem Auto-Forum oder bei einem Kaffe-Blog angemeldet hat. Die <strong>netId</strong>, ein Projekt von <strong>RTL</strong>, <strong>Pro7Sat1</strong> und <strong>United Internet</strong>, wird als europäischer Antagonist platziert. Der Vorteil dieser Plattformen: Die Nutzung geschieht freiwillig.</p>
<p>Der letzte Schrei sind übrigens <a href="https://piwikpro.de/blog/cookie-tracking-alternative-moeglichkeiten-zu-klassischem-tracking/">Id-Graphen</a>. Dabei werden alle verfügbaren Informationen, E-Mail-Adresse, Geo-Lokalisierung, IP-Adressen, Social-Media-Profile uvm. gesammelt und dann mit Hilfe von deterministischen oder probabilistischen Methoden verknüpft. Der große Vorteil: Dieses Methode funktioniert geräteübergreifend. Egal, ob der Nutzer mit dem Laptop, Smartphone oder Smart-TV im Web unterwegs ist, sein Weg durch das Internet ergibt eine Spur.</p>
<p>Fakt ist im Moment: <a href="https://www.heise.de/ct/artikel/Trotz-neuer-Schutzmassnahmen-koennen-Verbraucher-Tracking-kaum-entgehen-4537827.html">In der Realität wird sich das Tracking nicht vermeiden lassen.</a> Man wird <a href="https://www.heise.de/select/ct/2018/21/1539407897209303">sich der personalisierten Werbung nicht entziehen können</a>.</p>
<h2 id="daten">Daten</h2>
<p><a href="https://chiefmartec.com/2020/04/marketing-technology-landscape-2020-martech-5000/">Laut chiefmartec.com verzeichnt</a> die Anzahl der MarTech-Unternehmen aus der Kategorie &ldquo;Daten&rdquo; mit 25% das größte Wachstum in 2020. Daten sind das Produkt der oben genannten Wertschöpfungskette, in der ein essentieller Teilnehmer, der eigentliche Datenlieferant, gar nicht berücksichtigt wird: Der Nutzer.</p>
<p>Jaron Lanier forderte bereits 2013 ein Ende der Umsonst-Mentalität und <a href="https://www.deutschlandfunkkultur.de/internetkritiker-jaron-lanier-schluss-mit-der-umsonst.1264.de.html?dram:article_id=437491">eine finanzielle Ausgleich für den, der Daten liefert</a>. Auf dem Global Solutions Summit in Berlin forderte Angela Merkel in 2018 dazu auf, <a href="https://www.zeit.de/politik/deutschland/2018-05/steuerreform-angela-merkel-daten-eu">Daten einen angemessenen Wert beizumessen</a>:</p>
<blockquote>
<p>Die Bepreisung von Daten, besonders die der Konsumenten, ist aus meiner Sicht das zentrale Gerechtigkeitsproblem der Zukunft.</p>
<p>Angela Merkel, 2018</p></blockquote>
<p>Der Ruf, dass Daten als Gut auch bezahlt werden müssen, <a href="https://www.latimes.com/opinion/story/2020-06-23/andrew-yang-data-dividend-tech-privacy">wird immer</a> wieder <a href="http://amortizedcost.net/make-them-pay-for-personal-data/">laut</a>.</p>
<p>Das Problem ist übrigens hausgemacht. Die Gründerzeit des Internets hat dem Nutzer eine Kostenlos-Menthalität beigebracht, die es nun gilt ihm wieder abzugewöhnen. Auf der anderen Seite stehen Inhalteanbieter und Werbetreibende, die die Reichweite des Internets schätzen</p>
<p>Eine Möglichkeit wäre, die Inhalteanbieter von der Abhängigkeit der Advertiser zu befreien. Um das zu erreichen, wird bereits seit einiger Zeit auf <strong>Mikotransaktionen</strong> und <strong>Cookie-Walls</strong> oder <strong>Pay-Walls</strong> gesetzt. Spiegel Online setzt das vorbidlich um. Hier wird nicht versucht, dem Nutzer mit Fachbegriffen zu verwirren und zu einer Entscheidung zu verleiten. Der Nutzer kann das Online-Angebot gegen Bezahlung nutzen: Entweder mit seinen &ldquo;Daten&rdquo; oder ganz schnöde und konservativ: Mit Geld.</p>
<p><a href="https://www.nickyreinert.de/files/marketing-killed-the-internet-star/grafik-13.png"><img src="/2020/2020-10-24-marketing-killed-the-internet-star/images/grafik-13-700x602.png" alt=""></a></p>
<p>Daten oder Abo? (abgerufen von spiegel.de am 24.10.2020)</p>
<p>Einen anderen Weg geht <a href="https://coil.com/p/coil/Coil-Mozilla-and-Creative-Commons-Launch-100-Million-Grant-for-the-Web-to-Advance-Web-Monetization-f/Bdp8Hgcf4">Coil, ein Konsortium</a> von <strong>Mozilla</strong> und <strong>Creative Commons</strong>. Das Projekt wurde im September 2019 gestartet, mit dem Ziel das Gerechtigkeitsproblem zu lösen. Mit finanzieller Unterstützung will man Inhaltserzeuger dazu bewegen, auf Werbung und Datenerfassung zu verzichten. Dazu stellt das Konsortium Mittel in Höhe von 100 Mio. USD bereit. Nutzert können sich für 5 USD im Monat registrieren und bekommen so Zugriff auf kostenpflichtige Inhalte im Internet. Die Einnahmen werden dann an die Inhalteanbieter verteilt. Das ganze geschieht natürlich unter strengster Einhaltung von Datenschutzgrundsätzen.</p>
<p>Der <a href="https://de.wikipedia.org/wiki/Brave_%28Browser%29">Browser Brave</a> versucht ebenfalls Nutzer und Publisher direkt zusammenzubringen. Wird Werbung ausgespielt, erhalten Nutzer und Browser-Hersteller <strong>15%</strong> der Einnahmen, der Publisher erhält <strong>70%.</strong> Die Gutschrift erfolgt in Form der digitalen Währung Basic Attention Token. Eine Benutzerverfolgung findet nicht statt.</p>
<h2 id="und-nun">Und nun?</h2>
<p>Jeff Jarvis konstatiert, dass das Problem nicht die Werbung sei, sondern die Ökonomie der Massenmedien, die im Internet nicht funktioniert. Heißt: Es werden mehr Inhalte erzeugt, da diese Clicks bringen. Die Lösung: Nur gute Inhalte liefern und sonst zu verlinken. Der Inhalteanbieter muss sich auf das Erzeugen von Inhalten konzentrieren, nicht das Erzeugen von Werbe-Umsätzen.</p>
<blockquote>
<p>Do what you do best and link to all the rest.</p>
<p><a href="https://www.theguardian.com/media/2007/apr/30/mondaymediasection.internet">Jeff Jarvis, 30.04.2007</a></p></blockquote>
<p>Sein Appell: Werbung nicht abschaffen, sondern reparieren. Denn ein Internet und seine Dienste können ohne Werbung nicht funktionieren. Das muss auch nicht so sein. Das Ziel soll es sein, Inhalteanbieter für ihre Leistung fair zu belohnen. Immer unter der Prämisse: Die Inhalte sind das Produkt, nicht die Nutzer.</p>
<p>Hat Online Marketing das Web umgebracht? Nein. Aber mindestens zu seinen Gunsten geformt, es verändert. <a href="https://www.cjr.org/special_report/building-honest-internet-public-interest.php">Wäre das Internet eine Stadt</a>, &ldquo;wäre Wikipedia ein öffentlicher Park und der Rest wären Einkaufspassagen&rdquo;.</p>
<p>Steht das Online Marketing unter Generalverdacht? Nein. Werbebudgets müssen gerecht verteilt, Kampagnen optimiert werden. Allerdings sollte die Datensouveränität beim Nutzer liegen. Man muss dem Nutzer die Entscheidung in die Hände legen, welche persönlichen Daten er preisgibt und ihn dementsprechend dafür belohnen. Diese Daten müssen denzentral gespeichert werden und nicht durch eine Plattform verwaltet werden, an die der Nutzer sich gebunden fühlt.</p>
<p>Stell dir vor, der Nutzer könnte eine Art <strong>Werbeprofil</strong> in seinem Browser verwalten. Die Informationen sind nur dort und gegebenenfalls auf synchronisierten Geräten verfügbar. Der Nutzer bestimmt, welche persönlichen Informationen er preisgeben will. Je wertvoller diese Daten für die Advertiser sind, desto größer fällt eine &ldquo;Belohnung&rdquo; aus. </p>
<p>Der Nutzer wäre ein gleichberechtigtes Mitglied im Wertschöpfungskreislauf des Online Marketings.</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> internet, online-marketing, www</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Online Marketing killed the Internet Star - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>essay</dc:type>
      
      
    </item><item>
      <title>Das Memory Limit von PHP und WordPress erhöhen - die vollständige Anleitung</title>
      <link>https://nickyreinert.de/2020/2020-10-23-das-memory-limit-von-php-wie-funktioniert-es/</link>
      <pubDate>Fri, 23 Oct 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-10-23-das-memory-limit-von-php-wie-funktioniert-es/</guid>
      <description>Das Memory Limit, sprich die Speichergrenze, von PHP ist für viele oft ein Rätsel. Es ist nicht klar, wie bzw. wo es gesetzt wird und welche Auswirkungen die …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine vollständige und detaillierte Anleitung zum PHP &#39;memory_limit&#39;. Der Artikel erklärt die Funktionsweise der Speichergrenze und beschreibt die komplexe Hierarchie der verschiedenen Konfigurationsorte – von der globalen &#39;php.ini&#39; über Webserver-Einstellungen in Apache und Nginx (&#39;.htaccess&#39;, &#39;httpd.conf&#39;) bis hin zu anwendungsspezifischen Definitionen in WordPress (&#39;wp-config.php&#39;) und auf Skriptebene (&#39;ini_set&#39;).</p>
          
          
          <p><strong>Hauptthemen:</strong> PHP, Server-Administration, WordPress, Nginx, Apache, Performance-Tuning, Troubleshooting</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p>Das Memory Limit, sprich die Speichergrenze, von PHP ist für viele oft ein Rätsel. Es ist nicht klar, wie bzw. wo es gesetzt wird und welche Auswirkungen die unterschiedlichen Einstellungsorte haben. <a href="https://wp-ninjas.de/wordpress-php-memory-limit">Viele</a> <a href="https://www.hosttest.de/artikel/was-ist-das-php-memory-limit-1411.html">Anleitungen</a> <a href="https://socialmediadozent.com/php-memory-limit-erhoehen/#Drei_Loesungen_um_das_PHP_Memory_Limit_zu_erhoehen">sind</a> <a href="https://www.how-to-wordpress.de/php-memory-limit/">oft</a> <a href="http://juliusbeckmann.de/blog/php-memory-limit-erhohen.html">unvollständig</a>, und tragen damit eher zur Irritation bei. Denn tatsächlich gibt es unzählige Möglichkeiten das Memory Limit zu setzen:</p>
<ul>
<li>super-global in der php.ini</li>
<li>global in der pool.conf, bei Verwendung von PHP-FPM</li>
<li>oder global in der httpd.conf (Apache) oder server.conf (nginx)</li>
<li>auf Ordner-Ebene in der user.ini</li>
<li>auf Ordner-Ebene in der .htaccess-Datei</li>
<li>auf Applikations-Ebene über die WordPress-Konstanten WP_MEMORY_LIMIT und WP_MAX_MEMORY_LIMIT</li>
<li>oder auf Datei-Ebene im Script mit ini_set();</li>
</ul>
<p><a href="https://www.nickyreinert.de/files/das-memory-limit-von-php-wie-funktioniert-es/grafik-7.png"><img src="/2020/2020-10-23-das-memory-limit-von-php-wie-funktioniert-es/images/grafik-7-700x246.png" alt=""></a></p>
<p>Unterschiedliche Orte, um das PHP Memory Limit (und andere Parameter) zu setzen</p>
<p>Die Reihenfolge entspricht übrigens der Hierarchie. Wird das Limit also im PHP-Script mit ini_set() gesetzt, überschreibt das die Einstellung in der <strong>httpd.conf</strong> oder <strong>server.conf</strong>. Wie sich das vermeiden lässt, dazu unten mehr. Das trifft natürlich nicht nur auf das Memory Limit, sondern so ziemlich jede PHP-Einstellung zu.</p>
<p>Außerdem hängen die Möglichkeiten stark davon ab, wie du PHP nutzt, also ob als Modul oder über CGI. Um das Vorgehen besser zu verdeutlichen, gehe ich im Folgenden von zwei WordPress-Setups aus. Einmal wird nginx als HTTP-Server genutzt und dort PHP-FPM über CGI angesprochen. Das zweite Setup nutzt Apache2 als HTTP-Server und dort PHP als Modul (php-mod).</p>
<h2 id="was-bedeutet-das-memory-limit-von-php">Was bedeutet das Memory Limit von PHP?</h2>
<p>Jeder Dienst benötigt für seine Ausführung Platz im Arbeitsspeicher. So auch PHP. Und mit jedem Aufruf eines PHP-Scripts wird PHP aktiviert und fordert somit Platz im Arbeitsspeicher ein. Und genau dort spielt die Speichergrenze eine Rolle: Um zu vermeiden, dass bei der Verarbeitung <strong>eines PHP-Scripts</strong> zu viel Speicher verbraucht und damit der ganze Server in Mitleidenschaft gezogen wird, legt man eine Obergrenze fest, das <strong>memory_limit</strong>.</p>
<p>Diese Grenze gilt <strong>für jeden einzelnen Script-Aufruf</strong>. Ein Beispiel: Dein Server hat 8 GByte (<strong>8.192 MByte</strong>) Arbeitsspeicher. Der Aufruf der Datei index.php, die eine sehr aufwendige Datenbankabfrage durchführt und damit viele Daten verarbeitet, erfordert 10 MByte Arbeitsspeicher (das ist übrigens relativ viel und <a href="https://www.deimeke.net/dirk/blog/index.php?/archives/304-Bytes-auf-Papier-....html">entspricht etwa 5.000 bedruckten A4 Seiten</a>). Das Memory-Limit ist auf <strong>32 MByte</strong> eingestellt. Das physikalische Limit beträgt allerdings <strong>8.192 MByte</strong>. Die index.php kann also <strong>819 mal</strong> gleichzeitig (!) aufgerufen werden; erst dann ist der Arbeitsspeicher voll. Das Memory-Limit hat hier also keine Auswirkungen.</p>
<p>Gehen wir nun davon aus, dass bei einem der <strong>819</strong> Aufrufe bestimmte Parameter gesetzt werden, die eine weitaus größere Datenmenge in der Datenbank abfragen. Die Datenmenge erhöht sich auf <strong>40 MByte</strong>. An dieser Stelle wird das memory_limit aktiv. Der Aufruf dieses Scripts wird abgebrochen mit der Fehlermeldung, dass die erlaubte Speichergrenze überschritten wurde. PHP wird in diesem Fall eine Fehlermeldung wie diese anzeigen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Fatal error: Allowed memory size of 33554432 bytes exhausted…” followed by something like “(tried to allocate 8388608 bytes) in /home/www/index.php on line 42.”
</span></span></code></pre></div><p>Das Gute daran: Der Aufruf der anderen Scripte wird davon nicht in Mitleidenschaft gezogen.</p>
<p>Es gibt sehr viele Wege, das Speicherlimit zu setzen. Das hat Vorteile aber auch Nachteile: So wird die Suche nach den gesetzen Einstellungen oft zur Suche nach der berühmten Nadel im Heuhaufen. Der Vorteil: Du kannst das Speicherlimit sehr granular an die Anforderungen deiner verschiedenen Anwendungen anpassen. Bereit? Los gehts&hellip;</p>
<h2 id="grundsätzliches">Grundsätzliches</h2>
<p>Der Wert, den du für das Memory Limit übermittelst, kann als einfache Ziffer übergeben werden und legt die Speichergrenze somit in <strong>Byte</strong> fest. PHP unterstützt darüber hinaus einige <strong><a href="https://www.php.net/manual/de/faq.using.php#faq.using.shorthandbytes">Kurzschreibweisen</a></strong>, also z.B. K für Kilobyte (32K), M für Megabyte (256M) und G für Gigabye (2G).</p>
<p>Willst du verhindern möchtest, dass die Speichergrenze später an anderer Stelle überschrieben wird, definierst du sie mithilfe von <strong>php_admin_value</strong> anstatt nur <strong>php_value</strong>. Also z.B.:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">php_admin_value[memory_limit] = 256M
</span></span><span class="line"><span class="ln">2</span><span class="cl"># oder
</span></span><span class="line"><span class="ln">3</span><span class="cl">fastcgi_param PHP_ADMIN_VALUE &#34;memory_limit = 256M&#34;;
</span></span><span class="line"><span class="ln">4</span><span class="cl"># oder
</span></span><span class="line"><span class="ln">5</span><span class="cl">php_admin_value memory_limit = 256M
</span></span></code></pre></div><p>Willst du das Memory LImit komplett deaktivieren, dann setzt du es auf -1:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">memory_limit = -1
</span></span></code></pre></div><p>Aber Achtung: Zu Testzwecken mag das sinnvoll sein, in einer Live-Umgebung solltest du immer mit einer Obergrenze arbeiten.</p>
<p>Und abschließend noch der Verweis auf zwei nützliche Funktionen, die eigentlich bekannt sein sollten:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">echo ini_get(&#39;memory_limit&#39;); // zeigt das aktuell gesetzte Memory Limit
</span></span><span class="line"><span class="ln">2</span><span class="cl">phpinfo(); // zeigt alle relevanten Parameter, u.a. Memory Limit und verwendete .ini-Dateien
</span></span></code></pre></div><p><a href="https://www.nickyreinert.de/files/das-memory-limit-von-php-wie-funktioniert-es/grafik-1.png"><img src="/2020/2020-10-23-das-memory-limit-von-php-wie-funktioniert-es/images/grafik-1-700x25.png" alt=""></a></p>
<p><strong>Wichtig</strong>: Derartige Funktionen dienen der Fehlersuche und sollten im Live-System nicht unbedingt öffentlich abrufbar sein!</p>
<h2 id="das-memory-limit-in-php-einstellen">Das Memory Limit in PHP einstellen</h2>
<h3 id="super-global-in-der-phpini">Super global in der php.ini</h3>
<p>Die erste &ldquo;Konfigurations-Stufe&rdquo; befindet sich natürlich direkt innerhalb von PHP. Wenn du wissen willst, wo sich die Einstellungen für PHP befinden, nutze ganz einfach phpinfo(); Die entsprechende Datei heißt <strong>php.ini</strong> und befindet sich in der Regel in /etc/php/7.0/apache2/php.ini (für PHP als Modul, z.B. in <strong>Apache2</strong>) oder /etc/php/7.4/fpm/php.ini (für PHP als Dienst, z.B. in <strong>nginx</strong>). Der Parameter ist in beiden Fällen gleich:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">memory_limit = 256M
</span></span></code></pre></div><p>Wenn du PHP als Modul unter Apache nutzt, musst du Apache2 neustarten, bzw. die Konfiguration neu einlesen lassen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">service</span> <span class="n">apache2</span> <span class="n">restart</span> 
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">service</span> <span class="n">apache2</span> <span class="n">reload</span>
</span></span></code></pre></div><p>Analog, bei PHP als Dienst, wie z.B. in nginx, erfolgt das Neustarten folgendermaßen (In der Regel reicht es aus, mit reload nur die Konfiguration neu zu laden. Sollte es zu Komplikationen kommen, hilft ein kompletter Neustart des Dienstes eventuell weiter).</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">service</span> <span class="n">php7</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">fpm</span> <span class="n">restart</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">service</span> <span class="n">php7</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">fpm</span> <span class="n">reload</span>
</span></span></code></pre></div><h3 id="für-jeden-php-fpm-pool-in-der-poolconf">Für jeden PHP-FPM Pool in der pool.conf</h3>
<p>Nutzt du PHP-FPM über CGI (also mein erstes Setup mit nginx), gibt es für jeden Server (bzw. virtuellen Host) einen eigenen <strong>Pool</strong>, lies eine Art eigene getrennte PHP-Umgebung für jeden einzelnen virtuellen Host. Die Einstellungen dazu befinden sich z.B. unter <strong>/etc/php/7.4/fpm/pool/my_host.conf</strong>. Hier wird der entsprechende Parameter folgendermaßen gesetzt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[my_host_de]
</span></span><span class="line"><span class="ln">2</span><span class="cl">...
</span></span><span class="line"><span class="ln">3</span><span class="cl">php_value[memory_limit] = 1024M
</span></span><span class="line"><span class="ln">4</span><span class="cl">...
</span></span></code></pre></div><p>Die Einstellung an dieser Stelle überschreibt den Wert in der <strong>php.ini</strong>. Nach der Änderung muss der PHP-Dienst natürlich neu gestartet werden.</p>
<h2 id="das-memory-limit-in-apache2-und-nginx-setzen">Das Memory-Limit in Apache2 und nginx setzen</h2>
<h3 id="super-global-in-der-nginxconf--httpdconf">Super global in der nginx.conf / httpd.conf</h3>
<p>Für die beiden HTTP-Server nginx und Apache2 gibt es die beiden globalen Einstellungsdateien <strong>/etc/nginx/nginx.conf</strong> bzw. <strong>/etc/apache2/httpd.conf</strong>. In nginx kann das PHP-Limit im sogenannten <strong>http-Kontext</strong> gesetzt werden und gilt damit für die komplette Nginx-Instanz. Ich gehe hier und im Folgenden übrigens davon aus, dass nginx den PHP-Interpreter über FastCGI anspricht und PHP eigenständig als FPM läuft.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">http {
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  fastcgi_param PHP_VALUE &#34;memory_limit = 256M&#34;;
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">}
</span></span></code></pre></div><p>Im Falle von Apache2 gehe ich davon aus, dass PHP als Modul konfiguriert ist. Hier wird das PHP Limit in der <strong>httpd.conf</strong> folgendermaßen gesetzt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">php_value memory_limit = 256M
</span></span></code></pre></div><h3 id="global-für-jeden-virtuellen-host">Global für jeden virtuellen Host</h3>
<p>In nginx lässt sich die entsprechende Einstellung auch innerhalb des Server-Blocks setzen und gilt somit für einen ganzen virtuelle Host. Üblicherweise findest du diese Einstellung in <strong>/etc/nginx/conf.d/my_host.conf:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">server {
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  fastcgi_param PHP_VALUE &#34;memory_limit = 256M&#34;;
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">}
</span></span></code></pre></div><p>Nutzt du Apache2, findest du die entsprechende Einstellungs-Datei in der Regel unter <strong>/etc/apache2/sites-enabled/my_host.conf</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&lt;VirtualHost&gt;
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">php_value memory_limit 256M
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">&lt;/VirtualHost&gt;
</span></span></code></pre></div><h3 id="global-für-jeden-ordner">Global für jeden Ordner</h3>
<p>Weiter geht es mit dem Ordner-Spezifische Memory-Limit in nginx im location-Kontext (die Datei dürfte in der Regel unverändert sein).</p>
<p>Achtung: <a href="http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html">In nginx kann die Direktive fastcgi_param</a> auch im übergeordneten http-Kontext oder auf Ordner-Ebene innerhalb des location-Blocks gesetzt werden:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">location ~ .(php|php.*)$ {
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">  fastcgi_param PHP_VALUE &#34;memory_limit = 256M&#34;;
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">}
</span></span></code></pre></div><p>Analog dazu kannst du in Apache2 das Limit global in apache2.conf oder auf Ordner-Ebene in der my_host.conf:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="o">&lt;</span><span class="ne">Directory</span><span class="s2">&#34;/var/www/example_de/htdocs/&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">php_value</span> <span class="n">memory_limit</span> <span class="mi">256</span><span class="n">M</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="o">&lt;/</span><span class="ne">Directory</span><span class="o">&gt;</span>
</span></span></code></pre></div><h2 id="das-memory-limit-auf-ordner-ebene-setzen">Das Memory-Limit auf Ordner-Ebene setzen</h2>
<h3 id="für-jeden-ordner-mit-der-userini">Für jeden Ordner mit der .user.ini</h3>
<p>Mit der Datei <strong>.super.ini</strong> kannst du PHP-Einstellungen für beliebige Ordner individuell konfigurieren. Dieser Weg steht dir allerdings nur offen, <a href="https://www.php.net/manual/en/configuration.file.per-user.php">wenn du PHP nicht als Modul nutzt, sondern über CGI/FastCGI</a>. In meinem Beispiel-Setup mit Apache2 und php-mod fällt diese Option also weg.</p>
<p>Du kannst die Datei in jedem Ordner anlegen und dort Parameter so einstellen, wie du es von der php.ini gewohnt bist. Dieser Weg muss allerdings vorher &ldquo;freigeschaltet&rdquo; werden, indem in der php.ini (bzw. den anderen o.g. Orten), der folgende Parameter gesetzt ist:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">user_ini.filename = .user.ini
</span></span></code></pre></div><p>Ob das der Fall ist, erfährst du, wie immer, mithilfe von phpinfo();. Dort siehst du unter &ldquo;Additional .ini files parsed&rdquo; auch, ob sich im aktuellen Ordner eine .user.ini befindet und diese gelesen wurde:</p>
<p><a href="https://www.nickyreinert.de/files/das-memory-limit-von-php-wie-funktioniert-es/grafik-4.png"><img src="/2020/2020-10-23-das-memory-limit-von-php-wie-funktioniert-es/images/grafik-4-700x164.png" alt=""></a></p>
<p>Überprüfen, welche .ini-Dateien PHP gelesen hat</p>
<p>Wenn das alles passt, verwendest du die .user.ini wie die php.ini und setzt das Speicherlimit demnach folgenermaßen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">memory_limit=256M
</span></span></code></pre></div><h3 id="für-jeden-ordner-mit-der-htaccess">Für jeden Ordner mit der .htaccess</h3>
<p>Diese Option wiederum steht dir nur mit Apache2 zur Verfügung, da nginx keine .htaccess-Dateien unterstützt. Du setzt das Limit in der .htaccess-Datei folgendermaßen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">php_value memory_limit = 256M
</span></span></code></pre></div><h2 id="das-memory-limit-auf-applikations-ebene-setzen">Das Memory-Limit auf Applikations-Ebene setzen</h2>
<p>WordPress verwendet standardmäßig eine Memory Limit von <strong>40</strong> <strong>MByte</strong> im Frontend (bzw. 64 MByte bei einem Multi-Site-Setup) sowie (mindestens) <strong>256 MByte</strong> für das Backend. Wenn du diese Werte ändern möchtest, kannst du dafür die beiden folgenden Konstanten in der <strong>wp-config.php</strong> setzen - achte darauf, diese Konstanten vor der Einbindung von <strong>wp-settings.php</strong> zu definieren:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">define(&#39;WP_MEMORY_LIMIT&#39;, &#39;256M&#39;);
</span></span><span class="line"><span class="ln">2</span><span class="cl">define(&#39;WP_MAX_MEMORY_LIMIT&#39;, &#39;256M&#39;);
</span></span><span class="line"><span class="ln">3</span><span class="cl">[...]
</span></span><span class="line"><span class="ln">4</span><span class="cl">require_once(ABSPATH . &#39;wp-settings.php&#39;);
</span></span></code></pre></div><p>WordPress nutzt intern allerdings auch nur die PHP-Funktion ini_set um das Memory Limit festzulegen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">ini_set( &#39;memory_limit&#39;, WP_MEMORY_LIMIT );
</span></span></code></pre></div><h2 id="das-memory-limit-auf-datei-ebene-setzen">Das Memory-Limit auf Datei-Ebene setzen</h2>
<p>Zum Abschluss gibt es auch die Möglichkeiten das Memory Limit in jedem Script individuell zu setzen. Diese Möglichkeit steht an letzter Stelle und überschreibt damit alle vorhergehenden Einstellungen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">ini_set(&#39;memory_limit&#39;,&#39;256M&#39;);
</span></span></code></pre></div><p>Durch die Verwendung von <strong>include()</strong>, <strong>require_once()</strong> oder <strong>require()</strong> lassen sich andere PHP-Dateien innnerhalb eines Scripts einzubinden. Grundsätzlich wird das Memory Limit dann zwar vererbt. Was nicht heißt, dass es durch später eingebundene Scripte überschrieben werden kann. Das macht sich z.B. auch bei WordPress bemerkbar: Du kannst das Memory Limit zwar mit WP_MEMORY_LIMIT für WordPress definieren, ein Plugin oder Theme kann das Limit aber trotzdem später überschreiben.</p>
<p>Ein Beispiel: So sieht die Datei <strong>index.php</strong> aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&lt;?php  ini_set(&#39;memory_limit&#39;,&#39;256M&#39;);  (...aufwendige Operation...);  include(&#39;file.php&#39;); 
</span></span></code></pre></div><p>Die Datei <strong>file.php</strong> sieht folgendermaßen aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl"> &lt;?php
</span></span><span class="line"><span class="ln">2</span><span class="cl"> echo ini_get(&#39;memory_limit&#39;);
</span></span><span class="line"><span class="ln">3</span><span class="cl"> (…aufwendige Operation…)
</span></span><span class="line"><span class="ln">4</span><span class="cl"> ini_set(&#39;memory_limit&#39;,&#39;32M&#39;);
</span></span><span class="line"><span class="ln">5</span><span class="cl"> (…aufwendige Operation…);
</span></span></code></pre></div><p>Die zweite Zeile in der file.php gibt als Rückgabe <strong>256M</strong> aus. Das Memory-Limit wird vererbt. Die vierte Zeile setzt das Limit allerdings auf 32 MByte und überschreibt damit den Wert von 256 MByte. Belegt die &ldquo;aufwendige Operation&rdquo; in index.php nur <strong>12 MByte</strong>, in der file.php nur jeweils <strong>5 MByte</strong>, funktioniert das gesamte Script einwandfrei. Wenn die &ldquo;aufwendige Operation&rdquo; in der Datei index.php z.B. mehr als <strong>22 MByte</strong> beansprucht, bricht PHP die Verarbeitung des Scripts ab. Warum? Weil das Limit nachträglich nach unten korrigiert wurde.</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> apache, apache2, memory-limit, nginx, php</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>anleitungen</category>
      
      <category>blog</category>
      
      <category>hosting</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Das Memory Limit von PHP und WordPress erhöhen - die vollständige Anleitung - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>comprehensive_guide</dc:type>
      
      
    </item><item>
      <title>Automatisierte WordPress Installation</title>
      <link>https://nickyreinert.de/2020/2020-10-08-automatisierte-wordpress-installation/</link>
      <pubDate>Thu, 08 Oct 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-10-08-automatisierte-wordpress-installation/</guid>
      <description>Et voilá. Ein BASH Script, um WordPress automatisiert über die Kommandozeile zu installieren, inklusive Theme und beliebigen Plugins sowie - wenn benötigt - …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Dieser Artikel stellt ein Bash-Skript zur vollautomatischen Installation und Konfiguration von WordPress vor. Das Skript nutzt &#39;wp-cli&#39; zur Einrichtung von Core, Datenbank, Themes und Plugins und kann die neue WordPress-Instanz mit zufällig generiertem Content (Beiträge, Kategorien, Bilder) über externe APIs befüllen, was es zu einem nützlichen Tool für Entwickler und Administratoren macht.</p>
          
          
          <p><strong>Hauptthemen:</strong> WordPress, Automatisierung, Bash Scripting, DevOps, wp-cli, Server Administration, Web Development, Content Generation</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p>Et voilá. Ein BASH Script, um WordPress automatisiert über die Kommandozeile zu installieren, inklusive Theme und beliebigen Plugins sowie - wenn benötigt - zufälligen Beiträgen, Kategorien, Tags und Bildern.</p>
<h2 id="warnung">Warnung!</h2>
<p>Du solltest geübt im Umgang mit der Shell, Bash und WordPress sein und unbedingt <strong>Backups</strong> nutzen. Das Script verwendet, wenn der entsprechende Parameter gesetzt ist, den Befehl &ldquo;rm -rf&rdquo;, um einen Ordner komplett zu <strong>löschen</strong>. Dieser Schritt lässt sich nicht widerrufen. Außerdem wird, sofern per Parameter gefordert, eine Datenbank mit &ldquo;DROP DATABASE&rdquo; komplett entfernt. Wenn du das Script auf eine existierende WordPress-Installation oder Datenbank anwendest, können existierende Daten <strong>überschrieben</strong> werden!</p>
<h2 id="funktionsweise">Funktionsweise</h2>
<p>Das Script wird über die Kommandozeile aufgerufen und nutzt die <a href="https://wp-cli.org/de/">WordPress Kommandozeilen-Benutzeroberfläche,</a> um <strong>WordPress</strong> zu installieren sowie samt <strong>Themes</strong> und <strong>Plugins</strong> einzurichten. Du kannst außerdem beliebig viele <strong>Beiträge</strong> anlegen. Die Inhalte für die Beiträge stammen von einem Online-Dienst für zufällige englische Texte: <a href="http://metaphorpsum.com/paragraphs/">metaphorpsum.com/paragraphs</a>. Außerdem werden zufällige <strong>Textauszüge</strong> (Excerpts) sowie <strong>Schlagwörter</strong> (Tags) und sogar <strong>Bilder</strong> jedem Beitrag hinzugefügt. Beiträge werden außerdem Kategorien zugeordnet. Diese werden ebenfalls <strong>zufällig</strong> bis zu einer Tiefe von 2 Ebenen erzeugt.</p>
<h2 id="installation">Installation</h2>
<p>Du findest den Sourcecode auf github: <a href="https://github.com/nickyreinert/AutomatedWordPressInstallation">https://github.com/nickyreinert/AutomatedWordPressInstallation</a>.</p>
<p>Nach der Installation kopierst du die Datei settings-template zu .settings, um in dieser Datei die Einstellungen für deine WordPress-Installation vorzunehmen. Du startest den Prozess mit <strong>bash start.sh</strong> oder setzt den Ausführen-Flag für bash.sh um diese direkt auszuführen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">chmod u+x bash.sh
</span></span><span class="line"><span class="ln">2</span><span class="cl">./bash.sh
</span></span></code></pre></div><h2 id="zufällige-inhalte">Zufällige Inhalte</h2>
<p>Das Script ermöglicht das Anlegen von beliebig vielen zufälligen Beiträgen in beliebig vielen zufälligen Kategorien. Was genau dabei passiert, beschreibe ich hier kurz:</p>
<p>Zunächst wird eine Kategorie erzeugt. Dazu wird von der folgenden API ein zufälliges Wort abgerufen: <a href="https://random-word-api.herokuapp.com/word?swear=0&amp;number=">https://random-word-api.herokuapp.com/word?swear=0&amp;number=</a></p>
<p>Dieser Kategorie wird dann ein Beitrag wird mit einer beliebigen Anzahl von <strong>Absätzen</strong> von dieser API zugeordnet: <a href="http://metaphorpsum.com/paragraphs/">http://metaphorpsum.com/paragraphs/</a>. Der Beitrag erhält einen zufälligen Titel (von dort: <a href="http://metaphorpsum.com/sentences/">http://metaphorpsum.com/sentences</a>), einen Textauszug (gleiche API), sowie eine beliebige Anzahl zufälliger Tags (Schlagwörter), ebenfalls von <a href="https://random-word-api.herokuapp.com/word?swear=0&amp;number=">random-word-api.herokuapp.com</a>. Dann werden für diesen Beitrag Revisionen erzeugt - auch diese in beliebiger Höhe. Abschließend erhält jeder Beitrag ein zufälliges Featured Image sowie ein weiteres zufälliges Bild am Ende des Fließtextes.</p>
<p>Je nachdem, wieviele Beiträge und Kategorien bzw. Sub-Kategorien eingerichtet werden soll, wird dieser Prozess natürlich wiederholt.</p>
<p><em>(Bisher werden die Inhalte leider nur auf Englisch eingefügt)</em></p>
<h2 id="einstellungen">Einstellungen</h2>
<p>Alle Einstellungen befinden sich in der Datei <strong>.settings</strong> und werden im Folgenden beschrieben. Der PROJECT-Parameter kann im weiteren Verlauf als Platzhalter verwendet werden und sollte keine Leerzeichen oder Sonderzeichen enthalten:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">PROJECT=myWordPressBlog
</span></span></code></pre></div><h3 id="datenbank">Datenbank</h3>
<p>Du kannst eine neue Datenbank anlegen (CREATE_DB) oder auf eine existierende Datenbank zurückgreifen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">DB_DROP=yes|no
</span></span><span class="line"><span class="ln">2</span><span class="cl">CREATE_DB=yes|no
</span></span><span class="line"><span class="ln">3</span><span class="cl">DB_ROOT=root
</span></span><span class="line"><span class="ln">4</span><span class="cl">DB_ROOT_PASSWORD=secret
</span></span></code></pre></div><p>Willst du eine frische Datenbank anlegen, solltest du die alte Datenbank mit DB_DROP=yes löschen. Soll eine neue Datenbank angelegt werden, müssen die Zugangsdaten für einen privilegierten Nutzer angegeben werden: Mit den folgenden Parameter legst du fest, wie WordPress auf die Datenbank zugreift:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">DB_HOST=127.0.0.1
</span></span><span class="line"><span class="ln">2</span><span class="cl">DB_NAME=&#34;${PROJECT}&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">DB_PREFIX=&#34;wp_&#34;
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">ADD_DB_USER=yes|no
</span></span><span class="line"><span class="ln">6</span><span class="cl">DB_USER=&#34;${PROJECT}&#34;
</span></span><span class="line"><span class="ln">7</span><span class="cl">DB_USER_PASSWORD=$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | fold -w 32 | head -n 1)
</span></span></code></pre></div><p>Das Passwort wird im Beispiel zufällig erzeugt, willst du ein eigenes Passwort verwenden, kannst du den Parameter überschreiben, z.B:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">DB_USER_PASSWORT=secret
</span></span></code></pre></div><p>Der DB-Nutzer wird natürlich nur angelegt, wenn ADD_DB_USER=yes gesetzt ist. Andernfalls musst du hier die passenden Zugangsdaten angeben.</p>
<h3 id="wordpress">WordPress</h3>
<p>Du kannst auf eine existierende Installation zurückgreifen, um z.B. dort Beiträge hinzuzufügen, oder WordPress komplett neu installieren. Hier kannst du z.B. auch den oben festgelegten PROJECT-Parameter nutzen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="n">WP_PATH</span><span class="o">=</span><span class="s2">&#34;/var/nginx/htdocs/${PROJECT}/&#34;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="n">INSTALL_CORE</span><span class="o">=</span><span class="n">yes</span><span class="o">|</span><span class="n">no</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="n">WP_DROP</span><span class="o">=</span><span class="n">yes</span><span class="o">|</span><span class="n">no</span>
</span></span></code></pre></div><p>Mit WP_DROP kannst du festlegen, dass der Ordner WP_PATH komplett gelöscht wird. <strong>Vorsicht</strong> ist hier also geboten! Die folgenden Parameter betreffen deine allgemeinen WordPress-Einstellungen. Bei der URL kannst du wieder den PROJECT-Platzhalter nutzen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">WP_TITLE=&#39;WordPress Test&#39;
</span></span><span class="line"><span class="ln">2</span><span class="cl">URL=&#34;https://blog.example.org/${PROJECT}&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">WP_ADMIN_NAME=admin
</span></span><span class="line"><span class="ln">4</span><span class="cl">WP_ADMIN_EMAIL=mail@example.org
</span></span><span class="line"><span class="ln">5</span><span class="cl">WP_ADMIN_PASSWORD=secret
</span></span></code></pre></div><p>Willst du ein eigene Passwort vergeben, kannst du auch hier ein zufälliges Passwort erzeugen lassen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">WP_ADMIN_PASSWORD=$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | fold -w 32 | head -n 1)
</span></span></code></pre></div><h3 id="theme-und-plugins">Theme und Plugins</h3>
<p>Mit den folgenden Parametern legst du fest, welches Theme eingerichtet und welche Plugins installiert werden sollen. Der Theme-Name ist der Slug des Themes:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">INSTALL_THEME=yes|no
</span></span><span class="line"><span class="ln">2</span><span class="cl">THEME=&#34;elementor&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">INSTALL_PLUGINS=no
</span></span><span class="line"><span class="ln">5</span><span class="cl">PLUGINS=&#34;elementor wordpress-seo tinymce-advanced ninja-forms shortcodes-ultimate instagram-feed ml-slider the-events-calendar amp contact-widgets coblocks woocommerce&#34;
</span></span></code></pre></div><p>Du kannst mehrere Plugins angeben, wenn diese per Leerzeichen voneinander getrennt sind.</p>
<h3 id="inhalte">Inhalte</h3>
<p>Der nächste Abschnitt regelt das (zufällige) Anlegen von Beiträgen, Kategorien usw. Natürlich musst du keine Inhalte anlegen. Ist <strong>RANDOMIZE_EVERY_ITEM</strong> auf <strong>yes</strong> gesetzt, wird jeder Beitrag wie oben zufällig erzeugt. Da das eine Menge HTTP-Requests erfordert, kannst du den Parameter auch auf no setzen. In dem Fall wird jede Zufalls-API genau einmal abgerufen. Der ganze Prozess wird dadurch maßgeblich beschleunigt.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">ADD_CONTENT=yes|no
</span></span><span class="line"><span class="ln">2</span><span class="cl">META_INPUT=&#34;&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">RANDOMIZE_EVERY_ITEM=yes|no
</span></span></code></pre></div><p>Manche Themes, wie z.B. <strong>Elementor</strong>, fügen den Inhalten, also Beiträgen, bestimmte Meta-Informationen hinzu. Beim automatisierten Anlegen von Beiträgen passiert das allerdings nicht automatisch. Du kannst das hier also entsprechend einrichten. Der Wert wird als JSON übergeben. Achte auf das einfache Anführungszeichen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">META_INPUT=&#39;{&#34;_elementor_edit_mode&#34;:&#34;&lt;![CDATA[builder]]&gt;&#34;,&#34;_elementor_template_type&#34;:&#34;&lt;![CDATA[kit]]&gt;&#34;,&#34;_elementor_version&#34;:&#34;&lt;![CDATA[2.9.13]]&gt;&#34;}&#39;
</span></span></code></pre></div><p>Die folgenden Paremeter legen fest, wieviele Inhalte du erzeugen möchtest:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">COUNT_CATEGORIES_LEVEL1=10
</span></span><span class="line"><span class="ln">2</span><span class="cl">COUNT_CATEGORIES_LEVEL2=5
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">COUNT_POSTS=100
</span></span><span class="line"><span class="ln">5</span><span class="cl">COUNT_PARAGRAPHS=20
</span></span><span class="line"><span class="ln">6</span><span class="cl">COUNT_POST_REVISIONS=5
</span></span><span class="line"><span class="ln">7</span><span class="cl">COUNT_TAGS=20
</span></span></code></pre></div><p>Im Beispiel werden 10 Haupt-Kategorien mit jeweils 5 Unter-Kategorien angelegt. Jede Kategorie wird mit 100 Posts befüllt und jeder Post erhält 20 Tags und 5 Revisionen. Das ergibt also 10 * 5 * 100 * 5 Beiträge = 25.000 Beiträge! In diesem Fall macht es Sinn RANDOMIZE_EVERY_ITEM auf no zu setzen, da du sonst mehre tausende Anfragen an die Zufalls-APIs generieren würdest. COUNT_PARAGRAPHS legt die Länge jedes Beitrags in Absätzen fest.</p>
<h3 id="standard-parameter">Standard-Parameter</h3>
<p>Die folgenden Parameter musst du in der Regel nicht anpassen. WP_CLI legt den Pfad zur WordPress Kommandozeilen Oberfläche fest. Wird die Datei nicht gefunden, muss WP CLI installiert werden. Dazu dient der Parameter WP_CLI_SOURCE.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">WP_CLI_EXEC=~/wp-cli.phar
</span></span><span class="line"><span class="ln">2</span><span class="cl">WP_CLI_SOURCE=https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar
</span></span></code></pre></div><p>Im folgenden werden die Quellen für die APIs festgelegt. Hier solltest du nichts ändern, da das Script für die Zusammenarbeit mit diesen Quellen eingerichtet ist. Einzig beim Parameter RANDOM_IMAGE_API_URI kannst du bei Bedarf in der URL die Auflösung der abgefragten Bilder festlegen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">RANDOM_WORD_API_URL=&#39;https://random-word-api.herokuapp.com/word?swear=0&amp;number=&#39;
</span></span><span class="line"><span class="ln">2</span><span class="cl">RANDOM_SENTENCE_API_URL=&#39;http://metaphorpsum.com/sentences/&#39;
</span></span><span class="line"><span class="ln">3</span><span class="cl">RANDOM_TEXT_API_URL=&#39;http://metaphorpsum.com/paragraphs/&#39;
</span></span><span class="line"><span class="ln">4</span><span class="cl">RANDOM_IMAGE_API_URI=&#39;https://picsum.photos/200/300.jpg&#39;
</span></span></code></pre></div>
        
        
        <div class="tags">
          <p><strong>Tags:</strong> automatisierung, bash, installation, script, setup, wordpress, DevOps</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      <category>development</category>
      
      <category>tools</category>
      
      <category>wordpress</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Automatisierte WordPress Installation - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>project_documentation</dc:type>
      
      
    </item><item>
      <title>Das Ticket-Preis-System der Deutschen Bahn - oder: wie findest du den optimalen Fahrschein-Preis?</title>
      <link>https://nickyreinert.de/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/</link>
      <pubDate>Wed, 09 Sep 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/</guid>
      <description>Update 3.10.2020 - Flexpreis Plus, siehe Teil 1
Ich reise gerne. Nicht viel, aber gerne. Am liebsten jage ich mit einem Porsche Cayenne quer durch die Republik. …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine tiefgehende, mehrteilige Analyse des komplexen Ticket-Preissystems der Deutschen Bahn. Der Artikel erklärt die verschiedenen Preis-Kategorien, reverse-engineert die undokumentierte Preis-API, analysiert die gesammelten Daten statistisch auf Muster und Einflussfaktoren und stellt mit &#39;nickets.de&#39; eine alternative, visuelle Preissuchmaschine als Lösung vor.</p>
          
          
          <p><strong>Hauptthemen:</strong> Datenanalyse, Deutsche Bahn, Verkehr, API-Reverse-Engineering, Datenvisualisierung, Preisstrategie</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p><em>Update 3.10.2020 - <strong>Flexpreis Plus</strong>, siehe Teil 1</em></p>
<p>Ich reise gerne. Nicht viel, aber gerne. Am liebsten jage ich mit einem Porsche Cayenne quer durch die Republik. Auf der linken Spur der Autobahn. Mit 250 Sachen. Der linke Blinker im Dauerbetrieb. Den Finger am Hebel für die Lichthupe, wie an einem Abzug.</p>
<p>Die Sache hat natürlich einen kleinen Haken: Ich habe weder einen Porsche noch eine Tankkarte mit Flatrate. Ich hab nicht mal ein Auto, das 250 km/h fährt.</p>
<p><strong>Ich fahre aber auch sehr gerne mit der Bahn</strong>. Am liebsten in der 1. Klasse. Bequeme Sitze, ein Schokoherzchen zur Begrüßung, Sitzplatzreservierung inklusive, breite Ledersitze sowieso. Und dann sitze ich da und schaue verträumt nach links aus dem Fenster, zur Autobahn, wo ein paar Unverbesserliche im Stau stehen.</p>
<p>1. Klasse? Moment mal. Ist das nicht <strong>versnobt</strong>? Unbezahlbar? Nein. Ist es nicht. Man kann relativ günstig mit der 1. Klasse fahren, wenn man sich durch das Preis-System der Deutschen Bahn gequält hat und etwas flexibel ist. Und da hätten wir auch schon unser Problem und damit auch die <strong>erste und auch oberste Prämisse</strong> für diesen Essay: Die Suche nach dem optimalen Preis macht nur dann Sinn, wenn Geld mindestens eine Rolle spielt und wenn man flexibel in der Wahl der Abfahrtszeit ist, vielleicht sogar was den Reisetag angeht. Und wenn man trotzdem damit leben kann, an eine Verbindung gebunden zu sein, sobald das Ticket gebucht ist.</p>
<p>Nun ist das Preis-System bzw. dessen Darstellung aber <a href="https://www.heise.de/tp/features/Das-Preissystem-der-Bahn-zwischen-Irrwitz-und-Unverschaemtheit-4268591.html">ein wenig unübersichtlich</a>, so dass <a href="https://www.adac.de/der-adac/aktuelles/guenstig-bahnfahren/">die Suche nach dem besagten optimalen Preis</a> zu einem Geduldsspiel wird, weshalb man sich am Ende wohl schlicht mit dem begnügt, was am günstigsten erscheint: <strong>2. Klasse, Super-Sparpreis.</strong> Dem muss aber nicht so sein&hellip;</p>
<h2 id="überblick">Überblick</h2>
<p>Was dich hier erwartet: Im <strong>1. Teil</strong> erkläre ich, wie das Preis-System der Deutschen Bahn aufgebaut ist. Im <strong>2. Teil</strong> zeige ich, warum die aktuelle Oberfläche kaum dabei hilft, das komplexe Preissystem zu begreifen. Im <strong>3. Teil</strong> erkläre ich dir, wenn dich der technische Hintergrund interessiert, wie du an die Preise für die Verbindungen kommst. Im <strong>4. Teil</strong> versuche ich herauszufinden, ob sich die Preisbildung nachvollziehen und vielleicht sogar eine <strong>Faust-Formel</strong> erkennen lässt und im <strong>5. Teil</strong> schließe stelle ich eine <strong>alternative Oberfläche</strong> vor. Viel Spaß.</p>
<p>Wenn du dich nur für die alternative Oberfläche interessiert und dich der analytische und technische Teil nicht interessiert, dann schau einfach direkt auf <a href="http://nickets.de">nickets.de</a> vorbei bzw. <strong>überspringe Teil 1 bis 4</strong>,</p>
<p><em>Zur Verteidigung der Bahn möchte ich vorab noch festhalten, dass der Vorgang der Bepreisung von Fahrkarten sicher nicht banal ist. Eine Verbindung von Berlin nach Stuttgart ist nicht nur einfach das. Sie kann über mehrere Zwischenbahnhöfe gehen und es gibt zig Faktoren, die die Preisfindung beeinflussen können.</em></p>
<h2 id="teil-1-die-preis-kategorien-der-deutschen-bahn">Teil 1: Die Preis-Kategorien der Deutschen Bahn</h2>
<p>Das Preis-System der Deutschen Bahn ist <strong>komplex</strong>. Die Deutsche Bahn bietet <strong>zwei Klassen</strong> mit jeweils <strong>drei Kategorien</strong> an. Es gibt in der 1. und 2. Klasse jeweils den Flex-Preis, den Spar-Preis und den Super-Spar-Preis:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-74-700x559.png" alt=""></p>
<p>Abbildung 1: Preis-Kategorien für Tickets der Deutschen Bahn</p>
<p>Die insgesamt <strong>sechs Katgegorien</strong> habe ihre Vor- und Nachteile und sind <strong>offensichtliche Faktoren</strong>, die den <strong>Ticketpreis beeinflussen</strong>. Ich will die Eigenschaften der Kategorien nur ganz grob beschreiben, um die Komplexität im Ansatz begreifbar zu machen. Daneben gibt es übrigens noch den Flexpreis Business für Geschäftskunden. Diese Tickets sind einen Tag vor und sieben Tage nach gebuchtem Reisetag gültig.</p>
<h3 id="update-3102020---flexpreis-plus">Update 3.10.2020 - Flexpreis Plus</h3>
<p>Offenbar hat die Bahn eine neue Preis-Kategorie eingeführt. Mit dem <strong>Flexpreis Plus</strong> ist das Ticket nun einen Tag vor und zwei Tage nach gewähltem Reisetag gültig. Die Stornierung ist solange möglich, wie das Ticket gültig ist. Diese Kategorie gibt es offenbar nur in der 1. Klasse und erst für Fahrten ab dem 1. November. Auf der Seite der Bahn habe ich dazu noch keine Informationen gefunden. Der Übersicht ist das natürlich nicht gerade zuträglich.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-73-700x329.png" alt=""></p>
<p>Der Flexpreis Plus, ab dem 1. November 2020?</p>
<h3 id="freie-zugwahl">Freie Zugwahl</h3>
<p>Fangen wir mit dem <strong>Flex-Preis</strong> an, der den wirklich angenehmen Vorteil der freien <strong>Zugwahl</strong> am Reisetag ermöglicht. Man kann die Fahrt sogar unterbrechen und erst am nächsten Tag fortsetzen. Der Flexpreis soll grundsätzlich gleich hoch sein, unterscheidet sich aber in der Realität, um die &ldquo;<a href="https://www.bahn.de/p/view/angebot/flexpreis.shtml"><strong>Nachfragelenkung</strong> zu optimieren</a>&rdquo;. Beim Flex-Preis gibt es allerdings eine zusätzliche Ebene, die Einfluss auf den Preis hat: Die Zug-Art wird, wie z.B. bei der Auto-Vermietung, ebenfalls unterschiedlich bepreist. Ein <strong>ICE-Ticket</strong> gehört zu einer <strong>höheren</strong> <strong>Kategorie</strong> als ein IC-Ticket. Buchst du ein Ticket für den IC, kannst du damit am gleichen Tag alle IC-Verbindungen nutzen, nicht jedoch den ICE (dafür wäre ein Aufschlag nötig, Stichwort <strong>Produktübergang</strong>).</p>
<h3 id="sitzplatzreservierung">Sitzplatzreservierung</h3>
<p>Außerdem gibt es ein wichtiges Detail zur <strong>Sitzplatzreservierung</strong>. Diese ist bei der <strong>1. Klasse inklusive</strong>. In der <strong>2. Klasse</strong> kostet sie <strong>4 Euro</strong>. Wer sich nicht auf ein Abenteuer (Reise nach Jerusalem) einlassen will, sollte diesen Aufschlag immer einkalkulieren. Gerade bei populären Verbindungen ist die Auslastung der Züge relativ hoch.</p>
<p>Der <strong>Super-Spar-Preis</strong> der 2. Klasse ist (siehe Abbildung 1) dann &ldquo;nur&rdquo; noch knapp 25 Euro günstiger als in der 1. Klasse. Der einzige Vorteil des Spar-Preises gegenüber dem Super-Spar-Preis ist übrigens die <strong>Stornomöglichkeit</strong> und das <strong>Cityticket</strong>. Der Storno ist bis vor den Reisetag gegen eine Gebühr von <strong>10 Euro</strong> möglich. Irritierend daran: Die Gebühr ist immer gleich, egal ob das Ticket 17,90 Euro oder über 200 Euro kostet. Am Reisetag ist die Stornierung des Flex-Tickets übrigens auch kostenpflichtig, hier sogar <strong>19,90 Euro</strong>.</p>
<h3 id="das-city-ticket">Das City-Ticket</h3>
<p>Den Vorteil des <strong>City-Ticket</strong> habe ich in meinen Betrachtungen aus mehreren Gründen als vernachlässigbar eingestuft. Zunächst verbaut man sich damit am Start- und Zielort die Möglichkeit, das optimale Reisemittel selber zu wählen. Es gibt ja durchaus günstige Alternativen. Außerdem ist das City-Ticket nur bei Verbindungen über <strong>100 km</strong> und in &ldquo;nur&rdquo; <strong>130 Städten</strong> kostenlos dabei. Hinzu kommen lokalspezifische Einschränkungen: So gilt das City-Ticket z.B. in Berlin nur in den <strong>Tarifbereichen A und B</strong>, nicht jedoch C. Aus diesen Gründen hab ich das City-Ticket und damit die <strong>Spar-Preise</strong> in den folgenden Betrachtungen <strong>komplett ignoriert</strong> (ein weiterer Grund ist technischer Natur, dazu später mehr).</p>
<p>Zum Problem der <strong>Komplexität</strong> trägt der <strong>Spar-Preis</strong> übrigens auch noch bei da der Aufpreis nicht fix ist, sondern zwischen (laut meinen Stichproben) <strong>3,60 und 10 Euro schwankt.</strong> Auch das ist absurd, da das City-Ticket im Preis relativ beständig sein sollte und die Storno-Option, nunja, nur ein &ldquo;Service&rdquo; ist.</p>
<h3 id="andere-einflüsse-auf-den-preis">Andere Einflüsse auf den Preis</h3>
<p>Soviel zu den offensichtlichen Faktoren. Hinzu kommen noch weniger offensichtliche Faktoren, wie z.B. die <strong>Reisezeit</strong>. Wie sehr der Spar-Preis abhängig von der Tageszeit schwanken kann, siehst du in der folgenden Abbildung. Es handelt sich um den geringsten Super-Spar-Preis für die Verbindung Berlin-Stuttgart über den Tag verteilt.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-47-700x433.png" alt=""></p>
<p><strong>Abbildung 2:</strong> Kleinster Super-Spar-Preis für die Verbindung Berlin - Stuttgart in Abhängigkeit von der Tageszeit (Abreise), ohne Umsteigen</p>
<p>Die günstigste Zeit zum Reisen ist für diese Verbindung also der Vormittag. In der ersten Klasse macht es sogar Sinn, erst abends zu reisen. Gegen 21 Uhr ist das <strong>Super-Spar-Preis-Ticket</strong> sogar günstiger als zu anderen Zeiten in der 2. Klasse. <strong>Achtung:</strong> Es handelt sich um die aggregierten Werte über die <strong>Tageszeit</strong>. Das besagte günstige 1. Klasse-Ticket bezieht sich auf einen anderen Tag. Es ist also nicht nur die Uhrzeit ausschlaggebend, sondern auch der Wochentag. Die Preise über den <strong>Wochentag</strong> aggregiert zeigt folgende Abbildung: Dienstag ist also 1.-Klasse-Spar-und-Fahrtag:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/Spar-Preis-ueber-den-Wochentag-Berlin-Stuttgart-700x432.png" alt=""></p>
<p><strong>Abbildung 3:</strong> Kleinster Spar-Preis für die Verbindung Berlin - Stuttgart in Abhängigkeit von der Tageszeit (Abreise), ohne Umsteigen</p>
<p>Der <strong>Preis</strong> einer Verbindung ist also von <strong>vielen Faktoren abhängig</strong>. Da wäre es doch schön, wenn man die Preise in einer schönen Übersicht vergleichen könnte. (Übrigens, just als ich diesen Artikel geschrieben habe, <a href="https://www.deutschebahn.com/de/presse/pressestart_zentrales_uebersicht/ICE-Fahren-zum-kleinen-Preis-Super-Sparpreis-Young-ab-12-90-Euro-5577616">hat die Deutsche Bahn einen Sonderpreis für &ldquo;<strong>junge Leute bis 26</strong>&rdquo; angekündigt</a>. Es handelt sich dabei um ein auf <strong>1 Mio. Tickets</strong> limitiertes Sonderangebot für den Super-Spar-Preis der 2. Klasse.) Das Problem: Derzeit gibt es im Buchungssystem der DB keinen Hinweis darauf.</p>
<p>Wollen wir doch mal schauen, wie einfach es ist, den optimalen Preis für ein Ticket der Deutschen Bahn zu finden.</p>
<h2 id="teil-2-das-buchungssystem-der-deutschen-bahn">Teil 2: Das Buchungssystem der Deutschen Bahn</h2>
<p>Um ein Ticket bei der Bahn zu buchen sind mir bisher zwei (bzw. drei) Wege bekannt: Das Portal für <strong>Tickets und Angebote</strong> (auch <strong>Reiseauskunft</strong>) und der <strong>Sparpreis-Finder</strong>. Wir möchten diese Portale <strong>Oberfläche 1</strong> und <strong>2</strong> nennen. Hinzu kommt <strong><strong>Oberfläche</strong></strong> <strong>3</strong>, das ebenfalls zum Sparpreis-Finder gehört. Oberfläche 1 und 2 erreichst du recht simpel, wenn du <a href="http://bahn.de/">bahn.de</a> direkt aufrufst, über das Menü <strong>Tickets &amp; Angebote</strong>. Oberfläche 2 führt dich am Ende zu Oberfläche 3. Oberfläche 3 ist entweder über die Google-Suche oder wenn du dich durch das Hover-Menü klickst. Es ist liegt außerdem auf einer anderen Sub-Domain, auf der das Hover-Menü &ldquo;Tickets &amp; Angebote&rdquo; nicht mehr existiert. Du kommst also nur auf Umwegen wieder zurück_._</p>
<p>Hinweis: Es gibt noch eine zusätzliche Oberfläche, die mobile Anwendung. Hier ist es aber aufgrund technischer Maßnahmen nicht ohne weiteres möglich, an die HTTP-Abfragen zu kommen. Diese sind per TLS geschützt, lassen sich also nicht ohne weiteres über z.B. einen Proxy abfangen. SSL-Pinning sorgt außerdem dafür, dass man mit einfache Boardmitteln kein eigenes SSL-Zertifikat unterschummeln kann. Der Aufwand hat den Nutzen überstiegen.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-700x443.png" alt=""></p>
<p><strong>Abbildung 4:</strong> Oberfläche 1 - Die Reiseauskunft</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-1-700x544.png" alt=""></p>
<p><strong>Abbildung 5:</strong> Oberfläche 2 - Der Sparpreis-Finder</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-2-700x753.png" alt=""></p>
<p><strong>Abbildung 6:</strong> Oberfläche 3 - Der &ldquo;eigentliche&rdquo; Sparpreis-Finder</p>
<p>Warum gibt es nun drei bzw. zwei Oberflächen? Was ist der Unterscheid? Schauen wir mal.</p>
<h3 id="die-ergebnisseiten">Die Ergebnisseiten</h3>
<p>Die Verbindung <strong>Berlin - Stuttgart</strong> gehört zu meinen &ldquo;Lieblingsverbindungen&rdquo;, da ich hier relativ oft unterwegs bin bzw. war. Als Reisedatum nehme ich den <strong>17.09.2020, einen wunderschönen Donnerstag</strong>. Da wir auf der Suche nach Schnäppchen sind, wähle ich die 2. Klasse und außerdem die einfache Fahrt. <strong>Ohne Rückreise!</strong> Warum? Wenn du beide Fahrten gleichzeitig buchst, kannst du diese nicht getrennt voneinander stornieren. Stornierst du die Hinfahrt, ist auch die Rückfahrt weg. Macht keinen Sinn, ist aber leider so. Deswegen solltest du die <strong>Rückreise immer getrennt buchen</strong>. Keine Sorge, du verschenkst dadurch <strong>keinen Preisnachlass</strong>, wie z.B. bei Flugreisen.</p>
<p><strong>Oberfläche 2 und 3</strong> führen beide zur gleichen Ergebnissseite: Eine ziemlich lange Liste mit Spar-Preisen (sic!), den Abfahrtszeiten, Dauer und Umsteigezeiten Das ganze für den kompletten Tag (bzw. den gewählten Zeitraum). Außerdem wird <strong>angeblich</strong> auch der <strong>Flex-Preis</strong> angezeigt - laut Checkbox. Findest du ihn?</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/Sparpreis-Finder-Ergebnis-Seite-150x150.png" alt=""></p>
<p><strong>Abbildung 7:</strong> Die Tagesübersicht aller Super-Spar-Preis</p>
<p>Der Flex-Preis wird erstens nicht immer ausgewiesen und zweitens nicht explizit als solcher markiert. Er wird erst angezeigt, wenn du mit der Maus darüber hoverst, die Details anklickst oder zur Buchung gehst.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-6-700x245.png" alt=""></p>
<p><strong>Abbildung 8:</strong> Der versteckte Flex-Preis</p>
<p>Verwirrend außerdem. Der Flex-Preis ist an dieser Stelle sogar um einiges günstiger, als der Spar-Preis. Nur blöd, dass man den Flexpreis, mit all seinen Vorteilen, nicht sofort erkennt.</p>
<p>Geht es weiter zur Buchung, erfährst du außerdem, dass die Liste die tatsächlich nur die <strong>Super-Spar-Preise</strong> enthält, nicht die Spar-Preise. Preislich und leistungstechnisch macht das, siehe oben, durchaus einen Unterschied. Diese Information erhält man auch, wenn man auf das kleine i-Symbol der jeweiligen Verbindung klickt.</p>
<p>Diese Übersicht ist trotz allem, wie wir gleich sehen werden, hilfreicher als bei Oberfläche 1, weil man für eine Klasse die Preise eines ganzen Tages sieht.</p>
<p>Kommen wir zu <strong>Oberfläche 1</strong>, die auf den ersten Blick einen viel kompakteren Eindruck macht. Hier wird der Flex-Preis zwar besser ausgezeichnet und die Informationen sind optisch etwas schöner aufbereitet, es gibt sogar eine Auslastungsinformation, allerdings werden in der Regel nur drei Verbindungen angezeigt.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/Preis-Uebersicht-150x150.png" alt=""></p>
<p><strong>Abbildung 9:</strong> Die Preise der Obefläche 1</p>
<p>Mit Klick auf &ldquo;früher&rdquo; oder &ldquo;später&rdquo; kannst du den Zeitraum zwar erweitern, wirst aber nie den kompletten Tag als Übersicht erhalten. Schade.</p>
<p>Soviel zu der Möglichkeit, die für sich optimalste Preiskategorie bzw. Verbindung herauszusuchen.</p>
<h2 id="zwischenfazit-das-problem-der-vergleichbarkeit">Zwischenfazit: Das Problem der Vergleichbarkeit</h2>
<p>Das größte Problem, an dem das Buchungssystem der Deutschen Bahn krankt, ist die <strong>Vergleichbarkeit</strong>. Der Aufschlag für den Spar-Preis schwankt, die Preise schwanken nach der Tageszeit, sie sind abhängig davon, wie knapp man ein Ticket bucht usw. usf. Es ist nachvollziehbar, dass Preise geändert werden, um die Nachfrage zu steuern. Umso hilfreicher wäre es aber, die Preise vergleichbarer darzustellen.</p>
<p>Eine Oberfläche zeigt zwar die Preise im Tagesverlauf an, dafür aber nur die Super-Spar-Preise. Eine andere Oberfläche zeigt die Preise für einen weitaus kleinen Zeitraum an, dafür aber auch den Flex-Preis. Keine Oberfläche zeigt einen direkten Vergleich der Klassen an, außer <strong>wenn die 2. Klasse ausgebucht</strong> ist:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-3-700x132.png" alt=""></p>
<p><strong>Abbildung 10:</strong> 1. Klasse-Preis bei der 2. Klasse-Übersicht</p>
<p>Um das beste Preis-Leistungs-Verhältnis zu finden, <strong>fehlt es an einer einheitlichen Darstellung</strong>. Man kann mit der Komlexität leben, wenn die Übersicht nur etwas sinnvoller gestaltet wäre. Bevor wir uns diesem Problem widmen, will ich trotzdem mal versuchen, eine Regelmäßigkeit in der Bepreisung zu entdecken.</p>
<h2 id="teil-3-wie-funktioniert-die-ticket-api-der-deutschen-bahn">Teil 3: Wie funktioniert die Ticket-API der Deutschen Bahn?</h2>
<p>Bevor ich die Daten auswerte, erkläre ich kurz, für alle technisch interessierten, wie man an die Preise kommt. Auf der Suche nach einer Beschreibung der Preis-Api bin ich auf folgendes Dokument gestoßen: <a href="https://wiki.fhem.de/w/images/6/63/Parametrisierte_%C3%9Cbergabe_Bahnauskunft%28V_5.12-R4.30c%2C_f%C3%BCr.pdf">Externe Aufrufparameter und Rückgabeparameter an externe System (pdf)</a>. Diese Information konnte ich als Grundlage nutzen, um die Anfragen an den DB-Server zu formulieren (die Dokumentation ist allerdings unvollständig und weicht in einigen Punkten ab, ist also vermutlich veraltet).</p>
<h3 id="die-identifikation-der-bahnhöfe">Die Identifikation der Bahnhöfe</h3>
<p>Die beiden wichtigsten Parameter zur Ticket-Suche sind, wie sollte es anders sein, der <strong>Start- und Zielbahnhof</strong>. Hier gibt es mehrere Möglichkeiten, diese zu bestimmen.</p>
<p>Die <strong>erste Methode</strong> ist der offizielle Weg über die (nach Registrierung) frei zugängliche <a href="https://developer.deutschebahn.com/store/apis/info?name=StaDa-Station_Data&amp;version=v2&amp;provider=DBOpenData&amp;">Stations-Daten-API an.</a> Die Liste enthält zu jedem Bahnhof den Namen im Klartext, die Geo-Lokation und eine Kategorie (Hauptbahnhof, Wald-und-Wiesen-Bahnhof, &hellip;) Die dort aufgeführten Bahnhöfe werden in der Regel ohne Probleme auch von der Preis-Auskunft erkannt.</p>
<p>Die zweite Methode führt über einen GET-Request, der dir drei verwertbare Informationen liefert. Der <strong>öffentliche Endpunkt</strong> dazu lautet:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">https://reiseauskunft.bahn.de/bin/ajax-getstop.exe/dn
</span></span></code></pre></div><p>Die wichtigsten Parameter lauten hier:</p>
<ul>
<li>S - Der Suchbegriff, entweder als
<ul>
<li>expliziter String (z.B. <em>Berlin</em>)</li>
<li>String mit Platzhalter (z.B. <em>Berlin*</em>, alles was mit Berlin beginnt)</li>
<li>Fuzzy-Search-String (z.B. <em>Kaulsdorf?</em>, liefert als Ergebnis auch <em>Zaulsdorf</em>)</li>
</ul>
</li>
<li>REQ0JourneyStopsB - die Anzahl der Ergebnisse, optional</li>
</ul>
<p>Das Ergebnis ist ein JSON-Objekt mit sogenannten Vorschlägen (<em>&ldquo;suggestions&rdquo;</em>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">  {
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">            &#34;value&#34;: &#34;BERLIN&#34;,
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">            &#34;id&#34;: &#34;A=1@O=BERLIN@X=13386988@Y=52520501@U=80@L=008096003@B=1@p=1598555590@&#34;,
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">            &#34;extId&#34;: &#34;008096003&#34;,
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">            &#34;type&#34;: &#34;1&#34;,
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">            &#34;typeStr&#34;: &#34;[Bhf/Hst]&#34;,
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">            &#34;xcoord&#34;: &#34;13386988&#34;,
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">            &#34;ycoord&#34;: &#34;52520501&#34;,
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">            &#34;state&#34;: &#34;id&#34;,
</span></span><span class="line"><span class="ln">10</span><span class="cl">            &#34;prodClass&#34;: &#34;319&#34;,
</span></span><span class="line"><span class="ln">11</span><span class="cl">            &#34;weight&#34;: &#34;30849&#34;
</span></span><span class="line"><span class="ln">12</span><span class="cl">        }
</span></span></code></pre></div><p>Die Daten erklären sich fast von selber, für uns relevant sind &ldquo;<em>value&rdquo;</em>, &ldquo;<em>id</em>&rdquo; sowie &ldquo;<em>extId&rdquo;.</em> Alle drei Werten können für die Preissuche verwendet werden.</p>
<h3 id="oberfläche-1---die-reiseauskunft">Oberfläche 1 - Die Reiseauskunft</h3>
<p>Wir bleiben bei der Verbindung Berlin-Stuttgart am 17.09.2020, einem wunderschönen Donnerstag. 2. Klasse und der URL</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">https://www.bahn.de/p/view/angebot/index.shtml?dbkanal_007=L01_S01_D001_KIN0014_top-navi-tickets-angebote_LZ01 bzw. https://www.bahn.de/p/view/angebot/index.shtml 
</span></span></code></pre></div><p>Ein Klick auf Suchen feuert einen <strong>GET-Request</strong> an diese URL ab:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">https://reiseauskunft.bahn.de/bin/query.exe/dn
</span></span></code></pre></div><p>Und natürlich gibt es einen ganzen Stapel Parameter. Den kompletten Aufruf mit allen Parametern kannst du dir unten als Postman-Collection herunterladen. Im folgenden werde ich nur die wichtigsten davon besprechen, also die, die mindestens erforderlich sind, um eine Preis-Information zu erhalten:</p>
<ul>
<li><strong>start=1</strong>, liefere Ergebnisse zurück (starte die Suche), ansonsten wird die erweiterte Suchmaske angezeigt</li>
<li><strong>S=BERLIN</strong> - der Name des Startbahnhofs, hier funktioniert in einigen Fällen der String (siehe oben)</li>
<li><strong>REQ0JourneyStopsSID=A=1@O=BERLIN@X=13386988@Y=52520501@U=80@L=008096003@B=1@p=1598383868@</strong> - grundsätzlich macht es aber Sinn, hier die explizite Id des Bahnhofs zu verwenden</li>
<li><strong>Z=Stuttgart Hbf</strong> - der Zielbahnhof</li>
<li><strong>date=Do, 17.09.20</strong> - Tag der Reise</li>
<li><strong>time=08:00</strong> - Uhrzeit der Reise</li>
<li><strong>timesel=depart</strong> - Bestimmen Tag und Uhrzeit Abfahrt oder Ankunft (arrival)?</li>
<li><strong>tariffTravellerType.1=E</strong> - E oder F für Erwachsener oder Kind</li>
<li><strong>tariffClass=2</strong> - 1. oder 2. Klasse</li>
<li><strong>tariffTravellerReductionClass.1=&hellip;</strong> - hiermit lässt sich mit Ziffern von 0 bis 17 festlegen, ob Vergünstigungen einberechnet werden sollen, wie z.B. eine BahnCard. Das kann sich sicherlich auf den Preis der Tickets auswirken, hat aber keinen Einfluss auf die Vergleichbarkeit der Preise bzw. Analyse der Preisstruktur. Ich ignoriere diesen Parameter also.</li>
</ul>
<p>Eine Handvoll anderer Parameter ist wie gesagt in der Postman-Datei genauer beschrieben. Diese Anfrage liefert uns nun die bekannte Übersicht mit in der Regel drei Verbindungen zurück:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-4-700x484.png" alt=""></p>
<p><strong>Abbildung 11:</strong> Preise der 2. Klasse für Berlin -&gt; Stuttgart am 17.09.2020</p>
<p>Außerdem wird ein Cookie gesetzt, der drei sehr wichtige Daten enthält:</p>
<ul>
<li><strong>ld</strong> - ein Identifier, der vorerst unverändert bleibt, z.B: 37226</li>
<li><strong>seqnr</strong> - in Integer, der initial auf 1 gesetzt wird und dann hochzählt</li>
<li><strong>ident</strong> - ein weiterer Identifier, der sich mit jedem Request ändert</li>
</ul>
<p>Diese drei Informationen werden offenbar auch serverseitig gespeichert, um den Request zuordnen bzw. mehr Details liefern zu können. Wenn man mit Klick auf &ldquo;Später&rdquo; weitere Preise anfordert, wird ein GET-Request abgesetzt, der anhand dieser drei Parameter die Preise für drei weitere Abfahrten abfragt. Hinzu kommt noch der Parameter <strong>REQ0HafasScrollDir=1</strong> bzw. <strong>REQ0HafasScrollDir=2</strong> für spätere oder frühere Abfahrten.</p>
<p><strong>Seqnr</strong> muss außerdem mit jedem Request iteriert werden, um zusätzliche Slots abzufragen. So lassen sich zumindest programmatisch beliebig viele darauffolgende Abfahrtszeiten abfragen. In einem Test konnte ich seqnr bis 20 erhöhen und so auch den kompletten Folgetag abzufragen. Das klappt allerdings nur über Postman, im Browser ist nach <strong>seqnr=3</strong> Schluss:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-19-700x402.png" alt=""></p>
<p><strong>Abbildung 12:</strong> Beschränkte Zeitraum-Abfrage im Browser</p>
<p>Zum Vergleich die Abfrage des darauffolgenden Tages mit Postman - <strong>perfekte gute</strong> Voraussetzungen, um die Preise automatisiert abzufragen:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-20-700x268.png" alt=""></p>
<p><strong>Abbildung 13:</strong> Abfrage eines großen Zeitraums mit Postman</p>
<p>Der Nachteil ist allerdings, dass die Antwort vom Server reines <strong>HTML</strong> ist. Man muss die Preise also mit einem <strong>DOM-Parser</strong> aufwendig manuell extrahieren.</p>
<h3 id="oberfläche-2---der-sparpreis-finder">Oberfläche 2 - Der Sparpreis-Finder</h3>
<p>Diese Oberfläche nutzt einen anderen Endpunkt, der etwas bequemer zu bedienen ist. Hier kommt eine Schnittstelle zum Einsatz, die etwas bequemer mit einem JSON-Object gefüttert wird und sogar ein JSON-Object zurückliefert. Aber der Reihe nach.</p>
<p>Die erste Abfrage, aus der Maske heraus fragt diesen Endpunkt ab:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">https://ps.bahn.de/preissuche/preissuche/psc_start.post
</span></span></code></pre></div><p>Hier werden eine Menge Verbindungs-Parameter in dem GET-Request übermittelt (die wie gehabt in der Postman-Collection genauer beschrieben werden). Dieser Request liefert allerdings nur einen <strong>Schlüssel</strong> aus <strong>Timestamp</strong> und offenbar zufälligem <strong>Hex-Wert</strong> zurück: Dieser Schlüssel wird in einer weiteren Abfrage benötigt, um die tatsächliche Preisauskunft zu erhalten. Der Schlüssel nennt sich <strong>pscexpires</strong> und hat z.B. folgenden Inhalt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">0209201557-3f1a35cab18604c875235a194738d672
</span></span></code></pre></div><p>Der Request wurde um 15:37 Uhr abgesetzt, offenbar ist der Schlüssel also 20 Minuten gültig. Um einen aktuellen Schlüssel zu erhalten, reicht ein minimaler Request, der z.B. nur den Start-Bahnhof enthält:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">https://ps.bahn.de/preissuche/preissuche/psc_start.post?S=BERLIN
</span></span></code></pre></div><p>Damit ausgestatttet kann jetzt ein weiterer Request abgesetzt werden, um die tatsächlichen Preise zu erhalten. Der Endpunkt dafür lautet:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">https://ps.bahn.de/preissuche/preissuche/psc_service.go
</span></span></code></pre></div><p><em>Anmerkung: Ist der eben erwähnte Schlüssel <strong>pscexpires</strong> abgelaufen, erhälst du folgende Fehlermeldung:</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&#34;PSC-Captcha-Session ist abgelaufen!&#34;
</span></span></code></pre></div><p>Hier gibt es zwei relevante Parameter:</p>
<ul>
<li><strong>service=pscangebotsuche</strong> sowie</li>
<li><strong>data={}</strong> ein JSON-Objekt mit den Reise-Parametern</li>
</ul>
<p>Nun können also die Reise-Parameter für die Preissuche übermittelt werden. Das <strong>JSON-Objekt</strong> hat folgenden Aufbau (an dieser Stelle im <strong>YAML-Format,</strong> zur besseren Dokumentation, <a href="https://onlineyamltools.com/convert-yaml-to-json">hiermit</a> kannst du daraus ein gültiges JSON-Objekt erstellen):</p>
<p><em>Anmerkung: Im Gegensatz zur ersten Schnittstelle, kann hier mit der Id der Bahnhöfe gearbeitet werden, die weitaus weniger sperrig ist.</em></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">---
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># Id des Start-Bahnhofs
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">s: 008096003
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"># Id des Ziel-Bahnhofs
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">d: 008000096
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"># Datum
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">dt: 13.09.20
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"># Uhrzeit
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">t: &#39;0:00&#39;
</span></span><span class="line"><span class="ln">10</span><span class="cl"># Zeitraum für die Abfrage in Minuten, mindestens 1, maximal 1440 / 1 Tag
</span></span><span class="line"><span class="ln">11</span><span class="cl">dur: 1440
</span></span><span class="line"><span class="ln">12</span><span class="cl"># der eindeutige Schlüssel (siehe oben)
</span></span><span class="line"><span class="ln">13</span><span class="cl">pscexpires: &#34;{{pscexpires}}&#34;
</span></span><span class="line"><span class="ln">14</span><span class="cl"># ?
</span></span><span class="line"><span class="ln">15</span><span class="cl">dir: 1
</span></span><span class="line"><span class="ln">16</span><span class="cl"># Nur schnellste Verbindungen
</span></span><span class="line"><span class="ln">17</span><span class="cl">sv: false
</span></span><span class="line"><span class="ln">18</span><span class="cl"># Nur Verbindungen ohne ICE
</span></span><span class="line"><span class="ln">19</span><span class="cl">ohneICE: false
</span></span><span class="line"><span class="ln">20</span><span class="cl"># Fahrrad-Mitnahme
</span></span><span class="line"><span class="ln">21</span><span class="cl">bic: true
</span></span><span class="line"><span class="ln">22</span><span class="cl"># ?
</span></span><span class="line"><span class="ln">23</span><span class="cl">tct: &#39;0&#39;
</span></span><span class="line"><span class="ln">24</span><span class="cl"># Klasse (1/2)
</span></span><span class="line"><span class="ln">25</span><span class="cl">c: &#39;2&#39;
</span></span><span class="line"><span class="ln">26</span><span class="cl"># Reisende
</span></span><span class="line"><span class="ln">27</span><span class="cl">travellers:
</span></span><span class="line"><span class="ln">28</span><span class="cl"># E - Erwachsener, F/K - Kind 6 bis 14 Jahre, B - Kind bis 5 Jahre
</span></span><span class="line"><span class="ln">29</span><span class="cl">- typ: E
</span></span><span class="line"><span class="ln">30</span><span class="cl"># Ermäßigungs-Klasse
</span></span><span class="line"><span class="ln">31</span><span class="cl">  bc: &#39;0&#39;
</span></span><span class="line"><span class="ln">32</span><span class="cl"># Alter?
</span></span><span class="line"><span class="ln">33</span><span class="cl">  alter: &#39;&#39;
</span></span></code></pre></div><p>Eine derartige Abfrage liefert ein ziemlich umfangreiches JSON-Objekt zurück, dass ich hier nur grob beschreibe. Unter &ldquo;<em>angebote</em>&rdquo; werden zunächst alle Preise aufgeführt. Die Preiskategorie (Flexpreis, Super Spar-Preis) ist mutmaßlich anhand des Feldes <em>&ldquo;tt&rdquo;</em> erkennbar. SP steht für Super Spar-Preis, NP für Flexpreis. Außerdem gibt es das Feld &ldquo;<em>pky</em>&rdquo;, was wohl für Preiskategorie steht:</p>
<ul>
<li>71830 - Super Sparpreis (Achtung, in der Oberfläche wird oft nur von Spar-Preis gesprochen)</li>
<li>7001 - Flexpreis</li>
</ul>
<p>Unter Verbindungen werden nun alle Fahrten aufgeführt, inklusive der Umstiege und Zeiten und sogar der Zug-Nummern, z.B. ICE 695.</p>
<p>Die Schnittstelle liefert also ein maschinell sehr einfach zu verarbeitendes Ergebnis zurück. Es gibt aber ein <strong>Problem:</strong> Es ist nicht klar, anhand welcher Kriterien entschieden wird, auch den Flexpreis mitzuteilen. Dieser ist nämlich leider nicht immer Teil der Antwort. Bisher konnte ich auch noch nicht herausfinden, ob ich das mit einem Parameter in der Anfage steuern kann.</p>
<h2 id="zwischenfazit">Zwischenfazit</h2>
<p>Wir haben also ein ziemlich komplexes Preissystem und zwei verschiedene Schnittstellen. Wollte man eine alternative Preisübersicht für einen größeren Zeitraum aufbauen, kann man nun</p>
<ul>
<li>die <strong>1. Schnittstelle</strong> nutzen, die zwar Flex-Preis und Spar-Preis auszeichnet, aber immer nur für ein sehr kleines Zeitfenster,</li>
<li>oder auf die <strong>2. Schnittstelle</strong> zurückgreifen, die zwar einen großen Zeitraum mit allen Preisen liefert, aber den Flex-Preis nicht zuverlässig zurück gibt.</li>
</ul>
<p>Bei beiden Schnittstellen fehlt dennoch die <strong>Vergleichbarkeit</strong> mit der 1. Klasse sowie die Aufzählung des (Super-)Spar-Preises, der ja, wie wir wissen, ebenfalls einer Schwankung unterliegt.</p>
<p>Nun, da ich weiß, wie ich programmatisch an die Preise der Deutschen Bahn komme, habe ich ein Script geschrieben, das die Preise für beliebige Verbindungen regelmäßig abrufen kann. Dazu habe ich in mehreren Durchläufen Verbindungen und Preise bis zu <strong>90 Tage</strong> im Voraus abgerufen (90 Tage ist das Limit für das Buchen im Voraus). Die <strong>ersten Durchläufe</strong> (Ende 2019 und Mitte 2020) waren mehr ein Testen und Herantasten, im <strong>finalen Durchlauf</strong> (die &ldquo;relevante Stichprobe&rdquo;) Anfang September 2020 habe ich die folgenden Verbindungen abgefragt:</p>
<ul>
<li>Berlin - Hannover (<a href="https://de.statista.com/statistik/daten/studie/1092635/umfrage/puenktlichkeit-der-zuege-der-deutschen-bahn-auf-den-meistbefahrenen-verbindungen/">die Strecke mit den meisten Verspätungen</a>)</li>
<li>Berlin - Stuttgart (eine selbst gewählte Verbindung, die ich früher oft genutzt habe)</li>
<li>Stuttgart - Berlin (und zurück)</li>
<li>Gotha - Eisenach (eine selbst gewählte möglichst kurze Verbindung)</li>
<li>Ingolstadt - Nürnberg (<a href="https://inside.bahn.de/familie-9-bahnstrecken-mit-wow-effekt/">eine Hochgeschwindigkeitsstrecke</a>)</li>
<li>München - Berlin (eine weitere Hochgeschwindigkeitsstrecke)</li>
<li>Köln - Dresden (eine selbst gewählte Ost-West-Verbindung)</li>
<li>Offenburg - Greifswald (<a href="https://inside.bahn.de/laengste-zugstrecken-deutschlands/">mit 1.300 km die längste Strecke</a>)</li>
</ul>
<p>Erfasst werden die <strong>Abfahrtszeit</strong>, die <strong>Dauer der Reise,</strong> die <strong>Anzahl der Umstiege,</strong> die <strong>erwartete Auslastung,</strong> die <strong>beteiligten Zugarten</strong> und natürlich der <strong>Flex-Preis</strong> sowie der <strong>Super Spar-Preis.</strong> Zur Qualitätssicherung habe ich außerdem die URL zur Preisübersicht erfasst.</p>
<p>Mein <strong>Ziel</strong> ist es zu erkennen, inwiefern Preise von der <strong>Tageszeit</strong> oder dem <strong>Wochentag</strong> abhängen. Wie stark ist der Einfluss der <strong>Auslastung</strong>? Wann muss man ein Ticket spätestens buchen, um noch einen guten Preis zu bekommen? Im nächsten Teil schaue ich mir an, welche Zusammenhänge sich erkennen lassen:</p>
<h2 id="teil-4---analyse-der-ticket-preise-der-deutschen-bahn">Teil 4 - Analyse der Ticket-Preise der Deutschen Bahn</h2>
<p>Als Einstieg werfen wir mal einen Blick auf die Verteilung der Preis. Die folgende Übersicht zeigt die Preise für alle Verbindungen, Klassen und Preis-Kategorien an:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-54-700x412.png" alt=""></p>
<p><strong>Abbildung 14:</strong> Preis-Überblick</p>
<p><em>Anmerkung: &ldquo;Durchschn. Preis&rdquo; meint immer arithmetisches Mittel.</em></p>
<p>Die 1. Klasse bekommt man bei der Deutschen Bahn schon für <strong>12,30 Euro</strong>, das obere Limit liegt bei stabilen <strong>259,70 Euro.</strong> Die günstigste Reise tritt man für <strong>5,60 Euro</strong> an. In Testläufen von 2019 kostete das teuerste Ticket übrigens <strong>294,00 Euro</strong> (Berlin -&gt; Stuttgart, 02.10.2019). Offensichtlich wurden die Preise in 2020 also angepasst.</p>
<p><em>Anmerkung: Die folgende Auswertung zeigt, dass die Verbindung <strong>Offenburg -&gt; Greifswald</strong> nicht mehr als Direktverbindung zu existieren scheint und somit auch nicht, wie angepriesen, die längste zusammenhängende Strecke ist. <a href="https://zugfahrplande.com/ic-zugfahrplan/1846-ic-2216">Offenbar fährt der ICE 2216 nur noch von Stuttgart nach Kiel</a>.</em></p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-4-700x387.png" alt=""></p>
<p><strong>Abbildung 15:</strong> Gegenprobe: Keine Direktverbindungen für Offenburg -&gt; Greifswald?</p>
<p>Die nächste Abbildung zeigt die Dauer, Streckenlänge und mittlere erwartete Auslastung aller abgefragten Verbindungen. Um die Entfernung zu ermittelten, <a href="https://www.evg-online.org/deine-vorteile/services/service-meldungen/entfernungsrechner-fuer-fahrverguenstigungen/">nutze ich dieses Tool</a>.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-55-700x164.png" alt=""></p>
<p><strong>Abbildung 16:</strong> Entferung, Dauer und Auslastung aller Verbindungen</p>
<p>Insgesamt gibt es fünf Stufen der Auslastung, die bei der Ticket-Auswahl angezeigt werden:</p>
<ul>
<li>Außergewöhnliche hohe Auslastung (Stufe 5)</li>
<li>Sehr hohe Auslastung</li>
<li>Hohe Auslastung</li>
<li>Besetzung von mehr als der hälfte der Sitzplätze</li>
<li>Geringe bis mittlere Auslastung (Stufe 1)</li>
</ul>
<p>Im finalen Durchlauf wurde bei alle Verbindungen nur eine <strong>Auslastungen von 1 und 2</strong> erwartet. In früheren Durchläufen gab es auch Auslastungsstufen bis 4 und sogar 5 (nur in 2019). Nichtsdestotrotz: Die Strecke <strong>Berlin -&gt; Hannover</strong> war (siehe oben) zwar eine Verbindung mit den meisten Verspätungen, obgleich sie bei der Auslastung eher im Mittelfeld liegt. Eine Erklärung könnte sein, dass die Deutsche Bahn in 2020 den Fahrplan angepasst hat, um dem entgegen zu wirken. Eine andere Erklärung: <strong>Corona</strong> und damit ein geringeres Reise-Aufkommen.</p>
<h3 id="der-buchungs-zeitpunkt">Der Buchungs-Zeitpunkt</h3>
<p>Schauen wir uns mal die Flex-Preis-Entwicklung (Median über den Tagespreis) aller Direktverbindungen (inkl. Offenburg -&gt; Greifswald mit einem Umstieg) an (2. Klasse). Zur Erinnerung, die Preise wurden am 06. Sept. 2020 abgerufen:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-56-700x441.png" alt=""></p>
<p><strong>Abbildung 17:</strong> Median Flex-Preis 2. Klasse, alle Direktverbindungen (inkl. Offenburg -&gt; Greifswald, 1 Umstieg)</p>
<p>Was fällt auf? <strong>Je höher der Preis, desto größer die Schwankungen</strong>. Der Trend über die 90 Tage ist allerdings relativ stabil. In der 1. Klasse sieht es ähnlich aus. Da wir aber auf der Suche nach Schnäppchen sind, werfen wir doch mal ein Blick auf den günstigsten Preis in dieser Kategorie:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-57-700x444.png" alt=""></p>
<p><strong>Abbildung 18:</strong> günstigster Flex-Preis, 2. Klasse, alle Direktverbindungen (inkl. Offenburg -&gt; Greifswald)</p>
<p>Bei den teuren Strecken (über 100 Euro) und der kurzen Gotha -&gt; Eisenach Verbindung ändert sich nichts. Dazwischen sinken die Preise aber auffällig.</p>
<p>Schauen wir uns mal die Super-Spar-Preise an, auch hier wieder die 2. Klasse (die 1. Klasse verhält sich ähnlich).</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-12-700x572.png" alt=""></p>
<p><strong>Abbildung 19:</strong> 2. Klasse, Super-Spar-Preis, Direktverbindungen (inkl. Offenburg -&gt; Greifswald)</p>
<p>Der Preis sinkt in den hohen Preis-Regionen stärker, je länger das Abfahrtsdatum in der Zukunft liegt. Die teuren Tickets schwanken außerdem auffällig, während es im Niedrig-Preis-Segment kaum noch Preisschwankungen gibt.</p>
<p>Schauen wir uns das ganze noch mal für alle Preis-Kategorien einer Verbindung an, hier Köln -&gt; Dresden:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-58-700x445.png" alt=""></p>
<p><strong>Abbildung 20:</strong> Preise für die Verbindung Köln -&gt; Dresden (nur Direkt)</p>
<p>Wenig überraschend kann man feststellen: Die Kurven der 1. und 2.. Klasse verlaufen ziemlich synchron. Sinkt der Preis in der 1. Klasse, macht es die 2. Klasse ihm gleich. Außerdem erscheinen die Schwankungen zyklisch. Zum Vergleich die Preise für die berüchtigte Verbindung Berlin -&gt; Hannover:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-59-700x441.png" alt=""></p>
<p><strong>Abbildung 21:</strong> Preise für die Verbindung Berlin -&gt; Hannover (nur Direkt)</p>
<p>Ich will die Preise noch etwas genauer untersuchen. Die folgende Abbildung zeigt die Preise der 1. Klasse für die Verbindung Berlin -&gt; Stuttgart. Da jeder Punkt für eine Verbindung bzw. einen Preis steht, lässt sich nun ganz deutlich ein Zusammenhang erkennen. Bzw. nicht.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-62-700x443.png" alt=""></p>
<p><strong>Abbildung 22:</strong> 1. Klasse Preise für die Verbindung Berlin -&gt; Stuttgart (nur Direkt)</p>
<p>Der Flex-Preis folgt einem Schema. Der Grundpreis liegt bei <strong>227,80 Euro</strong>. Am Freitag steigt dieser stark an, am Samstag sinkt er sehr stark und am Sonntag ist er wieder etwas höher als der Grundpreis, aber nicht so hoch wie am Freitag.</p>
<p>Und der <strong>Super-Spar-Preis</strong>? Tja nun. Hier scheint es kein Konzept zu geben. Es scheint, als würde der Preis zufällig bestimmt werden. Auf einer anderen Strecke sieht es bei weitem nicht ganz so chaotisch aus, aber trotzdem noch nicht nachvollziehbar:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-64-700x446.png" alt=""></p>
<p><strong>Abbildung 23:</strong> 1. Klasse Preise für die Verbindung Ingolstadt -&gt; Nürnberg (nur Direkt)</p>
<p>Beim <strong>Flex-Preis</strong> ist fast es egal, wie früh du buchst, es gibt aber durchaus Unterschiede, nämlich am Wochenende. Ansonsten ist das Spar-Potential bei teureren Tickets tendentiell höher. Beim <strong>Super-Spar-Preis</strong> ist es eigentlich auch nicht wichtig, möglichst früh zu buchen. Auch hier kann man kurz vor Reiseantritt noch günstige Preise finden. Es gibt mitunter sehr starke Preisschwankungen, die in höheren Preisregionen größer sind.</p>
<h3 id="gibt-es-eine-nachfrage-steuerung">Gibt es eine Nachfrage-Steuerung?</h3>
<p>Das wirft die Frage auf, inwieweit versucht wird, die Nachfrage zu steuern. Klar ist nun, dass der Flex-Preis an Wochenenden stark schwankt. Untertags macht eine Schwankung auch gar keinen Sinn, da es keine Zugbindung gibt. Hier ist der Super-Spar-Preis besser geeignet. Und tatsächlich schwankt dieser auch, bedingt durch die Tagszeit (dazu unten mehr).</p>
<p>Allerdings steigt die erwartete Auslastung der Züge auch, je näher das Reisedatum liegt. Dazu ein Überblick für die erwartete Auslastung aller Verbindungen (Abbildung 35a berücksichtigt auch Daten aus den vergangenen Abfragen, x-Achse auf 90 Tage gestreckt, um den Vergleich mit Abbildung 22 und 23 zu erleichtern).</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-70-700x444.png" alt=""></p>
<p><strong>Abbildung 35a:</strong> Erwartete Auslastung für alle Verbindungen, 1. und 2. Klasse (alle Stichproben, 2019 und 2020)</p>
<p>Bis zu einem Monat vor Fahrtbeginn wird vom System in der Regel keine Auslastungs-Information gemeldet. Die Auslastung in der 1. Klasse ist geringfügig kleiner. In der 2. Klasse scheint es noch viele Buchungen einen Tag vor Fahrtantritt zu geben - am Reisetag selber ist die erwartete Auslastung überraschenderweise geringer. Klar wird aber, dass die Auslastung steigt, je weniger das Reisedatum in der Zukunft liegt.</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-72-700x442.png" alt=""></p>
<p><strong>Abbildung 35b:</strong> Erwartete Auslastung Berlin -&gt; Stuttgart, 1. und 2. Klasse</p>
<p>Bei der Betrachtung der einzelnen Verbindung <strong>Berlin -&gt; Stuttgart</strong> ist dieser Trend vielleicht nicht ganz so deutlich, aber er existiert, vor allem in der 2. Klasse. Ein Zusammenhang zur Abbildung 22 lässt sich aber kaum erkennen. Zugegeben: Der <strong>Flex-Preis</strong> ist in der fernen Zukunft an zwei Punkten günstiger. Nur beim Super-Spar-Preis ist keine klare Reaktion auf die erwartete steigende Nachfrage erkennbar.</p>
<p>Um hier eine wirklich zuverlässige Aussage treffen zu können, müsste man eine konkrete Verbindungen im zeitlichen Verlauf betrachten. So lässt sich nur die Mutmaßung anstellen, dass die Nachfragesteuerung kaum dynamisch auf die erwartete Auslastung reagiert, sondern vielmehr die typischen Reisezeiten berücksichtigt (Freitag / Sonntag). Aber gut, das Ziel war nicht, die Berechnung des Ticket-Preises zu analysieren, sondern seine Komplexität darzustellen.</p>
<h3 id="der-preis-des-umsteigens">Der Preis des Umsteigens</h3>
<p>Umsteigen ist unbequem und man will es gerne vermeiden. Der Wunsch, sprich die Nachfrage, nach einer Verbindung mit mehreren Umstiegen dürfte also recht gering sein. Im Preis schlägt sich das allerdings kaum wieder. Es gibt durchaus Verbindungen mit mehreren Umstiegen, die teurer sind als die Direktverbindung.</p>
<p>Hier als Beispiel die jeweils günstigsten Flex-Preise der 1. Klasse:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-20-700x228.png" alt=""></p>
<p><strong>Abbildung 24:</strong> 1. Klasse, günstigster Flex-Preis</p>
<p>Die Strecken <strong>Berlin -&gt; Stuttgart</strong> und <strong>München -&gt; Berlin</strong> haben also Schnäppchenpotential im Flex-Preis-Segment (wenn die unterschiedlichen Preise an einem Tag verfügbar sind). Nun ist es aber so, dass man mit dem Flexpreis <strong>nicht</strong> <strong>in der Zug-Kategorie</strong> <strong>aufsteigen</strong> darf (siehe oben). Wer also ein Ticket im IC bucht, darf nicht ICE fahren. Schauen wir uns doch mal die Verbindung Berlin -&gt; Stuttgart genauer an:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-24-700x440.png" alt=""></p>
<p><strong>Abbildung 25:</strong> 1. Klasse, Flex-Preis, Mindest-Flex-Preis x durchschnittliche Dauer und Umstiege, Berlin - Stuttgart</p>
<p>Du siehst, das untere Limit bei der ICE-Fahrt liegt bei etwas über <strong>200 Euro</strong>. Wenn du ein paar Euro auf der Verbindung sparen willst, musst du fast 3 Stunden mehr einplanen und z.B. IC fahren. Aber was mit der Verbindung mit <strong>vier Umstiegen</strong> (blauer Kreis)? Das Ticket kostet <strong>188 Euro</strong> und <strong>beinhaltet eine ICE-Strecke</strong>. Handelt es sich damit um ein vollwertiges ICE-Ticket und kann ich damit auch die direkte aber teurere Verbindung am gleichen Tag nutzen? Der Twitter-Support hat das mehr oder weniger bestätigt:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-25-700x397.png" alt=""></p>
<p><strong>Abbildung 26:</strong> Quelle: <a href="https://twitter.com/DB_Bahn/status/1303241966759665665">Twitter</a></p>
<p><em>Anmerkung: Die gestellte Frage lautete: &ldquo;Bei einem Flex-Preis-Ticket mit einem Umstieg (ICE zu IC) habe ich ja ein ICE-Ticket - für den ersten Teil der Strecke. Das Ticket ist dann nur für den 1. Teil gültig?&rdquo; Mein Verdacht ist allerdings, dass der Support nicht ganz verstanden hat, worauf ich hinaus wollte. Nachfragen lohnt sich also.</em></p>
<p>Wenn dem so ist, ergibt sich daraus ein wichtiges Kriterium bei der Preissuche: Wenn du ein günstiges Flex-Preis-Ticket zu einer &ldquo;verrückten&rdquo; Tageszeit findest, z.B. 0:12 Uhr in der Nacht, das nur eine ICE-Verbindung enthält, kannst du damit den ganzen Tag auf dieser Strecke reisen. Idealerweise auch auf einer Direktverbindung, nur mit dem ICE. In dem Fall ist erst Recht wichtig, Preise immer in einem <strong>großzügigen Zeitfenster</strong> zu vergleichen.</p>
<p>Noch mal zurück zur <strong>Abbildung 25</strong>. Die folgende <strong>Abbildung 27</strong> zeigt die Flex-Preise für die 2. Klasse:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-26-700x441.png" alt=""></p>
<p><strong>Abbildung 27:</strong> 1. Klasse, Flex-Preis, Mindest-Flex-Preis x durchschnittliche Dauer und Umstiege, Berlin - Stuttgart</p>
<p>Das Preisgefüge ändert sich nicht. Man kann also zumindest festhalten, dass die Dauer und die Anzahl der Umstiege zu den festen Faktoren der Preisbildung gehören.</p>
<p>Beim <strong>Super-Spar-Preis</strong> gibt es die <strong>feste Zugbindung</strong>. Hier macht es keinen Sinn, ein ggf. günstigeres Ticket mit vielen Umstiegen zu suchen und dann einfach die Direkt-Verbindung zu nutzen. Das dürfte sich auch bei der Preis-Gestaltung zeigen: Sind weniger bequeme Verbindungen mit mehreren Umstiegen teurer?</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-21-700x205.png" alt=""></p>
<p><strong>Abbildung 28:</strong> 1. Klasse, kleinster Super-Spar-Preis</p>
<p>Ja! Der günstigste Preis wird immer für die Direktverbindung aufgerufen. Kann man die Verbindungen mit mehreren Umstiegen also komplett ignorieren? Schwer zu sagen, denn hierbei handelt es sich um die aggregierte Darstellung. Wie sieht es in der Realität aus? Dazu gleich mehr. Zunächst noch mal der Vergleich mit der <strong>2. Klasse</strong>:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-28-700x229.png" alt=""></p>
<p><strong>Abbildung 29:</strong> 2. Klasse, kleinster Super-Spar-Preis</p>
<p>Was fällt auf? Die Verbindung <strong>Ingolstadt -&gt; Nürnberg</strong> mit einem Umstieg kostet 23,00 Euro, inklusive Sitzplatz also 27,00 Euro. Und ist etwas teurer als die Direktverbindung in der 1. Klasse für 26,40 Euro.</p>
<p>Eine <strong>weitere wichtige Erkenntnis</strong> lautet demnach: Beim Super-Spar-Preis lohnt sich der Vergleich mit der 1. Klasse.</p>
<h3 id="gibt-es-regelmäßigkeiten-bei-der-preisbildung">Gibt es Regelmäßigkeiten bei der Preisbildung?</h3>
<p>Noch mal zurück zum Median Flex-Preis für alle Verbindungen. Als Grundlage für die Berechnung eines <strong>Preises je Reise-Minute</strong> möchte ich einmal die angebene und damit ideale Reisedauer der ICE-Verbindungen ohne Umstiege verwenden, da diese im Datensatz direkt vorliegt. Außerdem kann vielleicht der <strong>Preis je Kilometer</strong> Aufschluss geben. Die folgende Abbildung zeigt die Verhältnisse der 2. zur 1. Klasse für die Flex-Preise aller Direkt-Verbindungen die mit dem ICE bedient werden:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-65-700x224.png" alt=""></p>
<p><strong>Abbildung 30:</strong> Flex-Preis für alle DirektVerbindungen, nur ICE</p>
<p>Der Faktor vom günstigsten zum teuersten Ticket ist in etwa gleich, nämlich knapp 10. Wenn man aber die Dauer als Indiz für die Entfernung nimmt, steigt der Preis nicht so stark an wie die Entfernung. Das zeigt sich in der Veränderung des Preis / Minute. Bei kurzen Strecken ist dieser höher als bei langen Strecken. Das bestätigt auch die Gegenüberstellung in einem Chart:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-67-700x562.png" alt=""></p>
<p><strong>Abbildung 31:</strong> Flex-Preis / Minute und Dauer aller Direkt-Verbindungen, nur ICE</p>
<p>Steigt der Preis also nicht proportional zur Länge der Verbindung, sprich Dauer? Die Werte für Preis / km können das leider nicht eindeutig bestätigen. Hier benötigen wir also mehr Daten.</p>
<p>Aber dafür lässt sich eine andere Feststellung relativ sicher belegen:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-69-700x228.png" alt=""></p>
<p><strong>Abbildung 32:</strong> Differenz 1. und 2. Klasse, Median Flex-Preis</p>
<p>Offensichtlich beträgt der <strong>Preis-Aufschlag für die 1. Klasse knapp 168%</strong> (bzw. der Nachlass zur 2. Klasse etwa 40%). Das ist jetzt keine bahnbrechende Erkenntnis, obgleich wir ja wissen, dass man die Preise der 1. und 2. Klasse nicht ohne weiteres vergleichen kann. Beim Super-Spar-Preis ist das übrigens nicht ganz so offensichtlich. Dieser schwankt aber auch zu stark, um hier eine zuverlässige Abschätzung zu geben.</p>
<h3 id="die-optimale-reisezeit">Die optimale Reisezeit</h3>
<p>Abschließend will ich die Granularität noch etwas erhöhen und mir die Preise über den Tag verteilt anschauen. Die nächste Abbildung zeigt den geringsten Super-Spar-Preise für beide Klassen je Verbindung, über den Tag verteilt:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-42-700x445.png" alt=""></p>
<p><strong>Abbildung 33</strong>: Median-Preis für Direktverbindungen (inkl. Offenburg -&gt; Greifswal) über den Tag verteilt</p>
<p>Die Super-Spar-Preise scheinen relativ stabil zu sein, der Flex-Preis schwankt etwas stärker. Zur Abendzeit werden die Preise aller Kategorien günstiger. Sicherlich ist es hilfreich, hier die Verbindungen im Detail zu untersuchen. Die folgende Abbildung zeigt die Preise der Verbindung München -&gt; Berlin:</p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-43-700x429.png" alt=""></p>
<p><strong>Abbildung 34:</strong> Median-Preise über die Tageszeit für die Verbindung München -&gt; Berlin</p>
<p>Ein Rückschluss auf die Nachfrage-Steuerung, die ich oben schon betrachtet habe, ist hier übrigens nur schwer möglich. Es handelt sich um die aggregierten Preise und Reisezeiten. Nur soviel: Zur Nachmittagszeit, also vermutlich der Haupt-Reisezeit, gibt es Preis-Spitzen beim Super-Spar-Preis. Der Flex-Preis ist relativ stabil.</p>
<h2 id="teil-5---eine-alternative-oberfläche">Teil 5 - Eine alternative Oberfläche</h2>
<p>Nun, da wir die spannenden Zahlenspiele und bunten Grafiken abgearbeitet haben, wollen wir uns eine mögliche Alternative anschauen. Ich habe mich oben schon recht intensiv mit den &ldquo;Preis-APIs&rdquo; der Deutschen Bahn beschäftigt. Diese habe ich nicht nur zur stumpfen Abfrage unzähliger Preise verwendet, sondern auch um eine alternative Ticket-Preis-Suche zu bauen: <a href="https://nickets.de/">nickets.de</a></p>
<p><img src="/2020/2020-09-09-das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/images/grafik-45-700x385.png" alt=""></p>
<p><strong>Abbildung 36:</strong> nickets - Visuelle Ticket-Preissuche</p>
<p>Die Bedienung sollte eigentlich relativ intutiv sein, das war ja das Ziel der ganzen Übung. Du gibst Start- und Zielbahnhof an, legst den Abfahrts-Zeitpunkt fest und lässt dir die entsprechenden Preise in einer Grafik anzeigen. Dort siehst du zu jeder Verbindung den Super-Spar-Preis sowie den Flex-Preis und die Anzahl der Umstiege. Fährst du mit dem Maus-Cursor über die Kreise, erhälst du zusätzliche Informationen zu dem jeweiligen Ticket. Mit Klick auf die kleinen Kreise kommst du zur Buchung auf der Seite der Deutschen Bahn.</p>
<p>Die Oberfläche befindet sich noch im Beta-Stadium, es kann also zu ungewohnten Verhalten kommen. Im Grunde sollten die Preise aber korrekt angezeigt werden und vor allem aktuell sein. Feedback und Wünsche sind natürlich sehr gerne gesehen.</p>
<h3 id="download-der-postman-collection">Download der Postman-Collection</h3>
<p><a href="https://www.nickyreinert.de/files/das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/Deutsche-Bahn-Tickets.postman_collection.json_.7z">Deutsche-Bahn-Tickets.postman_collection.json_</a><a href="https://www.nickyreinert.de/files/das-ticket-preis-system-der-deutschen-bahn-oder-wie-findest-du-den-optimalen-fahrschein-preis/Deutsche-Bahn-Tickets.postman_collection.json_.7z">Herunterladen</a></p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> analyse, deutsche-bahn, fahrscheine, mobilitaet, statistik, tickets</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      <category>projekte</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Das Ticket-Preis-System der Deutschen Bahn - oder: wie findest du den optimalen Fahrschein-Preis? - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>data_analysis_project</dc:type>
      
      
    </item><item>
      <title>Leitfaden für ein sicheres und schnelles WordPress-Setup</title>
      <link>https://nickyreinert.de/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/</link>
      <pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/</guid>
      <description>Das Thema Geschwindigkeit liegt bei uns allen ganz weit oben auf der Agenda. Oft allerdings nur passiv, wenn man ungeduldig auf der Tastatur trommelt und auf …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Ein umfassender Leitfaden mit zahlreichen Code-Snippets zur Optimierung einer WordPress-Installation in Bezug auf Geschwindigkeit und Sicherheit. Der Artikel behandelt Themen wie das Deaktivieren von Emojis und Gravatar, serverseitige Komprimierung, das Verschieben von Skripten, das Absichern der XML-RPC- und REST-APIs sowie das Aufräumen des HTML-Headers durch Änderungen in &#39;functions.php&#39;, &#39;.htaccess&#39; und &#39;wp-config.php&#39;.</p>
          
          
          <p><strong>Hauptthemen:</strong> WordPress, Performance-Optimierung, Web-Sicherheit, PHP, Server-Konfiguration, Frontend-Optimierung</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> advanced</p>
          
        </div>
        
        
        <p>Das Thema Geschwindigkeit liegt bei uns allen ganz weit oben auf der Agenda. Oft allerdings nur passiv, wenn man ungeduldig auf der Tastatur trommelt und auf das Laden einer Internetseite wartet. Aktiv fehlt oft der richtige Impuls. Was kann man noch tun, außer die Bilder kleinzuhalten, um WordPress zu beschleunigen?</p>
<p>Hier möchte ich dir ein paar einfache Tricks vorstellen, um die Geschwindigkeit deiner WordPress-Seite zu optimieren. Und da neben der Geschwindigkeit die Sicherheit ein weiteres beliebtes Thema ist, werde ich auch dazu ein paar kleine Kniffe mit großer Wirkung zeigen. Doch zunächst ein paar&hellip;</p>
<h2 id="grundsätze">Grundsätze</h2>
<p>Es gibt ein paar Prämissen, die du beim Thema <strong>Geschwindigkeit und Sicherheit</strong> berücksichtigen solltest:</p>
<ul>
<li><strong>Backups</strong> - Nuff said. Du wirst dein System niemals 100% absichern können. Umso wichtiger sind Backup.</li>
<li><strong>Plugin-Sparksamkeit</strong> - jedes zusätzliche Plugin ist nicht nur ein potentielles Sicherheitsrisiko, sondern lässt deine Seite auch unnötig anwachsen. Versuche so viele Funktionen wie möglich selber umzusetzen. Ein Child-Theme erlaubt dir in der <strong>functions.php</strong> nicht nur Anpassungen des Layouts sondern auch des Funktionsumfanges vorzunehmen.</li>
<li><strong>Updates</strong> - Halte WordPress, Plugins und Themes immer auf dem neuesten Stand. Verzichte möglichst auf Plugins und Themes, die lange nicht aktualisiert wurden.</li>
<li><strong>Page Builder</strong> - <a href="https://www.nickyreinert.de/wordpress-page-builder-pro-und-contra/">ich bin wahrlich kein Fan von Page-Buildern</a>, auch wenn es da draußen relativ performante Vertreter dieser Art gibt. Allerdings wohnt jedem Page-Builder in der Regel ein Problem inne: Sie kommen mit einer Menge von Funktionen, die du oft nicht benötigst, die aber trotzdem Ressourcen verbrauchen.</li>
</ul>
<p>Nun, da das geklärt ist und ich meinen Unmut über Page-Builder mal wieder unterbringen konnte: Was kannst du aktiv tun, um die <strong>Geschwindigkeit und Sicherheit</strong> zu optimieren? Im Folgenden werden wir Änderungen an drei Dateien vornehmen:</p>
<ul>
<li>functions.php (deines Child-Themes)</li>
<li>.htaccess-Datei</li>
<li>wp-config.php</li>
</ul>
<p>Du findest alle drei Dateien auf <a href="https://github.com/nickyreinert/wordPressSettings/tree/master">github.com</a>.</p>
<h2 id="warnung">Warnung</h2>
<p>Da es sich mitunter um sehr tiefe Eingriffe in die WordPress-Mechanik handelt, folgender wichtiger Hinweis:</p>
<p>Nehme die hier beschriebenen Änderungen niemals an einer Live-Installation vor; teste sie in einer geschützten Umgebung und übertrage sie dann sorgfältig und ggf. nacheinander in das Live-System!</p>
<p>Lege außerdem immer ein <strong>Backup</strong> von den Dateien an, die du im Laufe dieses Artikels ändern wirst.</p>
<p>Diese Anleitung ist ein <strong>Leitfaden</strong>, den du nicht ungelesen übernehmen solltest. Passe die Änderungen an die Anforderungen deines Projektes an. Klar soweit? Dann los:</p>
<h2 id="nutze-keine-standard-einstellungen">Nutze keine Standard-Einstellungen</h2>
<p>Eigentlich gehört diese Weisheit zu den Prämissen, ich will sie hier trotzem etwas ausführlicher erklären. Dieser Punkt gehört für mich zum Konzept &ldquo;<strong>Secruity through obscurity</strong>&rdquo;. Viele vermeintliche Angriffe auf deine Seite sind nur das Grundrauschen: Automatisierte Scripte, die zahlreiche Webseiten nach bekannten Sicherheitslücken abklopfen. Lass uns das &ldquo;<strong>passive Angriffe</strong>&rdquo; nennen. Du kannst das geduldig über dich ergehen lassen oder schon jetzt dafür sorgen, dass deine Seite gar nicht erst im Rampenlicht steht. Wenn bei den passiven Angriffen keine Lücken erkannt werden, zieht der Bot weiter und widmet sich <strong>schwächeren Seiten</strong>. Das Credo lautet &ldquo;Kosten-Nutzen-Analyse&rdquo;. Warum mit einem unbekannten Ziel beschäftigen, wenn da draußen genug unsichere WordPress-Installationen darauf warten, <em>gehackt</em> zu werden? Also:</p>
<ul>
<li>Nutze als <strong>Benutzername</strong> für den Administrator-Account nicht den Standardwert &ldquo;admin&rdquo;. Erzeuge einen neuen Admin-Nutzer (z.B. MyLittlePony) mit allen Admin-Rechten und entferne den originalen Admin-Nutzer</li>
<li>Nutze ein &ldquo;kryptisches&rdquo; <strong>Tabellen-Prefix</strong> (z.B. x02349d_), um das Auffinden der WordPress-Tabellen in der Datenbank zu erschweren. Bei Angriffen über <strong>SQL-Injection</strong> wird oft vom Standard-Prefix (wp_) ausgegangen.</li>
<li>Ach ja, und nein: Verschiebe nicht die <strong>wp-admin</strong>-URL - das erzeugt mehr Unruhe im System, als dass es nutzt. Hier reicht der zusätzliche Schutz mit <strong>HTTP Basic Auth</strong>.</li>
<li>Setze korrekte Dateirechte ein, um zu vermeiden, dass jemand deine PHP-Dateien ändern und Schadcode einfügen kann (das ist ein etwas größeres Thema auf Serverseite, <a href="https://binary-butterfly.de/artikel/dateirechte-wie-stelle-ich-das-bei-meinem-hoster-ein/">was hier ganz gut beschrieben ist</a>).</li>
<li>Kein Standard-Passwort. Ok. Muss ich das wirklich erwähnen? ;)</li>
</ul>
<h2 id="emoticons-und-emojis">Emoticons und Emojis</h2>
<p>Emojis sind zwar unstrittig ein fester Bestandteil der modernen Kommunikation, was nicht heißt, dass man sie überall nutzen muss. In WordPress gehören sie leider zum Standard, was die Ladezeit verringert. Um sich der kleinen Kecker zu entledigen, ist eine ganze Menge PHP-Code (<a href="https://kinsta.com/de/wissensdatenbank/deaktivierst-emojis-wordpress/">lose basierend auf diesem Beitrag</a>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">function disable_emojis() {
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">    remove_action( &#39;wp_head&#39;, &#39;print_emoji_detection_script&#39;, 7 );
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    remove_action( &#39;admin_print_scripts&#39;, &#39;print_emoji_detection_script&#39; );
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    remove_action( &#39;wp_print_styles&#39;, &#39;print_emoji_styles&#39; );
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    remove_action( &#39;admin_print_styles&#39;, &#39;print_emoji_styles&#39; );
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    remove_filter( &#39;the_content_feed&#39;, &#39;wp_staticize_emoji&#39; );
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    remove_filter( &#39;comment_text_rss&#39;, &#39;wp_staticize_emoji&#39; );
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    remove_filter( &#39;wp_mail&#39;, &#39;wp_staticize_emoji_for_email&#39; );
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    add_filter( &#39;tiny_mce_plugins&#39;, &#39;disable_emojis_tinymce&#39; );
</span></span><span class="line"><span class="ln">10</span><span class="cl">    add_filter( &#39;wp_resource_hints&#39;, &#39;disable_emojis_remove_dns_prefetch&#39;, 10, 2 );
</span></span><span class="line"><span class="ln">11</span><span class="cl">}
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">function disable_emojis_tinymce( $plugins ) {
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">    if ( is_array( $plugins ) ) {
</span></span><span class="line"><span class="ln">16</span><span class="cl">        
</span></span><span class="line"><span class="ln">17</span><span class="cl">        return array_diff( $plugins, array( &#39;wpemoji&#39; ) );
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">    } else {
</span></span><span class="line"><span class="ln">20</span><span class="cl">        
</span></span><span class="line"><span class="ln">21</span><span class="cl">        return array();
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    }
</span></span><span class="line"><span class="ln">24</span><span class="cl">}
</span></span><span class="line"><span class="ln">25</span><span class="cl"> 
</span></span><span class="line"><span class="ln">26</span><span class="cl">function disable_emojis_remove_dns_prefetch( $urls, $relation_type ) {
</span></span><span class="line"><span class="ln">27</span><span class="cl">    if ( &#39;dns-prefetch&#39; == $relation_type ) {
</span></span><span class="line"><span class="ln">28</span><span class="cl">    
</span></span><span class="line"><span class="ln">29</span><span class="cl">        /** This filter is documented in wp-includes/formatting.php */
</span></span><span class="line"><span class="ln">30</span><span class="cl">        $emoji_svg_url = apply_filters( &#39;emoji_svg_url&#39;, &#39;https://s.w.org/images/core/emoji/2/svg/&#39; );
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl">        $urls = array_diff( $urls, array( $emoji_svg_url ) );
</span></span><span class="line"><span class="ln">33</span><span class="cl">    }
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">    return $urls;
</span></span><span class="line"><span class="ln">36</span><span class="cl">}    
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">function disable_emojicons_tinymce( $plugins ) {
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl">    if ( is_array( $plugins ) ) {
</span></span><span class="line"><span class="ln">41</span><span class="cl">    
</span></span><span class="line"><span class="ln">42</span><span class="cl">        return array_diff( $plugins, array( &#39;wpemoji&#39; ) );
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl">    } else {
</span></span><span class="line"><span class="ln">45</span><span class="cl">
</span></span><span class="line"><span class="ln">46</span><span class="cl">      return array();
</span></span><span class="line"><span class="ln">47</span><span class="cl">
</span></span><span class="line"><span class="ln">48</span><span class="cl">    }
</span></span><span class="line"><span class="ln">49</span><span class="cl">}
</span></span><span class="line"><span class="ln">50</span><span class="cl">
</span></span><span class="line"><span class="ln">51</span><span class="cl">function disable_wp_emojicons() {
</span></span><span class="line"><span class="ln">52</span><span class="cl">
</span></span><span class="line"><span class="ln">53</span><span class="cl">    remove_action( &#39;admin_print_styles&#39;, &#39;print_emoji_styles&#39; );
</span></span><span class="line"><span class="ln">54</span><span class="cl">    remove_action( &#39;wp_head&#39;, &#39;print_emoji_detection_script&#39;, 7 );
</span></span><span class="line"><span class="ln">55</span><span class="cl">    remove_action( &#39;admin_print_scripts&#39;, &#39;print_emoji_detection_script&#39; );
</span></span><span class="line"><span class="ln">56</span><span class="cl">    remove_action( &#39;wp_print_styles&#39;, &#39;print_emoji_styles&#39; );
</span></span><span class="line"><span class="ln">57</span><span class="cl">    remove_filter( &#39;wp_mail&#39;, &#39;wp_staticize_emoji_for_email&#39; );
</span></span><span class="line"><span class="ln">58</span><span class="cl">    remove_filter( &#39;the_content_feed&#39;, &#39;wp_staticize_emoji&#39; );
</span></span><span class="line"><span class="ln">59</span><span class="cl">    remove_filter( &#39;comment_text_rss&#39;, &#39;wp_staticize_emoji&#39; );
</span></span></code></pre></div><p>Hier passiert eine ganze Menge, weil die Emojis relativ breit implementiert wurden. Die einfachste Erklärung ist: Wir entfernen alle möglichen Verweise auf Emojis. Du musst die Trigger allerdings noch aktivieren indem du sie folgendermaßen aufrufst:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">add_filter( &#39;tiny_mce_plugins&#39;, &#39;disable_emojicons_tinymce&#39;);}
</span></span><span class="line"><span class="ln">2</span><span class="cl">add_action( &#39;init&#39;, &#39;disable_emojis&#39; );
</span></span><span class="line"><span class="ln">3</span><span class="cl">add_filter( &#39;emoji_svg_url&#39;, &#39;__return_false&#39; );
</span></span><span class="line"><span class="ln">4</span><span class="cl">add_action( &#39;init&#39;, &#39;disable_wp_emojicons&#39; );
</span></span></code></pre></div><h2 id="gravatar-deaktivieren">Gravatar deaktivieren</h2>
<p>Du kannnst die Nutzung der Gravatare auch in den Einstellungen deaktivieren. Ich bevorzuge aber die Variante in der functions.php, da man sich so ein kleines Boilerplate erstellen kann. So deaktivierst du die Gravatar-Funktion:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">add_filter( &#39;option_show_avatars&#39;, &#39;__return_false&#39; );
</span></span></code></pre></div><p>Wie du siehst, spart uns das mindestens zwei Anfragen und ein paar Millisekunden ein:</p>
<p><img src="/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/images/grafik-700x57.png" alt=""></p>
<h2 id="gzip-und-deflate">GZIP und Deflate</h2>
<p>Sehr naheliegend ist natürlich die Komprimierung von Dateien. Du nimmst diese Änderung in der .htaccess-Datei vor:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&lt;IfModule mod_deflate.c&gt;
</span></span><span class="line"><span class="ln">2</span><span class="cl">    &lt;FilesMatch &#34;.*\.(html|php|css|js|xml)$&#34;&gt;
</span></span><span class="line"><span class="ln">3</span><span class="cl">        SetOutputFilter DEFLATE
</span></span><span class="line"><span class="ln">4</span><span class="cl">    &lt;/FilesMatch&gt;
</span></span><span class="line"><span class="ln">5</span><span class="cl">    AddOutputFilterByType DEFLATE application/rss+xml
</span></span><span class="line"><span class="ln">6</span><span class="cl">    AddOutputFilterByType DEFLATE application/xml application/xhtml+xml
</span></span><span class="line"><span class="ln">7</span><span class="cl">    AddOutputFilterByType DEFLATE application/javascript application/x-javascript
</span></span><span class="line"><span class="ln">8</span><span class="cl">&lt;/IfModule&gt;
</span></span></code></pre></div><p>Achtung: Du solltest deine Seite genau beobachten. Die Aktivierung von GZIP führt bei sehr kleinen Dateien nicht zu einem Größenvorteil, kann sich aber negativ auf die Antwortzeit des Servers auswirken, da die kleinen Dateien ja trotzdem einmal &ldquo;angefasst&rdquo; werden.</p>
<h2 id="cron-job-deaktivieren">Cron-Job deaktivieren</h2>
<p>Bei jedem Aufruf der Seite wird ein internes Cron-Job-Script ausgeführt. Das ist vor allem für das Suchen nach Updates wichtig. Wenn dein Hoster Cron-Jobs anbietet, ist das natürlich unnötig und verlangsamt jeden Aufruf deiner Seite. Du kannst die Cron-Job-Aufrufe in der wp-config.php folgendermaßen deaktivieren:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">define(&#39;DISABLE_WP_CRON&#39;, true);
</span></span></code></pre></div><p>Danach musst diese Anfrage aber trotzdem irgendwie ausführen. Das machst du im Backend deines Hosters, bei <strong>all-inkl z</strong>.B. im KAS unter Tools:</p>
<p><img src="/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/images/grafik-700x125.png" alt=""></p>
<p>Als Intervall genügt hier eigentlich stündlich.</p>
<h2 id="scripte-im-footer-laden">Scripte im Footer laden</h2>
<p>In der Regel müssen JavaScript-Dateien nicht sofort zur Verfügung stehen, da sie z.B: Benutzerinteraktion ermöglichen bzw. darauf reagieren. Trotzdem können Sie den Aufbau der Seite verzögern, wenn sie ganz am Anfang oder in der Mitte eingebunden werden.</p>
<p>Aus dem Grund sollte man die Scripte ganz am Ende einer Seite auflisten, die nicht für den Seitenaufbau direkt benötigt werden. Die grobe Methode funktioniert folgendermaßen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">add_action(&#39;after_setup_theme&#39;, &#39;footer_enqueue_scripts&#39;);
</span></span><span class="line"><span class="ln">2</span><span class="cl">function footer_enqueue_scripts() {
</span></span><span class="line"><span class="ln">3</span><span class="cl">    remove_action(&#39;wp_head&#39;, &#39;wp_print_scripts&#39;);
</span></span><span class="line"><span class="ln">4</span><span class="cl">    remove_action(&#39;wp_head&#39;, &#39;wp_print_head_scripts&#39;, 9);
</span></span><span class="line"><span class="ln">5</span><span class="cl">    remove_action(&#39;wp_head&#39;, &#39;wp_enqueue_scripts&#39;, 1);
</span></span><span class="line"><span class="ln">6</span><span class="cl">    add_action(&#39;wp_footer&#39;, &#39;wp_print_scripts&#39;, 5);
</span></span><span class="line"><span class="ln">7</span><span class="cl">    add_action(&#39;wp_footer&#39;, &#39;wp_print_head_scripts&#39;, 5);
</span></span><span class="line"><span class="ln">8</span><span class="cl">    add_action(&#39;wp_footer&#39;, &#39;wp_enqueue_scripts&#39;, 5);
</span></span><span class="line"><span class="ln">9</span><span class="cl">}
</span></span></code></pre></div><p>Nachdem du diese Zeilen übernommen hast, solltest du deine Seite einmal z.B. im Inkognito-Modus, ohne Cache, neu laden. Flackert die Seite in der ersten Millisekunden auffällig, also wird für einen kurzen Augenblick der fast roh anmutende Inhalt der Seite und dann das Layout angezeigt, kommentiere in der Callback-Funktion die beiden Zeilen aus, die <strong>wp_enqueue_scripts</strong> in den Footer verlagern.</p>
<h2 id="javascript-ausführung-verzögern">JavaScript Ausführung verzögern</h2>
<p>Die etwas elegantere Methoden nennen sich &ldquo;<strong>defer</strong>&rdquo; und &ldquo;<strong>async</strong>&rdquo;. Mit defer teilst du dem Browser mit, dass die JavaScript-Datien im Hintergrund geladen und erst ausgeführt werden, wenn die eigentlichen Inhalte fertig sind.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">add_filter</span><span class="p">(</span> <span class="s1">&#39;script_loader_tag&#39;</span><span class="p">,</span> <span class="s1">&#39;defer_parsing_of_js&#39;</span><span class="p">,</span> <span class="mi">10</span> <span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">function</span> <span class="n">defer_parsing_of_js</span><span class="p">(</span> <span class="o">$</span><span class="n">url</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">is_user_logged_in</span><span class="p">()</span> <span class="p">)</span> <span class="k">return</span> <span class="o">$</span><span class="n">url</span><span class="p">;</span> <span class="o">//</span><span class="n">don</span><span class="s1">&#39;t break WP Admin</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">strpos</span><span class="p">(</span> <span class="o">$</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;.js&#39;</span> <span class="p">)</span> <span class="o">===</span> <span class="n">FALSE</span><span class="p">)</span> <span class="k">return</span> <span class="o">$</span><span class="n">url</span><span class="p">;</span> <span class="o">//</span> <span class="n">only</span> <span class="n">process</span> <span class="n">JavaScript</span> <span class="n">files</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="n">strpos</span><span class="p">(</span> <span class="o">$</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;jquery.js&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="o">$</span><span class="n">url</span><span class="p">;</span>  <span class="o">//</span> <span class="n">skip</span> <span class="n">JQuery</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    
</span></span><span class="line"><span class="ln">10</span><span class="cl">    <span class="k">return</span> <span class="n">str_replace</span><span class="p">(</span> <span class="s1">&#39; src&#39;</span><span class="p">,</span> <span class="s1">&#39; defer src&#39;</span><span class="p">,</span> <span class="o">$</span><span class="n">url</span> <span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Der defer-Flag macht nur bei Scripten Sinn, die mit <strong>src</strong> eingebunden werden. Inline-Scripte werden immer sofort gelesen und geparsed. Daneben gibt es noch async. Mit async wird die Datei ebenfalls parallel geladen und sofort ausgeführt, wenn die Datei vollständig ist. Das macht vor allem bei Tracking-Scripten Sinn, die keinen Bezug zum inhaltlichen Aufbau haben.</p>
<h2 id="versionsinfos-entfernen">Versionsinfos entfernen</h2>
<p>Style- und Script-Dateien werden oft mit einem Anhang übermittelt, z.B. <strong>style.css?ver=123</strong>. Das macht Sinn um Änderungen nachzuverfolgen, hat aber auch einen entscheidenen Nachteil: Damit werden Cache-Mechanismen umgangen, weil der Cache denkt, es handelt sich um eine dynamische Ressource. Aus dem Grund solltest du die Versions-Infos komplett deaktivieren. Achte beim Arbeiten an der Webseite einfach daran, sämtliche Caches zu deaktivieren.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">add_filter</span><span class="p">(</span> <span class="s1">&#39;script_loader_src&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_version_parameter&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="n">add_filter</span><span class="p">(</span> <span class="s1">&#39;style_loader_src&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_version_parameter&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span> <span class="p">);</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="n">function</span> <span class="n">remove_version_parameter</span><span class="p">(</span><span class="o">$</span><span class="n">src</span><span class="p">){</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="o">//</span> <span class="n">Check</span> <span class="k">if</span> <span class="n">version</span> <span class="n">parameter</span> <span class="n">exist</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="o">$</span><span class="n">parts</span> <span class="o">=</span> <span class="n">explode</span><span class="p">(</span> <span class="s1">&#39;?ver&#39;</span><span class="p">,</span> <span class="o">$</span><span class="n">src</span> <span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="o">//</span> <span class="k">return</span> <span class="n">without</span> <span class="n">version</span> <span class="n">parameter</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">return</span> <span class="o">$</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">    
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="google-fonts-deaktivieren">Google Fonts deaktivieren</h2>
<p>Die Einbindung der Fonts über Google ist bequem, birgt neben dem Performance-Nachteil aber unter Umständen auch ein Datenschutz problem. (Grundsätzlich solltest du versuchen, alle Ressourcen von deinem Server zu laden und auch auf CDN zu verzichten - <a href="https://binary-butterfly.de/artikel/warum-dir-ein-cdn-vermutlich-keinen-geschwindigkeitsvorteil-bringen-wird/">das bringt selten einen Vorteil</a>.)</p>
<p>Leider ist das Entfernen nicht ohne weiteres möglich. Du musst erst herausfinden, unter welchem Handler das Theme die Google Fonts einbindet (Eine Liste bekannter Themes und der verwendeten Font-Handler findest du hier.) Dazu durchsuchst du die functions.php nach z.B. Google. Für das Theme Rowling sieht das dann folgendermaßen aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">wp_register_style( &#39;rowling_google_fonts&#39;, &#39;//fonts.googleapis.com/css?family=Lato:400,700,900,400italic,700italic|Merriweather:700,900,400italic&#39; );
</span></span></code></pre></div><p>Der Handler lautet also &ldquo;<strong>rowling_google_fonts</strong>&rdquo;. Auf gehts:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">add_action( &#39;wp_print_styles&#39;, &#39;dequeue_google_fonts_style&#39; );
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">function dequeue_google_fonts_style() {
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">      wp_dequeue_style( &#39;rowling_style&#39; );
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl">}
</span></span></code></pre></div><p>Achte darauf, dass jetzt natürlich die Fallback-Schriftart aus dem CSS verwendet wird.</p>
<h2 id="die-beitrags-historie-verschlanken">Die Beitrags-Historie verschlanken</h2>
<p>Seit einiger Zeit gibt es in WordPress das ansich ganz nützliche Feature der Revisionen: Bei jeder Änderung und jeder Speicherung legt WordPress in der Datenbank eine Kopie der vorherigen Version des Beitrages an. Das ist praktisch. Aber auch grenzenlos.<br>
Zunächst solltest du die Anzahl der Revisionen pro Beitrag eingrenzen. Dazu setzt du in der wp-config.php folgenden Parameter:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">define(&#39;WP_POST_REVISIONS&#39;, 5);
</span></span></code></pre></div><p>Die Fünf beschreibt die Anzahl der erlaubten Revisionen. Du kannst die Zahl natürlich beliebig anpassen. Damit ist es aber noch nicht getan, du solltest die alten Revisionen natürlich noch aufräumen. Dazu kannst du dir das Plugin <a href="https://de.wordpress.org/plugins/wp-sweep/">WP Sweep installieren</a>. Du kannst nun ganz bequem alle Revisionen löschen:</p>
<p><img src="/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/images/grafik-2-700x102.png" alt=""></p>
<p>Alle Revisionen mit WP Sweep löschen</p>
<h2 id="oembeds-deaktivieren">oEmbeds deaktivieren</h2>
<p>Hierbei handelt es sich um ein Feature, das WordPress seit Version 4.4 mitbringt, die sogenannten Embeds. Dir ist es vielleicht schon mal aufgefallen: Beim Einfügen von URL in den Beitrag, wird nicht die URL angezeigt, sondern eine Art Snippet mit zusätzlichne Informationen und sogar einer Vorschau. Das sieht schick aus, braucht aber vielleicht nicht jeder. Wenn du Embed also nicht benötigst, erspart dir das wieder ein paar Zeilen im HTML-Header und sogar eine zusätzliche JavaScript-Bibliothek:</p>
<p><img src="/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/images/grafik-4-700x52.png" alt=""></p>
<p>Die Embed-Bibliothek von WordPress</p>
<p>Füge dazu folgendes in die <strong>functions.php</strong> ein (<a href="https://kinsta.com/de/wissensdatenbank/deaktivierst-embeds-wordpress/#disable-embeds-code">Quelle</a>):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">add_action( &#39;init&#39;, &#39;disable_embeds_code_init&#39;, 9999 );
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">function disable_embeds_code_init() {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    remove_action( &#39;rest_api_init&#39;, &#39;wp_oembed_register_route&#39; );
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    add_filter( &#39;embed_oembed_discover&#39;, &#39;__return_false&#39; );
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    remove_filter( &#39;oembed_dataparse&#39;, &#39;wp_filter_oembed_result&#39;, 10 );
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    remove_action( &#39;wp_head&#39;, &#39;wp_oembed_add_discovery_links&#39; );
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    remove_action( &#39;wp_head&#39;, &#39;wp_oembed_add_host_js&#39; );
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    add_filter( &#39;tiny_mce_plugins&#39;, &#39;disable_embeds_tiny_mce_plugin&#39; );
</span></span><span class="line"><span class="ln">10</span><span class="cl">    add_filter( &#39;rewrite_rules_array&#39;, &#39;disable_embeds_rewrites&#39; );
</span></span><span class="line"><span class="ln">11</span><span class="cl">    remove_filter( &#39;pre_oembed_result&#39;, &#39;wp_filter_pre_oembed_result&#39;, 10 );
</span></span><span class="line"><span class="ln">12</span><span class="cl">}
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">function disable_embeds_tiny_mce_plugin($plugins) {
</span></span><span class="line"><span class="ln">15</span><span class="cl">    return array_diff($plugins, array(&#39;wpembed&#39;));
</span></span><span class="line"><span class="ln">16</span><span class="cl">}
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">function disable_embeds_rewrites($rules) {
</span></span><span class="line"><span class="ln">19</span><span class="cl">    foreach($rules as $rule =&gt; $rewrite) {
</span></span><span class="line"><span class="ln">20</span><span class="cl">        if(false !== strpos($rewrite, &#39;embed=true&#39;)) {
</span></span><span class="line"><span class="ln">21</span><span class="cl">            unset($rules[$rule]);
</span></span><span class="line"><span class="ln">22</span><span class="cl">        }
</span></span><span class="line"><span class="ln">23</span><span class="cl">    }
</span></span><span class="line"><span class="ln">24</span><span class="cl">    return $rules;
</span></span><span class="line"><span class="ln">25</span><span class="cl">}
</span></span></code></pre></div><h2 id="den-header-aufräumen">Den Header aufräumen</h2>
<p>Kommen wir zu ein paar Maßnahmen, die das HTML ein wenig verschlanken, aber aus Performance-Sicht nur Peanuts sind: Wir räumen den Header-Bereich auf. Diese Maßnahmen sind nicht wirklich notwendig, außer du willst es wirklich auf die Spitze treiben.</p>
<p>Los geht es mit dem Manifest für den <strong>Windows Live Writer</strong>, einer App um Blog-Beiträge zu schreiben (was mit deaktivierter XML-RPC, siehe unten, sowieso nicht mehr möglich ist):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&lt;link rel=&#34;wlwmanifest&#34; type=&#34;application/wlwmanifest+xml&#34; href=&#34;https://example.com/wp-includes/wlwmanifest.xml&#34;&gt;
</span></span></code></pre></div><p>Und so deaktivierst du den Spaß:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">remove_action( &#39;wp_head&#39;, &#39;wlwmanifest_link&#39;);
</span></span></code></pre></div><p>Weiter geht es mit dem Verweis zum <strong>Shortlink</strong> des jeweiligen Beitrages. Shortlinks sind praktisch, um mit kurzem URL auf Inhalte deiner Webseite zu verweisen. Anstatt dem langen Permalink <a href="https://www.example.com/das-ist-mein-allererster-beitrag-hier-und-ich-liebe-es">www.example.com/das-ist-mein-allererster-beitrag-hier-und-ich-liebe-es</a> nutzt du z.B. einfach <strong><a href="https://www.example.com/?p=1">www.example.com/?p=1</a></strong>. Wenn du das nicht brauchst, entferne den Shortlink-Verweis aus dem HTML-Header und dem HTTP-Antwort-Header:</p>
<p><img src="/2020/2020-07-01-leitfaden-fur-ein-sicheres-und-schnelles-wordpress-setup/images/grafik-3-700x336.png" alt=""></p>
<p>Der Shortlink-Verweis im HTTP-Header</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">remove_action( &#39;wp_head&#39;, &#39;wp_shortlink_wp_head&#39;);
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">add_filter(&#39;after_setup_theme&#39;, &#39;remove_shortlink_from_http_header&#39;);
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">function remove_shortlink_from_http_header() {
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl">    remove_action( &#39;template_redirect&#39;, &#39;wp_shortlink_header&#39;, 11);
</span></span><span class="line"><span class="ln">8</span><span class="cl">
</span></span><span class="line"><span class="ln">9</span><span class="cl">}
</span></span></code></pre></div><p>Im Header findest Verweise auf den vorherigen, den nächsten Beitrag oder die Startseite. Diese Funktionalität sollte theoretisch durch dein Template abgedeckt sein. Diese Verweise entfernst du folgendermaßen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">remove_action(&#39;wp_head&#39;, &#39;start_post_rel_link&#39;);
</span></span><span class="line"><span class="ln">2</span><span class="cl">remove_action(&#39;wp_head&#39;, &#39;index_rel_link&#39;);
</span></span><span class="line"><span class="ln">3</span><span class="cl">remove_action(&#39;wp_head&#39;, &#39;adjacent_posts_rel_link&#39;);
</span></span></code></pre></div><p>Zu guter Letzt die Versions-Information. Das Verbergen der WordPress-Version kann auch als Sicherheitsfeature verstanden werden (<strong>Security through obscurity</strong>, Sicherheit durch Unklarheit, siehe oben). Wenn der potentielle Angreifer nicht weiß, welche Version du verwendest, erschwerst du ihm zumindest das Identifizieren potentieller Sicherheitslücken. In der Realtität wird das nur die Bots aufhalten, die dein System automatisiert scannen. Bei einem aktiven Angriff ist das ziemlich sicher nutzlos. Nutze dazu folgende Zeile in der functions.php:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">remove_action(&#39;wp_head&#39;, &#39;wp_generator&#39;);
</span></span></code></pre></div><h2 id="cache-plugin">Cache-Plugin</h2>
<p>Wenn du immer noch nicht zufrieden bist, kannst du auch auf ein Cache-Plugin zurück greifen. Das sorgt dafür, dass die Seiten nicht bei jedem Aufruf komplett neu über PHP erstellt, sondern statische Inhalte ausgeliefert werden. Das bringt noch mal einen enormen Geschwindigkeitsgewinn.</p>
<h2 id="die-xml-rpc-schnittstelle-deaktivieren">Die XML-RPC-Schnittstelle deaktivieren</h2>
<p>XML-RPC steht für Extensible Markup Language Remote Procedure Call. Klingt kompliziert, ist es auch. Dabei handelt es sich um eine Schnittstelle. mit der du, ganz einfach gesagt, WordPress steuern kannst, ohne auf das Backend zuzugreifen (<a href="https://www.kuketz-blog.de/wordpress-angriffe-auf-die-xmlrpc-schnittstelle-xmlrpc-php-unterbinden/">mehr Hintergründe dazu hier</a>). Wenn du diese Schnittstelle deaktivierst, verlierst du also Funktionalität, wie z.B. <strong>Pingbacks</strong> oder das <strong>Verwalten von WordPress mit einer externen App</strong>. Auch Jetpack greift auf die XML-RPC zu! Du gewinnst aber auch etwas an Sicherheit dazu. Entscheide selber.</p>
<p>In den aktuellen Apache-Versionen (ab 2.4) sperrst du den Zugriff auf xmlrpc.php in der .htaccess-Datei folgendermaßen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">&lt;FilesMatch &#34;(^\.|wp-config\.php|xmlrpc\.php|(?&lt;!robots)\.txt|(liesmich|readme)\.*)&#34;&gt;
</span></span><span class="line"><span class="ln">2</span><span class="cl">   Require all denied
</span></span><span class="line"><span class="ln">3</span><span class="cl">&lt;/FilesMatch&gt;
</span></span></code></pre></div><p>Eigentlich sollte das schon genügen. Willst du auf Nummer sicher gehen, kannst du durchaus mehrt tun. Der weniger disruptive Weg wäre, <a href="https://developer.wordpress.org/reference/hooks/xmlrpc_enabled/">alle</a> <a href="https://developer.wordpress.org/reference/hooks/xmlrpc_enabled/"></a><a href="https://developer.wordpress.org/reference/hooks/xmlrpc_enabled/">Methoden zu deaktivieren, die eine Authentifizierung erfordern</a>. Das funktioniert folgendermaßen (in der functions.php deines Child-Themes):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl"># XML RPC deaktivieren
</span></span><span class="line"><span class="ln">2</span><span class="cl">add_filter( &#39;xmlrpc_enabled&#39;, &#39;__return_false&#39; );
</span></span><span class="line"><span class="ln">3</span><span class="cl"># XML RPC Verweis aus Header entfernen
</span></span><span class="line"><span class="ln">4</span><span class="cl">remove_action(&#39;wp_head&#39;, &#39;rsd_link&#39;);
</span></span></code></pre></div><p>Allerdings ist das ganze Sub-System weiterhin aktiv. <a href="https://www.scottbrownconsulting.com/2020/03/two-ways-to-fully-disable-wordpress-xml-rpc/">Willst du das also komplett deaktivieren</a>, füge der functions.php folgendes hinzu:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">// disable xmlrpc
</span></span><span class="line"><span class="ln">2</span><span class="cl">function remove_xmlrpc_methods( $methods ) {
</span></span><span class="line"><span class="ln">3</span><span class="cl">  return array();
</span></span><span class="line"><span class="ln">4</span><span class="cl">}
</span></span><span class="line"><span class="ln">5</span><span class="cl">add_filter( &#39;xmlrpc_methods&#39;, &#39;remove_xmlrpc_methods&#39; );
</span></span></code></pre></div><p>Aber wie gesagt, das sind zusätzliche Maßnahmen. In der Regel kannst du vielleicht schon gut schlafen, wenn der Webserver den Zugriff auf xmlrpc.php einfach nicht zulässt.</p>
<h2 id="die-rest-api-verweise-entfernen">Die REST-API-Verweise entfernen</h2>
<p>Seit Version 4.4 hat WordPress eine REST-API an Bord, die wie XML-RPC eine Schnittstelle bietete, um bestimmte Informationen über deine Seite automatisiert auszulesen. Obgleich das Sicherheitsrisiko der REST-API ungleich niedriger ist als bei XML-RPC, kannst du auch hier ein wenig aufräumen, indem du den Verweis auf die REST-API folgendermaßen aus den HTML- sowie HTTP-Header entfernst:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">remove_action(&#39;wp_head&#39;, &#39;rest_output_link_wp_head&#39;, 10);
</span></span><span class="line"><span class="ln">2</span><span class="cl">remove_action(&#39;template_redirect&#39;, &#39;rest_output_link_header&#39;, 11, 0);
</span></span></code></pre></div><p>Ganz deaktivieren solltest du die API allerdings nicht, da sie vor allem auch für die reibungslose Backend-Funktionalität wichtig ist. Was du aber machen kannst, ist die REST-API <a href="https://developer.wordpress.org/rest-api/frequently-asked-questions/">nur nach Anmeldung zulassen:</a></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">add_filter(&#39;rest_authentication_errors&#39;, &#39;rest_api_auth&#39;);
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">function rest_api_auth($result) {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    // bereits erfolgreich authentifiziert?
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    if ( true === $result || is_wp_error( $result ) ) {
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        return $result;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    }
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    // noch nicht authentifiziert?
</span></span><span class="line"><span class="ln">10</span><span class="cl">    if ( ! is_user_logged_in() ) {
</span></span><span class="line"><span class="ln">11</span><span class="cl">        return new WP_Error(
</span></span><span class="line"><span class="ln">12</span><span class="cl">            &#39;rest_not_logged_in&#39;,
</span></span><span class="line"><span class="ln">13</span><span class="cl">            __( &#39;You are not currently logged in.&#39; ),
</span></span><span class="line"><span class="ln">14</span><span class="cl">            array( &#39;status&#39; =&gt; 401 )
</span></span><span class="line"><span class="ln">15</span><span class="cl">        );
</span></span><span class="line"><span class="ln">16</span><span class="cl">    }
</span></span><span class="line"><span class="ln">17</span><span class="cl"> 
</span></span><span class="line"><span class="ln">18</span><span class="cl">    // sonst zurück
</span></span><span class="line"><span class="ln">19</span><span class="cl">    return $result;
</span></span><span class="line"><span class="ln">20</span><span class="cl">}
</span></span></code></pre></div><h2 id="fazit">Fazit</h2>
<p>Das war es erstmal. Wenn du jetzt noch das Gefühl hast, dass dein WordPress zu langsam ist, wirf mal einen Blick in die Entwickler-Konsole und schau nach, welche Ressourcen lange dauern oder ob du Anfragen doppelt absetzt. Es gibt vor allem auf Server-Seite, also unterhalb von WordPress, noch eine Menge Möglichkeiten. Einige davon habe ich in der <a href="https://www.nickyreinert.de/mehrere-virtuelle-server-mit-nginx-und-php-fpm-fur-wordpress-teil-1-3/">Artikel-Serie zum perfekten Web-Server-Setup aufgeführt</a>. Außerdem gibt es hier eine wirklich brilliante Artikel-Serie zum Thema Sicherheit, die du dir unbedingt lesen solltest. Hier werden unzählige wichtige Hinweise gegeben,</p>
<p>Zum Abschluss noch mal der Hinweis: Es handelt sich hierbei um mitunter tiefe Eingriffe in die <strong>WordPress-Mechanik</strong>. Solltest du in der Zukunft Probleme mit deiner Seite haben, nimm diese Änderungen Schritt für Schritt zurück. Arbeite mit einem Staging-System und nutze Backups. Bei Probleme und Inkompatiblitäten freue ich mich über sachdienliche Hinweise, die ich in den Artikel einbauen kann!</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> einstellungen, setup, wordpress</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Leitfaden für ein sicheres und schnelles WordPress-Setup - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>optimization_guide</dc:type>
      
      
    </item><item>
      <title>Dinge, die nicht existieren</title>
      <link>https://nickyreinert.de/2020/2020-06-22-dinge-die-nicht-existieren/</link>
      <pubDate>Mon, 22 Jun 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-06-22-dinge-die-nicht-existieren/</guid>
      <description>Dinge, die nicht existieren, weil sie mit künstlicher Intelligenz, Deep Learning bzw. Algorithmen erschaffen wurden. Dabei handelt es sich nicht nur um Bilder …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine kuratierte Sammlung von Links zu verschiedenen Web-Projekten, die künstliche Intelligenz und generative Algorithmen nutzen, um Dinge zu erschaffen, die nicht existieren. Die Liste umfasst eine breite Palette von KI-generierten Inhalten, darunter fotorealistische Personen, Kunst, Musik, Texte, Memes und mehr.</p>
          
          
          <p><strong>Hauptthemen:</strong> Künstliche Intelligenz, Generative AI, Deep Learning, Machine Learning, Internet-Kultur, Digitale Kunst</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> beginner</p>
          
        </div>
        
        
        <p>Dinge, die nicht existieren, weil sie mit künstlicher Intelligenz, Deep Learning bzw. Algorithmen erschaffen wurden. Dabei handelt es sich nicht nur um Bilder von Personen, sondern auch Texte, Animationen, Musik, Dialoge und&hellip;Füße. Viel Spaß.</p>
<ul>
<li>
<p><a href="https://www.nickyreinert.de/files/existiert-nicht/grafik-2.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-2-272x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/existiert-nicht/grafik-1.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-1-291x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/existiert-nicht/grafik.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-285x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-15.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-15-247x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-14.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-14-175x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-9.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-9-300x207.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-10.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-10-700x475.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-11.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-11-700x390.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-12.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-12-700x468.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-13.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-13-700x467.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-8.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-8-700x381.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-7.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-7-700x835.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-6.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-6-295x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-5.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-5-300x279.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-4.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-4-300x119.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-3.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-3-300x123.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-2.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-2-300x300.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik-1.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-1-300x298.png" alt=""></a></p>
</li>
<li>
<p><a href="https://www.nickyreinert.de/files/this-does-not-exit/grafik.png"><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-300x208.png" alt="Existiert nicht"></a></p>
</li>
</ul>
<h2 id="personen">Personen</h2>
<p><a href="https://thispersondoesnotexist.com/">https://thispersondoesnotexist.com/</a></p>
<p>Das ist wohl der Klassiker und aus meiner Sicht das beeindruckenste Werk. Bei jedem Aufruf der Seite wird ein neues Foto eines Menschen erstellt, der nicht existiert. Die Darstellung ist dennoch verblüffend realistisch. Diese Seite stammt von Phillip Wang, einem Ingeni eur bei Uber. Dem Vorbild dieser Seite folgen eine Reihe anderer Seiten. Projekt ist Teil einer ganzen Serie von Seiten mit ähnlichem Aufbau. Erzeugt wird das ganze mit einem <a href="https://de.wikipedia.org/wiki/Generative_Adversarial_Networks">Generative Adversarial Networks</a>, genauer dem von NVidia stammenden <a href="https://en.wikipedia.org/wiki/StyleGAN">StyleGAN2</a>.</p>
<p><img src="#ZgotmplZ" alt="This Person does not exist"></p>
<h2 id="friends-dialoge">Friends-Dialoge</h2>
<p><a href="https://thispersondoesnotexist.com/friends/">https://thispersondoesnotexist.com/friends/</a></p>
<p>Dass das auch für Dialoge funktioniert zeigt diese Unterseite. Hier werden künstliche Dialoge erzeugt. Grundlage sind die Dialoge aus der <a href="https://de.wikipedia.org/wiki/Friends">Comedy-Serie Friends</a>.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-5-700x650.png" alt="Friends KI erzeugte Dialoge"></p>
<p>Quelle: <a href="https://thispersondoesnotexist.com/friends/">https://thispersondoesnotexist.com/friends/</a></p>
<h2 id="the-office-dialoge">The Office-Dialoge</h2>
<p><a href="https://thispersondoesnotexist.com/office/">thispersondoesnotexist.com/office/</a></p>
<p>Das gleiche funktioniert natürlich auch für andere Serien, hier für die Serie The Office.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-6-700x711.png" alt=""></p>
<p>Quelle: <a href="https://thispersondoesnotexist.com/office/">https://thispersondoesnotexist.com/office/</a></p>
<h2 id="moderne-kunst">Moderne Kunst</h2>
<p><a href="https://thisartworkdoesnotexist.com/">https://thisartworkdoesnotexist.com/</a></p>
<p>Bei jedem Aufruf wird ein neues Kunstwerk erzeugt. Bei &ldquo;abstrakten&rdquo; Kunstwerken ist das Ergebnis weitaus weniger beeindruckend, aber mitunter trotzdem schön.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-700x486.png" alt=""></p>
<p>Quelle: <a href="https://thisartworkdoesnotexist.com/">https://thisartworkdoesnotexist.com/</a></p>
<h2 id="katzen">Katzen</h2>
<p><a href="https://thiscatdoesnotexist.com/">https://thiscatdoesnotexist.com/</a></p>
<p>Ein weiterer Beitrag aus dieser Serie. Hier geht es um nicht existierende Katzen. Die Bilder sind etwas kleiner als bei den vorherigen Seiten und es gibt keine Hintergrundinformationen. Aber Katzen gehören eben auch dazu.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-1.png" alt=""></p>
<p>Quelle: <a href="https://thiscatdoesnotexist.com/">https://thiscatdoesnotexist.com/</a></p>
<h2 id="pferde">Pferde</h2>
<p><a href="https://thishorsedoesnotexist.com/">https://thishorsedoesnotexist.com/</a></p>
<p>Das ganze gibt es auch für Pferde. Hier gerät der Algorithmus aber scheinbar an seine Grenzen. Bei allen erzeugten Bildern sind Fehler, oft an den Füßen, erkennbar.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-2.png" alt=""></p>
<p>Quelle: <a href="https://thishorsedoesnotexist.com/">https://thishorsedoesnotexist.com/</a></p>
<h2 id="moleküle">Moleküle</h2>
<p><a href="https://thischemicaldoesnotexist.com/">thischemicaldoesnotexist.com/</a></p>
<p>Einen etwas anderen Weg geht diese Seite. Hier wird nicht einfach ein Bild erzeugt, sondern die räumliche Darstellung eines Moleküls.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-3-700x287.png" alt=""></p>
<p>Quelle: <a href="https://thischemicaldoesnotexist.com/">https://thischemicaldoesnotexist.com/</a></p>
<h2 id="schlagzeilen">Schlagzeilen</h2>
<p><a href="https://thisarticledoesnotexist.com/">https://thisarticledoesnotexist.com/</a></p>
<p>Auch dieses Projekt ist maximal faszinierend. Hier werden Schlagzeilen erzeugt. Die Grundlage ist <a href="https://github.com/rowanz/grover">Grover</a>, ein Model für &ldquo;Neurale Fake News&rdquo;. Die Seite zieht sich alle 30 Minuten die populärsten Schlagzeilen von Reddit und HackerNews und erzeugt daraus neue Nachrichten.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-4-700x278.png" alt=""></p>
<p>Quelle: <a href="https://thisarticledoesnotexist.com/">https://thisarticledoesnotexist.com/</a></p>
<h2 id="shan-shui">Shan Shui</h2>
<p><a href="http://shan-shui-inf.lingdong.works/">http://shan-shui-inf.lingdong.works/</a></p>
<p>Hierbei handelt es sich um eine tradionalle chinesische Malerei, bei der Landschaften dargestellt werden. Das Projekt erzeugt eine prozedural erzeugte Landschaft unendlicher Breite. Du kannst die horizontale Scrollgeschwindigkeit einstellen und das Ergebnis sogar als SVG-Datei herunterladen. Der Sourcecode ist auf <a href="https://github.com/LingDong-/shan-shui-inf">github</a> verfügbar.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/screen001.jpg" alt=""></p>
<p>Quelle: <a href="http://shan-shui-inf.lingdong.works/">ttp://shan-shui-inf.lingdong.works/</a></p>
<h2 id="fursona">Fursona</h2>
<p><a href="https://thisfursonadoesnotexist.com/">https://thisfursonadoesnotexist.com/</a></p>
<p>Fursona sind Mischungen aus Menschen und Tieren. Das Projekt erzeugt Icons mit Fursons in einer Matrix, die unendlich in eine beliebige Richtung scrollt.</p>
<p><img src="#ZgotmplZ" alt=""></p>
<p>Quelle: <a href="https://thisfursonadoesnotexist.com/">https://thisfursonadoesnotexist.com/</a></p>
<h2 id="waifus">Waifus</h2>
<p><a href="https://www.thiswaifudoesnotexist.net/">thiswaifudoesnotexist.net/</a></p>
<p>Auch bei den Waifus handelt es sich um Kunstfiguren. <a href="https://de.wikipedia.org/wiki/Waifu">Waifus sind weibliche Komikfiguren aus Mangas, Animes oder japanischen Computerspielen</a>. Diese Seite erzeugt Waifus und liefert auch die passende Beschreibung dazu.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-8-700x381.png" alt=""></p>
<p>Quelle: <a href="https://www.thiswaifudoesnotexist.net/">https://www.thiswaifudoesnotexist.net/</a></p>
<h2 id="anzeigen-für-wohnungs-vermietungen">Anzeigen für Wohnungs-Vermietungen</h2>
<p><a href="https://thisrentaldoesnotexist.com">https://thisrentaldoesnotexist.com</a></p>
<p>Auch das ist möglich: Ein komplette Anzeige für die Vermietung einer Wohnung, mit Bildern und Beschreibung.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-7-700x835.png" alt=""></p>
<p>Quelle: <a href="https://thisrentaldoesnotexist.com/">https://thisrentaldoesnotexist.com/</a></p>
<h2 id="lebenslauf">Lebenslauf</h2>
<p><a href="https://thisresumedoesnotexist.com/">https://thisresumedoesnotexist.com/</a></p>
<p>Weiter geht es mit Lebensläufen. Diese Seite erzeugt einen kompletten Lebenslauf mit Namen, Kontaktdaten und allem, was ein Lebenslauf so ausmacht. Die Bilder der Personen stammen von thispersondoesnotexist.com.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-9-700x484.png" alt=""></p>
<p>Quelle: <a href="https://thisresumedoesnotexist.com/">https://thisresumedoesnotexist.com/</a></p>
<h2 id="gefäße">Gefäße</h2>
<p><a href="https://thisvesseldoesnotexist.com/#/">thisvesseldoesnotexist.com/#/</a></p>
<p>Ja, du hast richtig gelesen. Gefäße, Englisch: Vessels. Die Seite präsentiert dir eine Matrix aus nicht existierenden Gefäßen, die in ihrer Form und Bemalung aninimiert sind. Der Anblick hat etwas beruhigendes.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-11-700x390.png" alt=""></p>
<p>Quelle: <a href="https://thisvesseldoesnotexist.com/#/">https://thisvesseldoesnotexist.com/#/</a></p>
<h2 id="songtexte">Songtexte</h2>
<p><a href="https://theselyricsdonotexist.com/">theselyricsdonotexist.com/</a></p>
<p>Was für Schlagzeilen funktioniert, funktioniert natürlich auch für Musik. Hier legst du ein Genre fest, bestimmst die Stimmung und gibst ein frei wählbares Thema an. Die Seite erzeugt dir dann einen englischsprachigen Song.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-12-700x468.png" alt=""></p>
<p>Quelle: <a href="https://theselyricsdonotexist.com/">https://theselyricsdonotexist.com/</a></p>
<h2 id="musik">Musik</h2>
<p><a href="http://allthemusic.info/">http://allthemusic.info/</a> und <a href="https://github.com/allthemusicllc">https://github.com/allthemusicllc</a></p>
<p>Passend dazu gibt es natürlich auch ein Projekt für Musik. Damien Riehl und Noah Rubin haben einen Algorithmus entwickelt, der jede denkbare Melodie erzeugt. Das Ergebnis haben sie in Midi-Dateien gepackt und diese für die öffentliche Verwendung freigegeben. <a href="https://www.vice.com/en_us/article/wxepzw/musicians-algorithmically-generate-every-possible-melody-release-them-to-public-domain">Ziel ist es, Musiker davor zu schützen verklagt zu werden</a>.</p>
<h2 id="emotionen">Emotionen</h2>
<p><a href="https://jschn.github.io/FaceApp/">jschn.github.io/FaceApp/</a></p>
<p>Hierbei handelt es sich eigentlich nicht um das Ergebnis eines lernenden Algorithmuses. Allerdings werden auch hier Datensätze verarbeitet, die den Zusammenhang zwischen Emotionen und Mimik beschreiben. Auf dieser Seite kannst du mit ein paar Schieberegeln die Emotionen eines Strich-Gesichts steuern.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-10-700x475.png" alt=""></p>
<p>Quelle: <a href="https://jschn.github.io/FaceApp/">https://jschn.github.io/FaceApp/</a></p>
<h2 id="memes">Memes</h2>
<p><a href="https://imgflip.com/ai-meme">https://imgflip.com/ai-meme</a></p>
<p>Natürlich dürfen Memes auch nicht fehlen. Imgflip ist als Portal für Memes bekannt. Dort hat man nun einen Algorithmus gebaut, der die bekannten Memes auswertet und daraus neue Memes erstellt. Die erzeugten Memes überzeugen nicht sofort, man muss ein paar Runden drehen, bevor ein halbwegs brauchbares Meme auftaucht.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-13-700x467.png" alt=""></p>
<p>Quelle: <a href="https://imgflip.com/ai-meme">https://imgflip.com/ai-meme</a></p>
<h2 id="füße">Füße</h2>
<p><a href="https://thisfootdoesnotexist.com/">https://thisfootdoesnotexist.com/</a></p>
<p>Füße? Ja. Auch dieser Fetisch wird bedient. Das Ergebnis ist die Animation eines Fußpaares, die aber augenscheinlich künstlich sind.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-15-700x851.png" alt=""></p>
<p>Quelle: <a href="https://thisfootdoesnotexist.com/">https://thisfootdoesnotexist.com/</a></p>
<h2 id="gesichter">Gesichter</h2>
<p><a href="https://generated.photos/">https://generated.photos/</a></p>
<p>Im Gegensatz zu den meisten obigen Projekten, die nur als Tech-Demo fungieren, geht es hier um eigenständiges Produkt. Die Datenbank umfasst mittlerweile fast 2 Mio. Gesichter. Über einen Suchfilter kann man die Ergebnismenge eingrenzen, z.B. nach der Hintergrundfarbe, dem Geschlecht, Alter und sogar der Emotion. Es lassen sich sogar nur die Fotos anzeigen, die dem gängigen Schönheitsideal entsprechen. Eine API wird kostenpflichtig angeboten.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-700x738.png" alt=""></p>
<p>Quelle: <a href="https://generated.photos/">https://generated.photos/</a></p>
<h2 id="musik-1">Musik</h2>
<p>Auch hierbei handelt es sich um ein etwas aufwendigeres Projekt (was nicht heißt, dass die anderen Projekte nicht aufwendig sind). Hier lässt sich ein komplettes Musik-Stück anhand bestimmter Parameter erstellen. Dazu gehört einmal der Stil, der sich an bekannten Künstlern aller Genres orientiert (Chopin, Beatles, &hellip;), sowie ein Intro als Grundlage und die zu verwendenden Instrumente. Bis zur 4 Stücke werden dann live im Browser &ldquo;erzeugt&rdquo;.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-1-700x722.png" alt=""></p>
<p>Quelle: <a href="https://openai.com/blog/musenet/">https://openai.com/blog/musenet/</a></p>
<h2 id="noch-mehr-musik">Noch mehr Musik</h2>
<p><a href="https://magenta.tensorflow.org/piano-transformer">https://magenta.tensorflow.org/piano-transformer</a></p>
<p>Hierbei handelt es sich um ein ähnliches Projekt. Zur Echzeiterzeugng wird auf ein Colab-Notebook verwiesen. Die Steuerung ist etwas komplizierter als bei den vorangegangen Projekten, hier ist der Fokus wohl etwas technischer. Ich habe dort ein paar Minuten rumgespielt, aber kein Ergebnis zustande bekommen.</p>
<h2 id="zitate">Zitate</h2>
<p><a href="https://inspirobot.me/">https://inspirobot.me/</a></p>
<p>Den vorläufigen Abschluss bildet ein Projekt, dass mithilfe von KI &ldquo;inspirirende Zitate zur endlosen Bereicherung der zwecklosen menschlichen Existenz&rdquo; erzeugt. Das ganze wird stilecht mit einem schönen Bild hinterlegt, natürlich auch künstlich erzeugt. Wie auch beim Meme-Generator von imgflip sind die Sprüche hier auch etwas starr und es dauert eine Weile, bis man halbwegs brauchbare Ergebnisse erhält.</p>
<p><img src="/2020/2020-06-22-dinge-die-nicht-existieren/images/grafik-2-700x773.png" alt=""></p>
<p>Quelle: <a href="https://inspirobot.me/">https://inspirobot.me/</a></p>
<h2 id="inspirirende-musik-bilder-und-worte">Inspirirende Musik, Bilder und Worte</h2>
<p><a href="https://inspirobot.me/mindfulnessmode">https://inspirobot.me/mindfulnessmode</a></p>
<p>Das Angebot gehört noch zum eigentlich schon versprochenen Abschluss und ich will es auch nicht unerwähnt untergehen lassen. Der Name lautet &ldquo;<strong>Mindfulness Mode</strong>&rdquo;. Zu &ldquo;inspirierenden Bildern&rdquo; wird entspannte Musik gespielt und eine Stimme liest motivierende Sprüche und Weisheiten vor. Das ist also das Komplettangebot.</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> ai, ki, kuenstliche-intelligenz, uebersicht</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Dinge, die nicht existieren - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>link_collection</dc:type>
      
      
    </item><item>
      <title>WordPress Word Cloud 2.0</title>
      <link>https://nickyreinert.de/2020/2020-06-09-wordpress-word-cloud-2-0/</link>
      <pubDate>Tue, 09 Jun 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-06-09-wordpress-word-cloud-2-0/</guid>
      <description>Mein Word Cloud Plugin für WordPress liegt in einer neuen Version vor! Die Word Cloud unterstützt nun OCR, Tags, interne und externe Quellen und vieles mehr. Da …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine umfassende Dokumentation für die Version 2.0 des Plugins &#39;WP Word Cloud&#39;. Der Artikel beschreibt die erweiterten Funktionen, darunter die Erstellung von Wortwolken aus diversen Quellen (URL, SQL, Post-ID), eine interaktive Frontend-Bearbeitung und eine clientseitige Texterkennung (OCR) für Bilder. Es wird eine detaillierte Anleitung zur Installation und zur Verwendung aller Shortcode-Parameter gegeben.</p>
          
          
          <p><strong>Hauptthemen:</strong> WordPress, Plugins, Datenvisualisierung, JavaScript, OCR, Tesseract.js</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> intermediate</p>
          
        </div>
        
        
        <p>Mein Word Cloud Plugin für WordPress liegt in einer neuen Version vor! Die Word Cloud unterstützt nun <strong>OCR</strong>, <strong>Tags</strong>, <strong>interne</strong> und <strong>externe Quellen</strong> und vieles mehr. Da ich also sehr viele grundlegende Änderungen vorgenommen habe, gibt es an dieser Stelle eine komplett neue Dokumentation. Viel Spass.</p>
<h2 id="was-ist-eine-word-cloud">Was ist eine Word Cloud?</h2>
<p>Eine <strong>Word Cloud</strong>, auch <strong>Schlagwortwolke</strong>, <strong>Wortwolke</strong> usw., dient der besseren Visualisierung von Texten. Um eine Word Cloud zu erstellen, werden die Vorkommen von Wörtern eines Textes gezählt. Die Wörter mit der größten <strong>Häufigkeit</strong> werden groß dargestellt, Wörter mit geringerer Häufigkeit weniger groß. Und das ganze wird dann in einer <strong>Wolkenform</strong> dargestellt, mit den größten Wörtern in der Mitte.</p>
<p>So ist es möglich auf einen Blick zu erkennen, welche Wörter in einem Text am häufigsten vorkommen. Das ist nicht nur bei der Analyse von Texten sondern auch von Webseiten nützlich. So kannst du z.B. bei WordPress eine Word Cloud aus Tags erstellen (<strong>Tag Cloud</strong>), anhand der man sehen kann, welche Tags auf einer Seite am meisten verwendet wurden.</p>
<p>Die folgende Word Cloud zeigt auf einen Artikel, <a href="https://www.nickyreinert.de/wie-erstelle-ich-ein-labyrinth-mit-javascript/">in dem ich einen Algorithmus beschreibe, um in JavaScript ein Labyrinth zu erstellen</a>:</p>
<p>[wp-word-cloud source-type=&ldquo;id&rdquo; id=&ldquo;demo1&rdquo; size-factor=50 min-alpha=0.5 count-words=1]3334[/wp-word-cloud]</p>
<h2 id="was-kann-dieses-plugin">Was kann dieses Plugin?</h2>
<p><strong>WP Word Cloud</strong> stellt einen Shortcode zur Verfügung, mit dem du beliebig viele <strong>Word Clouds</strong> auf deinen Seiten einfügen kannst. Du kannst verschiedene Quellen nutzen, um dort die Wörter zu zählen und in einer <strong>Word Cloud</strong> darstellen zu lassen.</p>
<ul>
<li>inline - du gibst den Text direkt im Shortcode im Beitrag an</li>
<li>url - ein Verweis auf eine Internetadresse</li>
<li>id - der Verweis auf eine Seite / einen Beitrag</li>
<li>sql - eine SQL-Abfrage um Text aus der Datenbank zu lesen</li>
<li>custom-field - Text aus einem custom field des Beitrages / der Seite</li>
<li>Text, den der Besucher der Webseite selber eingeben kann</li>
<li>Text von einem Bild, das der Besucher der Website hochlädt</li>
</ul>
<p>Das Plugin greift auf zwei sehr großartige Bibliotheken zurück: WodCloud2.js von TimDream (<a href="https://github.com/timdream/wordcloud2.js/">github.com</a>). Sowie die Offline-Implementierung von Tesseract in JavaScript (<strong><a href="https://github.com/jeromewu/tesseract.js-offline">github.com</a></strong>).</p>
<h2 id="installation">Installation</h2>
<h3 id="über-die-kommandozeile">Über die Kommandozeile</h3>
<p>Wenn du Zugriff auf deinen Server über SSH hast, kannst du das Plugin folgendermaßen installieren:</p>
<p>Wechsle in den Plugin-Ordner deiner WordPress-Installation und lege dort einen neuen Ordner an: WP-Word-Cloud, wechsle danach in diesen Ordner:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">mkdir /htdocs/wp-content/plugins/WP-Word-Cloud
</span></span><span class="line"><span class="ln">2</span><span class="cl">cd /htdocs/wp-content/plugins/WP-Word-Cloud
</span></span></code></pre></div><p>Danach kannst du das Plugin-Repository mit git klonen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">git clone https://github.com/nickyreinert/wordCloud-for-Wordpress.git .
</span></span></code></pre></div><p>Wenn du git nicht benutzen möchtest oder kannst, kannst du das Plugin auch mit wget herunterladen und dann entpacken. Dann musst du den Plugin-Ordner allerdings nicht selber erstellen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">cd /htdocs/wp-content/plugins/
</span></span><span class="line"><span class="ln">2</span><span class="cl">wget https://github.com/nickyreinert/wordCloud-for-Wordpress/archive/wordCloud-for-wordPress-2.zip --no-check-certificate
</span></span><span class="line"><span class="ln">3</span><span class="cl">unzip wordCloud-for-wordPress-2.zip -d WP-Word-Cloud
</span></span></code></pre></div><h3 id="mit-einem-ftp-programm">Mit einem FTP-Programm</h3>
<p>Wenn du keinen Zugriff auf die Kommandozeile hast, kannst du das Plugin von dieser Adresse herunterladen:</p>
<p><a href="https://github.com/nickyreinert/wordCloud-for-Wordpress/archive/wordCloud-for-wordPress-2.zip">https://github.com/nickyreinert/wordCloud-for-Wordpress/archive/wordCloud-for-wordPress-2.zip</a></p>
<p>Danach entpackst du das Archiv und lädst den kompletten Ordner in das Plugin-Verzeichnis deiner WordPress-Installation. Du kannst den Ordner mit dem FTP-Programm dann umbenennen:</p>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik.png" alt=""></p>
<p>Der Order für das Word Cloud Plugin</p>
<h2 id="abschluss-der-installation">Abschluss der Installation</h2>
<p>Abschließend muss das Plugin noch im Backend von WordPress aktiviert werden. Dazu suchst du im Plugin-Bereich nach dem Eintrag &ldquo;WP Word Cloud&rdquo; und klickst auf &ldquo;aktivieren&rdquo;. Fertig.</p>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik-1-700x70.png" alt=""></p>
<p>Aktiviere das Plugin in der Plugin-Übersicht von WordPress</p>
<h2 id="erste-verwendung">Erste Verwendung</h2>
<p>Das Plugin aktiviert für deine WordPress-Installation einen neuen Shortcode: <strong>[ wp-word-cloud ]</strong>. Diesen kannst du nun auf jeder Seite und in jedem Beitrag beliebig oft einfügen. Wenndu den <strong>Gutenberg-Editor</strong> verwendest, benötigst du dafür den Block &ldquo;<strong>Shortcode</strong>&rdquo;. Im konventionellen Editor kannst du den Shortcode einfach in deinen Text einfügen.<br>
Eine einfache Implementierung sieht z.B. so aus:</p>
<p><code>[ wp-word-cloud source-type=&quot;url&quot; id=&quot;meine-word-cloud&quot; ]https://www.spiegel.de[ /wp-word-cloud ]</code></p>
<p>Es gibt <strong>drei Parameter</strong>, die du <strong>immer</strong> angeben musst:</p>
<ul>
<li><strong>id</strong>, eine eindeutige Id, mit der die <strong>Word Cloud</strong> auf deiner Seite angesprochen wird, z.B. <strong>meine-word-cloud</strong> oder einfach nur <strong>test</strong></li>
<li><strong>source-type</strong>, welcher Art die Quelle für die Word Cloud ist, also z.B. von einer <strong>url</strong> oder den <strong>tags</strong></li>
<li>sowie Inline-Text, als Verweis auf die Quelle, von wo der Inhalt für die Word Cloud kommt, also z.B. die URL <strong><a href="https://www.spiegel.de">https://www.spiegel.de</a></strong> oder die Id eines Beitrages (123)</li>
</ul>
<h2 id="zusätzliche-einstellungen">Zusätzliche Einstellungen</h2>
<p>Natürlich gibt es noch <strong>eine Menge weiterer Parameter</strong>, mit denen du das Erscheinungsbild der Word Cloud steuern kannst. Das Plugin setzt bei der ersten Installation für all diese Parameter <strong>Standard-Einstellungen</strong> fest. Diese sind grundsätzlich <strong>global gültig</strong> und können auf der Einstellungseite angepasst werden:</p>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik-2.png" alt=""></p>
<p>In den Einstellungen findest du eine eigene Seite für das WP Word Cloud Plugin - wunderbar!</p>
<p>Jeden dieser globalen Parameter kannst du auch in deinem Shortcode verwenden. So wir die globale Einstellung überschrieben. So ist die <strong>Hintergrundfarbe</strong> z.B. standardmäßig <strong>transparent</strong> eingestellt. Möchtest du sie für die aktuelle Word Cloud auf <strong>grün und halbtransparent</strong> ändern, übergibst du einfach den Parameter <strong>background-color</strong> folgendermaßen:</p>
<p><code>[ wp-word-cloud source-type=&quot;url&quot; id=&quot;meine-word-cloud&quot; background-color=&quot;rgba(0,255,255,0.5)&quot; ]https://www.spiegel.de[ /wp-word-cloud ]</code></p>
<p>Eine genaue Beschreibung aller Parameter folgt jetzt:</p>
<h2 id="parameter">Parameter</h2>
<h3 id="id">id</h3>
<p>Dieser Parameter ist für jeden Shortcode, den du einfügst, <strong>verpflichtend</strong>! Die Id adressiert jede Word Cloud auf einer Seite oder in einem Beitrag. Damit ist es möglich, mehrere Word Clouds gleichzeitig einzubinden. Mit der Id kannst du außerdem das Aussehen der Word Cloud mit CSS steuern. Beispiel:</p>
<p><code>[ wp-word-cloud source-type=&quot;inline&quot; id=&quot;wordcloud1&quot; ]Lorem Ipsum[ /wp-word-cloud ]</code></p>
<p><code>[ wp-word-cloud source-type=&quot;inline&quot; id=&quot;wordcloud2&quot; ]Lorem Ipsum[ /wp-word-cloud ]</code></p>
<h3 id="source-type"><strong>source-type</strong></h3>
<p>Damit legst du fest, um was für eine Quelle es sich handelt. Dieser Parameter ist <strong>verpflichtend</strong>. Die folgenden Quellen werden unterstützt:</p>
<h4 id="source-typeinline">source-type=inline</h4>
<p>Der Text wird innerhalb des Shortcodes übermittelt, z.B:</p>
<p><code>[ wp-word-cloud source-type=inline id=&quot;demo&quot; ]Lorem Ipsum[ /wp-word-cloud ]</code></p>
<h4 id="source-typeurl">source-type=<strong>url</strong></h4>
<p>Im Shortcode wird eine URL angegeben, von der der Text abgerufen wird, z.B:</p>
<p><code>[ wp-word-cloud source-type=url id=&quot;demo&quot; ]https://www.spiegel.de[ /wp-word-cloud ]</code></p>
<h4 id="source-typeid">**source-type=**id</h4>
<p>Im Shortcode wird eine Id übergeben, die auf eine Seite oder einen Beitrag deiner Webseite verweist, z.B:</p>
<p><code>[ wp-word-cloud source-type=id id=&quot;demo&quot; ]123[ /wp-word-cloud ]</code></p>
<h4 id="source-typesql">source-type=sql</h4>
<p>Im Shortcode wird eine SQL-Abfrage übergeben, die eine bereits gezählte Wortliste zurück gibt, z.B:</p>
<p><code>[ wp-word-cloud source-type=sql id=&quot;demo&quot;]SELECT word,count FROM table;[ /wp-word-cloud]</code></p>
<h4 id="source-typetags">source-type=tags</h4>
<p>Die Word Cloud zeigt alle Tags deiner Seite an, hier musst du im Shortcode nichts weiter übergeben:</p>
<p><code>[ wp-word-cloud source-type=tags id=&quot;demo&quot;]SELECT word,count FROM table;[ /wp-word-cloud]</code></p>
<h4 id="source-typecustom-field">source-type=custom-field</h4>
<p>Im Shortcode wird auf ein custom field, also benutzerdefiniertes bzw. eigenes Feld verwiesen, z.B:</p>
<p><code>[ wp-word-cloud source-type=custom-field id=&quot;demo&quot;]my-custom-field[ /wp-word-cloud]</code></p>
<p>Die Darstellung der <strong>eigenen Felder</strong> musst du im Gutenberg-Edito ggf. erst aktivieren. Klicke dazu das Punkt-Menü und dann ganz unten auf &ldquo;Ansicht anpassen&rdquo;. Es öffnet sich nun eine Liste, in der du die &ldquo;eigenen Felder&rdquo; aktivieren kannst:</p>
<ul>
<li>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik-10.png" alt=""></p>
</li>
<li>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik-11-700x1059.png" alt=""></p>
</li>
</ul>
<p>Anzeigen der benutzerdefinierten Felder im Gutenberg-Editor</p>
<h3 id="count-words"><strong>count-words</strong></h3>
<p>Wenn die im Shortcode angegebene Quelle einen kompletten Text enthält, müssen die Wörter darin erst gezählt werden. Dazu muss <strong>count-words</strong> auf <strong>1</strong> gesetzt werden. Ist <strong>count-words=0</strong> gesetzt, erwartet das Plugin eine List mit gezählten Wörtern.</p>
<h3 id="enable-frontend-edit"><strong>enable-frontend-edit</strong></h3>
<p>Ist dieser Parameter auf 1 gesetzt, wird auf der Seite ein Textfeld angezeigt. Das Textfeld enthält den Text, der mit dem Shortcode definiert wurde. Der Besucher kann den Text dann beliebig verändern oder eigenen Text hinzufügen, um so die <strong>Word Cloud</strong> selber zu steuern. Die Berechnung der <strong>Word Cloud</strong> findet im Browser statt. Im folgenden Beispiel kommt der Text von einem benutzerdefiniertem Feld im Backend. Er wird an das Frontend ausgeliefert und dort in der Word Cloud dargestellt. Gleichzeitig kann man den Text aber auch anpassen und die Wolke neu zeichnen lassen:</p>
<p><code>[ wp-word-cloud source-type=&quot;custom-field&quot; enable-frontend-edit</code>=1 <code>id=&quot;demo&quot;]my-custom-field[ /wp-word-cloud]</code></p>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik-8-700x755.png" alt=""></p>
<p>Ein Textfeld für die Besucher deiner Webseite</p>
<h3 id="ocr---texterkennung">OCR - Texterkennung</h3>
<h4 id="enable-ocr"><strong>enable-ocr</strong></h4>
<p>Ist dieser Parameter auf 1 gesetzt, kann der Benutzer auf der Webseite ein Bild hochladen oder mit der Kamera aufnehmen. Im Browser findet dann eine Text-Erkennung statt. Die Wörter werden dann gezählt und die Word Cloud darauf basierend gezeichnet. Wenn <strong>enable-frontend-edit</strong> nicht aktiv ist, hat dieser Parameter keine Wirkung.</p>
<p><code>[ wp-word-cloud source-type=&quot;custom-field&quot; enable-frontend-edit=1 enable-ocr=1 id=&quot;demo&quot;]my-custom-field[ /wp-word-cloud]</code></p>
<p>Für diese Funktionalität greift das Plugin auf die <a href="https://tesseract.projectnaptha.com/">Tesseract-Bibliothek</a> zurück. Diese ermöglicht die Texterkennung von abfotografierten Dokumenten in verschiedenen Sprachen. Die Texterkennung erfolgt komplett im Browser, also beim Besucher der Webseite. Das Bild wird <strong>nicht zum Server hochgeladen</strong>.</p>
<h4 id="ocr-language">ocr-language</h4>
<p>Mit diesem Parameter legst du fest, welche Sprache(n) das ORC-Modul unterstützen soll. Standardmäßig ist hier deu eingestellt. Du kannst mehre Sprachen angeben, wenn du sie mit einem + trennst, z.B. Deutsch + Englisch:</p>
<p><code>`[ wp-word-cloud source-type=&quot;custom-field&quot; enable-frontend-edit=1 enable-ocr=1 ocr-language=&quot;deu+eng&quot; id=&quot;demo&quot;]my-custom-field[ /wp-word-cloud]`</code></p>
<p>Eine Liste aller unterstützten Sprachpakete findest du hier:</p>
<p><a href="https://tesseract-ocr.github.io/tessdoc/Data-Files#data-files-for-version-400-november-29-2016">https://tesseract-ocr.github.io/tessdoc/Data-Files#data-files-for-version-400-november-29-2016</a></p>
<h4 id="ocr-local-libraries">ocr-local-libraries</h4>
<p>Das OCR-Modul lädt einige, größere Dateien von einem anderen Server nach, unter anderem auch die Sprachpakete. Du kannst diese Dateien auch auf deinem Server anbieten. Dazu musst du die folgenden Dateien herunterladen und im Unterordner &ldquo;<strong>lib</strong>&rdquo; innerhalb des Plugin-Ordners ablegen:</p>
<ul>
<li>[https://unpkg.com/tesseract.js@v2.0.0/dist/worker.min.js](<a href="https://unpkg.com/tesseract.js@v2.0.0/dist/worker.min.js%27">https://unpkg.com/tesseract.js@v2.0.0/dist/worker.min.js'</a> defer=&lsquo;defer)</li>
<li>[https://unpkg.com/tesseract.js-core@v2.0.0/tesseract-core.wasm.js](<a href="https://unpkg.com/tesseract.js-core@v2.0.0/tesseract-core.wasm.js%27">https://unpkg.com/tesseract.js-core@v2.0.0/tesseract-core.wasm.js'</a> defer=&lsquo;defer)</li>
</ul>
<p>Außerdem benötigst du die von dir konfigurierten Sprachpakete. Diese kannst <a href="https://tesseract-ocr.github.io/tessdoc/Data-Files#data-files-for-version-400-november-29-2016">du hier für die Version 4 herunterladen</a>. Die Sprachpakete gehören ebenfalls in den Unterordner &ldquo;lib&rdquo;. Außerdem <strong>musst du manuell</strong> die Dateiendung &ldquo;.gz&rdquo; anhängen.</p>
<h3 id="eingrenzen-der-wortliste">Eingrenzen der Wortliste</h3>
<h4 id="min-word-length">min-word-length</h4>
<p>Hiermit legst du fest, wie lang ein Wort mindestens sein soll, um beim Zählen berücksichtigt zu werden. Diese Einstellung wird <strong>nicht</strong> berücksichtigt, wenn du eine fertige Wortliste als Quelle angibst. In diesem Beispiel wird das Wort Foo beim Zählen ignoriert.</p>
<p><code>`[ wp-word-cloud source-type=&quot;inline&quot; count-words=1 min-word-lenght=4 id=&quot;demo&quot;]Lorem Ipsum Foo[ /wp-word-cloud]`</code></p>
<h4 id="min-word-occurence">min-word-occurence</h4>
<p>Mit diesem Parameter legst du fest, wie oft ein Wort mindestens vorkommen muss, um in der word cloud dargestellt zu werden. Diese Einstellung wird <strong>immer</strong> berücksichtigt, auch wenn du eine fertige Wortliste als Quelle angibst. Im Beispiel werden nur Wörter in der word cloud dargestellt, die mindestens 2 mal vorkommen:</p>
<p><code>`[ wp-word-cloud source-type=&quot;inline&quot; count-words=1 min-word-occurence=2 id=&quot;demo&quot;]Lorem Ipsum Foo[ /wp-word-cloud]`</code></p>
<h4 id="black-list-und-enable-black-list">black-list und enable-black-list</h4>
<p>Die Blacklist enthält Wörter, die beim Zählen nicht berücksichtigt werden dürfen. Das können z.B. Funktionswörter oder Fremdwörter sein, die du nicht in der word cloud sehen möchtest. Die Wörter werden mit einem Leerzeichen getrennt angegeben. Wenn du den Parameter im Shortcode angibst, wird die globale Einstellung komplett ignoriert. Die Blacklist wird nur verwendet, wenn der Parameter enable-black-list auf 1 gesetzt ist. Im Beispiel wird das Wort &ldquo;Lorem&rdquo; beim Zählen ignoriert, das es sich auf der Blacklist befindet.</p>
<p><code>`[ wp-word-cloud source-type=&quot;inline&quot; count-words=1 enable-black-list`</code>=1 <code>`black-list=&quot;Lorem&quot; id=&quot;demo&quot;]Lorem Ipsum Foo[ /wp-word-cloud]`</code></p>
<h4 id="enable-custom-black-list">enable-custom-black-list</h4>
<p>Ist dieser Parameter aktiviert, kann der Besucher deiner Webseite Wörter in der word cloud anklicken, um sie aus der word cloud zu entfernen. Die Wörter erscheinen dann unter der word cloud in einer &ldquo;benutzerdefinierten&rdquo; Blacklist. Wenn sie dort erneut angeklickt werden, erscheinen sie wieder in der word cloud.</p>
<p><img src="/2020/2020-06-09-wordpress-word-cloud-2-0/images/grafik-9-700x569.png" alt=""></p>
<p>Eine word cloud mit benutzerdefinierter Blacklist, so schön!</p>
<h4 id="persistent-custom-black-list">persistent-custom-black-list</h4>
<p>Hiermit kannst du festlegen, dass die Blacklist erhalten bleibt, wenn der Besucher einen neuen Text in das Eingabefeld eingibt. Ist der Parameter deaktiviert, wird die benutzerdefnierte Blacklist gelöscht, sobald der Besucher einen neuen Text eingibt. Dieser Parameter ist nur wirksam, wenn auch das Textfeld aktiviert ist.</p>
<h4 id="ignore-chars">ignore-chars</h4>
<p>Mit diesem Parameter legst du fest, welche Zeichen aus dem Text entfernt werden, bevor er gezählt wird. Hier wird ein regulärer Ausdruck dieser Form erwartet:</p>
<p><code>ignore-chars=&quot;\(\)\[\]\,\.;&quot;</code></p>
<p>Auf diese Art kannst du ungewollte Satzzeichen, Sonderzeichen oder Steuerzeichen entfernen.</p>
<h3 id="erscheinungsbild-anpassen">Erscheinungsbild anpassen</h3>
<h4 id="style">style</h4>
<h4 id="text-transform">text-transform</h4>
<p>Hiermit kannst du festlegen, dass der Text beim Darstellen in der word cloud groß oder kleingeschrieben werden soll. Dieser Parameter kann dementsprechend drei Werte annehmen:</p>
<ul>
<li>uppercas (alle Wörter groß schreiben)</li>
<li>lowercase (alle Wörter klein schreiben)</li>
<li>none (keine Änderung)</li>
</ul>
<p>Diese word cloud nutzt als Ressource die aktuellen Mitteilungen von <a href="http://blog.fefe.de">fefe</a>:</p>
<p>[wp-word-cloud source-type=&ldquo;url&rdquo; id=&ldquo;demo2&rdquo; count-words=1 min-word-occurence=1 min-word-length=3 size-factor=100 min-alpha=0.5 count-words=1]https://blog.fefe.de[/wp-word-cloud]</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> WordPress, Plugin, Word-Cloud, Projekt, Anleitung</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>development</category>
      
      <category>projekte</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>WordPress Word Cloud 2.0 - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>project_documentation</dc:type>
      
      
    </item><item>
      <title>CSS über den HTTP-Header ausspielen</title>
      <link>https://nickyreinert.de/2020/2020-06-04-css-ueber-den-http-header-ausspielen/</link>
      <pubDate>Thu, 04 Jun 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-06-04-css-ueber-den-http-header-ausspielen/</guid>
      <description>Jeder kennt das Problem: Man hat stundenlang an einem Stylesheet auf dem Staging-Server rumgebastelt, will es nun auf den Live-Server kopieren und die Änderung …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Ein kurzer technischer Tipp für Web-Entwickler, der zeigt, wie man eine CSS-Datei über den HTTP &#39;Link&#39;-Header lädt. Diese Methode kann genutzt werden, um eine Staging-Umgebung visuell von einer Live-Umgebung zu unterscheiden und so Verwechslungen zu vermeiden. Der Artikel enthält Konfigurationsbeispiele für Nginx und Apache.</p>
          
          
          <p><strong>Hauptthemen:</strong> CSS, HTTP, Web-Development, Server-Konfiguration, Nginx, Apache</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> intermediate</p>
          
        </div>
        
        
        <p>Jeder kennt das Problem: Man hat stundenlang an einem Stylesheet auf dem Staging-Server rumgebastelt, will es nun auf den Live-Server kopieren und die Änderung ist nicht sichtbar. Die Fehlersuche beginnt. Man prüft den Cache. Vom Browser. Vom Server. Ist man überhaupt auf dem richtigen Server? Hat der Upload geklappt? Und so weiter. Eric Meyer hat das ganze Dilemma 2009 treffend beschrieben und auch eine Lösung mitgeliefert, von der ich noch nicht gehört habe:</p>
<p>Nutze doch einfach die HTTP-Header um deine Staging- und Live-Umgebung eindeutig voneinander zu unterscheiden. Der Link-Parameter im HTTP-Header nämlich auch die Angabe von Style-Sheet-Dateien. Und das sieht dann so aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Header add Link &#34;&lt;/staging.css&gt;;rel=stylesheet;type=text/css;media=all&#34;
</span></span></code></pre></div><p>In nginx kann man das folgendermaßen im Server-Block implementieren:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">add_header Link &#34;&lt;/wp-content/themes/nickyreinert/style.header.css&gt;;rel=stylesheet;type=text/css;media=all&#34;;
</span></span></code></pre></div><p>Wer Apache nutzt, setzt den &ldquo;CSS-Header&rdquo; folgendermaßen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">Header add Link &#34;&lt;/wp-content/themes/nickyreinert/style.header.css&gt;;rel=stylesheet;type=text/css;media=all&#34;
</span></span></code></pre></div><p>Natürlich habe ich die Spielerei gleich bei mir eingebaut:</p>
<p><img src="/2020/2020-06-04-css-ueber-den-http-header-ausspielen/images/grafik-700x382.png" alt=""></p>
<p>CSS-Datei im HTTP-Header ausgeliefert</p>
<p>Damit lässt sich grundsätzlich auch das Stylesheet deines Wordpress-Themes ausliefern: Da WordPress aber die style.css nutzt, um Theme-Informationen zu verarbeiten, musst du auf dieses kleine Feature dann verzichten. Außerdem wird CSS im Link-Header nicht von jedem Browser unterstützt.</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> css, http</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>CSS über den HTTP-Header ausspielen - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>technical_tip</dc:type>
      
      
    </item><item>
      <title>How to create a maze algorithm with JavaScript</title>
      <link>https://nickyreinert.de/2020/2020-05-11-how-to-create-a-maze-algorithm-with-javascript/</link>
      <pubDate>Mon, 11 May 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-05-11-how-to-create-a-maze-algorithm-with-javascript/</guid>
      <description>Meine Herangehensweise, um ein Labyrinth in JavaScript zu bauen, ist weitaus ausführlicher auf Medium in Englisch veröffentlicht worden: …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Ein kurzer Verweis auf einen ausführlichen, englischsprachigen Artikel des Autors auf der Plattform Medium. Der verlinkte Artikel beschreibt, wie man einen Algorithmus zur Erstellung eines Labyrinths mit JavaScript entwickelt.</p>
          
          
          <p><strong>Hauptthemen:</strong> JavaScript, Algorithmen, Game-Development, Labyrinth</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> beginner</p>
          
        </div>
        
        
        <p>Meine Herangehensweise, um ein Labyrinth in JavaScript zu bauen, ist weitaus ausführlicher auf Medium in Englisch veröffentlicht worden:</p>
<p><a href="https://medium.com/swlh/how-to-create-a-maze-with-javascript-36f3ad8eebc1">https://medium.com/swlh/how-to-create-a-maze-with-javascript-36f3ad8eebc1</a></p>
<p><img src="/2020/2020-05-11-how-to-create-a-maze-algorithm-with-javascript/images/maze.png" alt=""></p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> anleitung, javascript, labyrinth</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>How to create a maze algorithm with JavaScript - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>link_post</dc:type>
      
      
    </item><item>
      <title>Wie erstelle ich ein Labyrinth mit JavaScript?</title>
      <link>https://nickyreinert.de/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/</link>
      <pubDate>Sat, 11 Apr 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/</guid>
      <description>Durch Zufall bin ich irgendwann mal auf diesen BASIC-Einzeiler gestoßen, mit dem sich eine Art Pseudo-Labyrinth erstellen lässt. Ich habe versucht, das in Plain …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine detaillierte Schritt-für-Schritt-Anleitung zur prozeduralen Erzeugung eines Labyrinths mit reinem JavaScript und HTML. Das Tutorial entwickelt iterativ einen Algorithmus, der von einem einfachen Pfad bis zu einer komplexen Lösung mit dem &#39;Recursive Backtracker&#39;-Ansatz führt, um ein lösbares Labyrinth mit Sackgassen zu generieren.</p>
          
          
          <p><strong>Hauptthemen:</strong> JavaScript, Algorithmen, Game-Development, Prozedurale Generierung, HTML DOM</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> intermediate</p>
          
        </div>
        
        
        <p>Durch Zufall bin ich irgendwann mal <a href="http://www.slate.com/articles/technology/books/2012/11/computer_programming_10_print_chr_205_5_rnd_1_goto_10_from_mit_press_reviewed.html">auf diesen BASIC-Einzeiler gestoßen</a>, mit dem sich eine Art Pseudo-Labyrinth erstellen lässt. Ich habe versucht, das <a href="https://htmlpreview.github.io/?https://github.com/nickyreinert/maze/blob/master/pseudo_maze.html">in Plain JavaScript</a> halbwegs kompakt nachzubauen. Dabei kann man kaum übersehen, dass es sich keineswegs um ein richtiges Labyrinth handelt, sondern eher um eine zufällige Anordnung von Strichen ohne Lösungsweg. Also habe ich mich gefragt, wie schwer es wohl sein kann, ein Labyrinth programmatisch und vor allem kompakt zu erzeugen. Dazu gibt es zwar <a href="https://en.wikipedia.org/wiki/Maze_generation_algorithm#Recursive_backtracker">eine Menge Lösungsansätze</a>, mein Ziel ist aber, die Herangehensweise zu beschreiben. Und da wir ja gerade alle zuhause abhängen, ist diese kleine Anleitung entstanden.</p>
<h2 id="vorbereitung">Vorbereitung</h2>
<p>Der aus meiner Sicht einfachste Ansatz ist es, eine Fläche mit schon gesetzten Wänden möglichst chaotisch zu durchpflügen. Wir brauchen also erstmal eine Fläche mit x * y Zellen, die jeweils mit Wänden voneinandern getrennt sind. In JavaScript sieht das folgendermaßen aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="n">function</span> <span class="n">createBlankMaze</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">var</span> <span class="n">rowIndex</span><span class="p">,</span> <span class="n">colIndex</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">var</span> <span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">&#34;table&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    <span class="k">var</span> <span class="n">tbody</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">&#34;tbody&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">rowIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">rowIndex</span> <span class="o">&lt;=</span> <span class="n">mazeHeight</span><span class="p">;</span> <span class="n">rowIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="k">var</span> <span class="n">row</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">&#34;tr&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">colIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">colIndex</span> <span class="o">&lt;=</span> <span class="n">mazeWidth</span><span class="p">;</span> <span class="n">colIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="k">var</span> <span class="n">col</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">createElement</span><span class="p">(</span><span class="s2">&#34;td&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">rowIndex</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">colIndex</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">                <span class="n">col</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="s2">&#34;rgb(244,0,0)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">                <span class="n">col</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s2">&#34;type&#34;</span><span class="p">,</span> <span class="s2">&#34;start&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rowIndex</span> <span class="o">==</span> <span class="n">mazeHeight</span> <span class="o">&amp;&amp;</span> <span class="n">colIndex</span> <span class="o">==</span> <span class="n">mazeWidth</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">                
</span></span><span class="line"><span class="ln">22</span><span class="cl">                <span class="n">col</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="s2">&#34;rgb(0,244,0)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">                <span class="n">col</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s2">&#34;type&#34;</span><span class="p">,</span> <span class="s2">&#34;finish&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">                <span class="n">col</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="s2">&#34;rgb(255,255,255)&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">            <span class="n">col</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">,</span> <span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="n">row</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">col</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="n">tbody</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">row</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">    
</span></span><span class="line"><span class="ln">40</span><span class="cl">    <span class="n">table</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">tbody</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">
</span></span><span class="line"><span class="ln">42</span><span class="cl">    <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;maze_container&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">appendChild</span><span class="p">(</span><span class="n">table</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Wir erzeugen also eine Tabelle mit 10 Zeilen und 10 Spalten und packen Sie am Ende in ein div mit der Id maze_container. Die &ldquo;Wände&rdquo; habe ich für jede Zelle mit CSS definiert:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">table td {
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">    border: 1px #000000 solid;
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">}
</span></span></code></pre></div><p>Der Eingang in rot befindet sich immer oben links, der Ausgang ist grün und unten rechts. Nun werden wir uns in einer Schleife vom Startfeld in Richtung Ziel bewegen. Mit jedem Schleifendurchlauf bewegen wir uns ein Feld weiter. Daraus entsteht erstmal ein Lösungsweg. Danach müssen natürlich noch die restlichen Felder bearbeitet werden. Dazu werden wir vom Lösungsweg aus Abzweige erzeugen. Los gehts.</p>
<h2 id="schritt-1-der-simpelste-lösungsweg">Schritt 1: Der simpelste Lösungsweg</h2>
<p>Um erstmal eine Schleife als Grundlage zu erhalten, beginnen wir mit einem sehr simplen Lösungsweg. Der geht ganz einfach 9 Felder nach rechts und 9 Felder nach unten. Wir nutzen dazu einfach eine Liste mit Anweisungen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">var</span> <span class="n">exits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">];</span>
</span></span></code></pre></div><p><em>(Warum nicht 10, sondern 9? Sobald wir uns auf dem letzen Feld befinden, müssen wir uns nicht weiter bewegen.)</em></p>
<p>In einer Schleife gehen wir nun diese Liste durch und bewegen unseren Zähler entsprechend eine Zelle nach rechts oder unten:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">var</span> <span class="n">currentCell</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">var</span> <span class="n">rowIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="k">var</span> <span class="n">colIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="n">exitIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">exitIndex</span> <span class="o">&lt;</span> <span class="n">exits</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">exitIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    <span class="k">switch</span><span class="p">(</span><span class="n">exits</span><span class="p">[</span><span class="n">exitIndex</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="k">case</span> <span class="s2">&#34;right&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">            <span class="n">colIndex</span> <span class="o">=</span> <span class="n">colIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">        <span class="k">case</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl">            <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl">    <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">    
</span></span><span class="line"><span class="ln">24</span><span class="cl">    <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="s2">&#34;#f00000&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Hier werden noch keine Wände entfernt, sondern erstmal nur der Weg nachgezeichnet, um eine Idee für den Algorithmus zu bekommen. Und so sieht das aus:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-3-700x701.png" alt=""></p>
<h2 id="schritt-2-einen-funken-abwechslung">Schritt 2: Einen Funken Abwechslung</h2>
<p>Ein wenig Abwechslung erhalten wir, wenn wir uns einfach abwechselnd nach unten und rechts bewegen. Dazu füllen wir die Liste mit den Ausgängen einfach in einer Schleife:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">var</span> <span class="n">exits</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="n">exit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">exit</span> <span class="o">&lt;=</span> <span class="n">mazeWidth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">exit</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">    <span class="n">exits</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&#34;right&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">    <span class="n">exits</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s2">&#34;bottom&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Das war es schon. Das Ergebnis sieht folgendermaßen aus:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-4-700x703.png" alt=""></p>
<h2 id="schritt-3-die-wände-einreißen">Schritt 3: Die Wände einreißen</h2>
<p>Nun sorgen wir dafür, dass tatsächlich ein Weg vom Start zum Ziel entsteht. Dazu werden einfach die Rahmen unten bzw. rechts entfernt, sobald wir uns in die entsprechende Richtung bewegen. Unsere Hauptschleife wird also etwas aufgebohrt.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">var</span>  <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_1_1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="n">exitIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">exitIndex</span> <span class="o">&lt;</span> <span class="n">exits</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">exitIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="n">exit</span> <span class="o">=</span> <span class="n">exits</span><span class="p">[</span><span class="n">exitIndex</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-&#34;</span><span class="o">+</span><span class="n">exit</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="k">switch</span><span class="p">(</span><span class="n">exit</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="k">case</span> <span class="s2">&#34;right&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">            <span class="n">colIndex</span> <span class="o">=</span> <span class="n">colIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">        <span class="k">case</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">            <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">    <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="s2">&#34;#f00000&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">    <span class="k">switch</span><span class="p">(</span><span class="n">exit</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">        <span class="k">case</span> <span class="s2">&#34;right&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">            <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-left&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl">        <span class="k">case</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl">        <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-top&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">40</span><span class="cl">    
</span></span><span class="line"><span class="ln">41</span><span class="cl">    <span class="n">lastExit</span> <span class="o">=</span> <span class="n">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">
</span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Noch bevor die Schleife startet, legen wir fest, in welcher Zelle wir uns befinden. Nur so können wir den Rahmen entsprechend unseres Ausgangs entfernen. Dazu wird einfach die CSS-Eigenschaft auf &ldquo;none&rdquo; gesetzt. Außerdem entfernen wir in der nächsten Zelle jeweils den gegenüberliegenden Rahmen. Wenn wir die vorherige Zelle also nach rechts verlassen haben, müssen wir in der darauffolgenden Zelle den Rahmen links entfernen.</p>
<p>Außerdem muss die Schleife für die Erstellung unserer Ausgänge angepasst werden:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">for (exit = 1; exit &lt; mazeWidth; exit++) {
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">    exits.push(&#34;right&#34;);
</span></span><span class="line"><span class="ln">4</span><span class="cl">    exits.push(&#34;bottom&#34;);
</span></span><span class="line"><span class="ln">5</span><span class="cl">
</span></span><span class="line"><span class="ln">6</span><span class="cl">}
</span></span></code></pre></div><p>Nun reichen uns nicht mehr nur 9 Schritte nach unten und rechts. Da wir nun für jedes Feld den unteren bzw. rechten Rahmen entfernen, müssen wir insgesamt 10 Felder in jede Richtung berücksichtigen. Das Ergebnis ist jetzt tatsächlich schon ein Irrgarten. Allerdings ein ziemlich einfacher:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-5-700x697.png" alt=""></p>
<h2 id="schritt-4-noch-mehr-abwechslung">Schritt 4: Noch mehr Abwechslung</h2>
<p>Der nächste Schritt ist naheliegend: Wir durchlaufen nicht einfach die Liste möglicher Ausgänge, sondern entscheiden zufällig, welcher Ausgang als nächstes kommt. Dazu muss die Schleifenbedinung allerdings etwas angepasst werden.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">for (loop = 0; loop &lt; (mazeWidth + mazeHeight - 2); loop++) {
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    exitIndex = Math.floor(Math.random() * exits.length);
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    exit = exits[exitIndex];
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    exits.splice(exitIndex, 1);
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    currentCell.style[&#34;border-&#34;+exit] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    switch(exit) {
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">        case &#34;right&#34;:
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">            colIndex = colIndex + 1;
</span></span><span class="line"><span class="ln">16</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">        case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">            rowIndex = rowIndex + 1;
</span></span><span class="line"><span class="ln">21</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    }
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">    currentCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">    currentCell.style.backgroundColor = &#34;#f00000&#34;;
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">    switch(exit) {
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">        case &#34;right&#34;:
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">            currentCell.style[&#34;border-left&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">34</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl">        case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">        currentCell.style[&#34;border-top&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">39</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl">    }
</span></span><span class="line"><span class="ln">42</span><span class="cl">    
</span></span><span class="line"><span class="ln">43</span><span class="cl">    lastExit = exit;
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl">}
</span></span></code></pre></div><p>Die ersten drei Zeilen innerhalb der Zeile sind hier von Bedeutung. Zuerst wird der nächste Ausgang per Zufall bestimmt und in der Variable exit abgelegt. Danach wird dieser Eintrag auch aus der Liste möglicher Ausgänge entfernt. Das ist wichtig, da wir uns ja z.B. nicht mehr als 10 mal nach rechts bewegen können. Außerdem erzeugen wir so eine Art Gewichtung, die sich bei jedem Durchlauf verändert. Würden wir einfach nur per Zufall zwischen <em>rechts</em> und <em>unten</em> entscheiden, wäre das Ergebnis im Moment vielleicht ähnlich. Aber sobald wir auch die Richtungen <em>oben</em> und <em>links</em> dazu nehmen, ist das Ergebnis weitaus chaotischer.</p>
<p>Das Ergebnis ist immer noch recht banal, aber sieht schon etwas mehr nach Labyrinth aus:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-6-700x695.png" alt=""></p>
<h2 id="schritt-5-mehr-bewegungsfreiheit">Schritt 5: Mehr Bewegungsfreiheit</h2>
<p>Bisher haben wir uns nur nach rechts und unten bewegt. Nun wollen wir uns auch nach links und oben bewegen. Dazu noch mal eine wichtige Grundannahme: Wir müssen uns 9 mal nach rechts und unten bewegen, um zum Ziel zu kommen. Erst wenn wir uns ein mal nach rechts bewegt haben, können wir uns dafür ein mal nach linsk bewegen. Das gleiche gilt für oben und unten. Da ich nun vier Bewegungsfreiheiten haben, muss die Schleifenbedingung erneut angepasst werden. Diesmal können wir ja theoretisch jedes der 100 Felder belegen. Außerdem muss ich nun zusätzliche Rahmen entfernen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">while (loop &lt; ((mazeWidth * mazeHeight) - 1)) {
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    exitIndex = Math.floor(Math.random() * exits.length);
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    exit = exits[exitIndex];
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    exits.splice(exitIndex, 1);
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    currentCell.style[&#34;border-&#34;+exit] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    switch(exit) {
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">        case &#34;right&#34;:
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">            colIndex = colIndex + 1;
</span></span><span class="line"><span class="ln">16</span><span class="cl">            exits.push(&#34;left&#34;);
</span></span><span class="line"><span class="ln">17</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">18</span><span class="cl">
</span></span><span class="line"><span class="ln">19</span><span class="cl">        case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">            rowIndex = rowIndex + 1;
</span></span><span class="line"><span class="ln">22</span><span class="cl">            exits.push(&#34;top&#34;);
</span></span><span class="line"><span class="ln">23</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">        case &#34;left&#34;:
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">            colIndex = colIndex - 1;
</span></span><span class="line"><span class="ln">28</span><span class="cl">            exits.push(&#34;right&#34;);
</span></span><span class="line"><span class="ln">29</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">        case &#34;top&#34;:
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">            rowIndex = rowIndex - 1;
</span></span><span class="line"><span class="ln">34</span><span class="cl">            exits.push(&#34;bottom&#34;);
</span></span><span class="line"><span class="ln">35</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">36</span><span class="cl">            
</span></span><span class="line"><span class="ln">37</span><span class="cl">    }
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">    currentCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl">    currentCell.style.backgroundColor = &#34;#f00000&#34;;
</span></span><span class="line"><span class="ln">42</span><span class="cl">
</span></span><span class="line"><span class="ln">43</span><span class="cl">    switch(exit) {
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl">        case &#34;right&#34;:
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">            currentCell.style[&#34;border-left&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">48</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">49</span><span class="cl">
</span></span><span class="line"><span class="ln">50</span><span class="cl">        case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln">51</span><span class="cl">
</span></span><span class="line"><span class="ln">52</span><span class="cl">        currentCell.style[&#34;border-top&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">53</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">54</span><span class="cl">
</span></span><span class="line"><span class="ln">55</span><span class="cl">        case &#34;left&#34;:
</span></span><span class="line"><span class="ln">56</span><span class="cl">
</span></span><span class="line"><span class="ln">57</span><span class="cl">            currentCell.style[&#34;border-right&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">58</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">59</span><span class="cl">
</span></span><span class="line"><span class="ln">60</span><span class="cl">        case &#34;top&#34;:
</span></span><span class="line"><span class="ln">61</span><span class="cl">
</span></span><span class="line"><span class="ln">62</span><span class="cl">            currentCell.style[&#34;border-bottom&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">63</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">64</span><span class="cl">
</span></span><span class="line"><span class="ln">65</span><span class="cl">    }
</span></span><span class="line"><span class="ln">66</span><span class="cl">    
</span></span><span class="line"><span class="ln">67</span><span class="cl">    lastExit = exit;
</span></span><span class="line"><span class="ln">68</span><span class="cl">
</span></span><span class="line"><span class="ln">69</span><span class="cl">    loop++;
</span></span><span class="line"><span class="ln">70</span><span class="cl">
</span></span><span class="line"><span class="ln">71</span><span class="cl">}
</span></span></code></pre></div><p>In der ersten _Switch-_Anweisung gibt es außerdem eine wichtige Anweisung. Wenn der nächste Ausgang nach rechts geht, ergänze ich die Liste möglicher Ausgänge um einen Ausgang nach links (analog natürlich für die anderen Richtungen):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">exits.push(&#34;left&#34;);
</span></span></code></pre></div><p>Und wie sieht das Ergebnis aus?</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-8-700x703.png" alt=""></p>
<p>Ich würde sagen: Bescheiden. Das Problem ist, dass wir uns nach links bewegen, nachdem wir uns gerade erst nach rechts bewegt haben. Genauso dürfen wir uns nicht nach oben und gleich danach wieder nach unten bewegen.<br>
Wir müssen also etwas nachbessern. Wenn wir uns nun in z.B. der Zelle mit den Koordinaten x = 4 und y = 4 befinden, prüfen wir, ob die drei benachbarten Zellen bereits belegt sind (Hintergrundfarbe ist rot). Ist z.B. die rechte Nachbarzelle belegt, dürfen wir uns nicht nach rechts bewegen.<br>
Auch die Liste möglicher Ausgänge wird etwas anders organisiert:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">1</span><span class="cl"><span class="k">var</span> <span class="n">validExits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;left&#34;</span><span class="p">,</span> <span class="s2">&#34;top&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="k">var</span> <span class="n">remainingExits</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;right&#34;</span><span class="p">:</span> <span class="n">mazeWidth</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span> <span class="n">mazeHeight</span><span class="p">,</span> <span class="s2">&#34;left&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;top&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">};</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl"><span class="k">var</span> <span class="n">nextExits</span> <span class="o">=</span> <span class="p">[];</span>
</span></span></code></pre></div><p>Das Array <em>validExits</em> ist eine globale, nicht veränderbare Liste aller möglichen Ausgänge. Mit <em>remainingExits</em> führen wir ein Objekt ein, dass die Anzahl möglicher bzw. erforderlicher Ausgänge protokolliert. Und <em>nextExits</em> ist das Array, das bei jedem Schleifendurchlauf die möglichen Ausgänge anzeigt. Die überarbeitete Schleife sieht nun so aus:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">  1</span><span class="cl">while (loop &lt; ((mazeWidth * mazeHeight) - 1)) {
</span></span><span class="line"><span class="ln">  2</span><span class="cl">
</span></span><span class="line"><span class="ln">  3</span><span class="cl">    nextExits = [];
</span></span><span class="line"><span class="ln">  4</span><span class="cl">
</span></span><span class="line"><span class="ln">  5</span><span class="cl">    for (i = 0; i &lt; validExits.length; i++) {
</span></span><span class="line"><span class="ln">  6</span><span class="cl">
</span></span><span class="line"><span class="ln">  7</span><span class="cl">        switch(validExits[i]) {
</span></span><span class="line"><span class="ln">  8</span><span class="cl">
</span></span><span class="line"><span class="ln">  9</span><span class="cl">            case &#34;right&#34;:
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">                nextPossibleCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + (colIndex + 1));
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">                break;
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">            case &#34;left&#34;:
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">                nextPossibleCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + (colIndex - 1));
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">                break;
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">            case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">                nextPossibleCell = document.getElementById(&#34;cell_&#34; + (rowIndex + 1) + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">                break;
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">            case &#34;top&#34;:
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">                nextPossibleCell = document.getElementById(&#34;cell_&#34; + (rowIndex - 1) + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">                break;
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">        }
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">        if (nextPossibleCell == null || nextPossibleCell.style.backgroundColor != &#34;rgb(240, 0, 0)&#34;) {
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">            
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">            for (t = 0; t &lt; remainingExits[validExits[i]]; t++) {
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">                nextExits.push(validExits[i]);
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">            }
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">        } 
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">    }
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">    exitIndex = Math.floor(Math.random() * nextExits.length);
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">    exit = nextExits[exitIndex];
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">    currentCell.style[&#34;border-&#34;+exit] = &#34;none&#34;;
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">    switch(exit) {
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">        case &#34;right&#34;:
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">            colIndex = colIndex + 1;
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">            remainingExits.left++;
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">            remainingExits.right--;
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">        case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">            rowIndex = rowIndex + 1;
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">            remainingExits.top++;
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">            remainingExits.bottom--;
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">        case &#34;left&#34;:
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">            colIndex = colIndex - 1;
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">            remainingExits.left--;
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">            remainingExits.right++;
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">        case &#34;top&#34;:
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">            rowIndex = rowIndex - 1;
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">            remainingExits.top--;
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">            remainingExits.bottom++;
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">            
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">    }
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">    currentCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">    switch(exit) {
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">        case &#34;right&#34;:
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">            currentCell.style[&#34;border-left&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">        case &#34;bottom&#34;:
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">            currentCell.style[&#34;border-top&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">        case &#34;left&#34;:
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">            currentCell.style[&#34;border-right&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">            break;
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">        case &#34;top&#34;:
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">            currentCell.style[&#34;border-bottom&#34;] = &#34;none&#34;;
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">            break;
</span></span><span class="line"><span class="ln">100</span><span class="cl">
</span></span><span class="line"><span class="ln">101</span><span class="cl">    }
</span></span><span class="line"><span class="ln">102</span><span class="cl">    if (rowIndex == mazeHeight &amp;&amp; colIndex == mazeWidth) {
</span></span><span class="line"><span class="ln">103</span><span class="cl">
</span></span><span class="line"><span class="ln">104</span><span class="cl">        break;
</span></span><span class="line"><span class="ln">105</span><span class="cl">
</span></span><span class="line"><span class="ln">106</span><span class="cl">    }
</span></span><span class="line"><span class="ln">107</span><span class="cl">
</span></span><span class="line"><span class="ln">108</span><span class="cl">    currentCell.style.backgroundColor = &#34;#f00000&#34;;
</span></span><span class="line"><span class="ln">109</span><span class="cl">
</span></span><span class="line"><span class="ln">110</span><span class="cl">    lastExit = exit;
</span></span><span class="line"><span class="ln">111</span><span class="cl">
</span></span><span class="line"><span class="ln">112</span><span class="cl">    loop++;
</span></span><span class="line"><span class="ln">113</span><span class="cl">
</span></span><span class="line"><span class="ln">114</span><span class="cl">}
</span></span></code></pre></div><p>Hier wede ich noch mal ein paar Besonderheiten erläutern: Gleich zu Beginn der Schleife durchlaufen wir alle gültigen Ausgänge um so zu den nächsten möglichen Zellen zu kommen (<em>nextPossibleCell</em>). Nur wenn diese Zelle überhaupt existiert (wir uns also nicht am Rand des Irrgarten befinden) und nicht belegt ist (Hintergrundfarbe ist nicht rot), kann die entsprechende Bewegungsrichtung verwendet werden:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[...]
</span></span><span class="line"><span class="ln">2</span><span class="cl">nextExits.push(validExits[i]);
</span></span><span class="line"><span class="ln">3</span><span class="cl">[...]
</span></span></code></pre></div><p>Danach folgt wieder die Zufallsbestimmung des nächsten Ausgangs. Die Protokollierung der restlichen Ausgänge erfolgt nun etwas anders, am Beispiel von Ausgang &ldquo;<em>rechts</em>&rdquo;:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[...]
</span></span><span class="line"><span class="ln">2</span><span class="cl">remainingExits.left++;
</span></span><span class="line"><span class="ln">3</span><span class="cl">remainingExits.right--;
</span></span><span class="line"><span class="ln">4</span><span class="cl">[...]
</span></span></code></pre></div><p>Der Rest der Schleife bleibt unverändert. Und tatsächlich: Der Irrgarten sieht weitaus schöner aus:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-9-700x705.png" alt=""></p>
<p>Allerdings fehlt immer noch eine offensichtliche Kleinigkeit: Wir erreichen das Ziel nicht.</p>
<h2 id="schritt-6-das-sackgassenproblem">Schritt 6: Das Sackgassenproblem</h2>
<p>Wir erzeugen eine Sackgasse. Der Weg aus der Sackgasse sieht folgendermaßen aus: Wir müssen uns zurück bewegen. Bei jeder Zelle prüfen wir die möglichen Ausgänge und nehmen einfach einen anderen. Die bereits belegten Zellen bleiben weiterhin belegt.</p>
<p>Da wir nun in den Schleifenablauf eingreifen, führen wir eine Sicherung ein. So vermeiden wir, dass die Schleife z.B. unendlich läuft.</p>
<p>Außerdem führen wir ein weiteres Array <em>lastExits</em> ein, dass den aktuellen Weg protokolliert (das nennt sich übrigens <em><a href="https://en.wikipedia.org/wiki/Maze_generation_algorithm#Recursive_backtracker">recursive backtracker algorithmus</a>)</em> Gleich der Beginn der Schleife prüft nun erstmal unser Sicherungsnetz:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">while (loop &lt; ((mazeWidth * mazeHeight) - 1)) {
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">    loopFuse++;
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">    if (loopFuse &gt;= maxLoops) {break;}
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl">    [...]
</span></span></code></pre></div><p>Danach prüfen wir wie gehabt, welche Ausgänge noch nicht belegt sind. Und dann, bevor wir per Zufall den nächsten Ausgang bestimmen, bauen wir unsere Sackgassen-Schutz-Funktion ein:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">[...]
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">if (nextExits.length == 0) {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    lastCells.splice(lastCells.length - 1, 1);
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    console.log(&#34;Sackgasse. Einen Schritt zurück:&#34;);
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    rowIndex = lastCells[lastCells.length - 1][0];
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    colIndex = lastCells[lastCells.length - 1][1];
</span></span><span class="line"><span class="ln">10</span><span class="cl">    currentCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">    continue;
</span></span><span class="line"><span class="ln">13</span><span class="cl">    
</span></span><span class="line"><span class="ln">14</span><span class="cl">}
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">exitIndex = Math.floor(Math.random() * nextExits.length);
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">[...]
</span></span></code></pre></div><p>Wenn wir uns in einer Sackgasse befinden, entfernen wir einfach die letzte Zelle aus <em>lastCells</em> und setzen den Zeige auf die Zelle davor. Dann verlassen wir den Schleifendurchlauf mit <em>continue.</em> Weiter unten müssen wir natürlich auch dafür sorgen, dass die jeweils aktuelle Zelle zu <em>lastCells</em> hinzugefügt wird:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[...]
</span></span><span class="line"><span class="ln">2</span><span class="cl">lastCells.push([rowIndex, colIndex]);
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">currentCell = document.getElementById(&#34;cell_&#34; + rowIndex + &#34;_&#34; + colIndex);
</span></span><span class="line"><span class="ln">5</span><span class="cl">
</span></span><span class="line"><span class="ln">6</span><span class="cl">[...]
</span></span></code></pre></div><p>Ganz am Ende der Schleife prüfen wir außerdem noch, ob wir uns vielleicht schon am Ziel befinden, um dann die Schleife zu verlassen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln"> 1</span><span class="cl">    [...]
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    if (rowIndex == mazeHeight &amp;&amp; colIndex == mazeWidth) {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        break;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    }
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    currentCell.style.backgroundColor = &#34;#f00000&#34;;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    loop++;
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">}
</span></span></code></pre></div><p>Das Ergebnis überzeugt: Wir erzeugen nun einen verzweigten Weg, der nicht nur nach rechts und unten geht, sondern sogar Sackgassen enthält:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-10-700x704.png" alt=""></p>
<h2 id="schritt-7-noch-mehr-sackgassen">Schritt 7: Noch mehr Sackgassen!</h2>
<p>Wie bekommen wir noch mehr Sackgassen in unser Labyrinth? Indem wir die echte Route abgehen und einfach von jeder Zelle aus eine neue Route starten? Ja. Das war auch mein erster Gedanke. Allerdings ist die aktuelle Zielroute oft von Sackgassen umgeben. Wenn wir diesen Weg wählen, könnten also weiterhin einige Felder unbearbeitet bleiben. Deshalb werden wir ziemlich schroff einfach jedes belegte Feld als Startpunkt für einen Abzweig nutzen. Das Erzeugen der Abzweigungen kommt natürlich ohne die Sackgassen-Schutz-Funktion aus.</p>
<p>Dazu müssen wir erstmal die aktuelle Logik in eine Funktion packen, die jetzt drei Parameter erwartet:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">startAtRow = 1;
</span></span><span class="line"><span class="ln">2</span><span class="cl">startAtCol = 1;
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">addRoute(startARow, statrtAtCol, false);
</span></span></code></pre></div><p>Die Funktion <em>addRoute</em> sieht folgendermaßen aus. <em>False</em> bedeutet also, dass wir keinen Abzeig sondern erstmal die korrekte Route zum Ziel erzeugen wollen.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln">  1</span><span class="cl"><span class="n">function</span> <span class="n">addRoute</span><span class="p">(</span><span class="n">startAtRow</span><span class="p">,</span> <span class="n">startAtCol</span><span class="p">,</span> <span class="n">createDetour</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">  2</span><span class="cl">
</span></span><span class="line"><span class="ln">  3</span><span class="cl">    <span class="k">var</span> <span class="n">validExits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;right&#34;</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">,</span> <span class="s2">&#34;left&#34;</span><span class="p">,</span> <span class="s2">&#34;top&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">  4</span><span class="cl">    <span class="k">var</span> <span class="n">remainingExits</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;right&#34;</span><span class="p">:</span> <span class="n">mazeWidth</span><span class="p">,</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span> <span class="n">mazeHeight</span><span class="p">,</span> <span class="s2">&#34;left&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&#34;top&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">};</span>
</span></span><span class="line"><span class="ln">  5</span><span class="cl">    <span class="k">var</span> <span class="n">nextExits</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln">  6</span><span class="cl">    <span class="k">var</span> <span class="n">lastCells</span><span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln">  7</span><span class="cl">
</span></span><span class="line"><span class="ln">  8</span><span class="cl">    <span class="k">var</span> <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">startAtRow</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">  9</span><span class="cl">    <span class="k">var</span> <span class="n">colIndex</span> <span class="o">=</span> <span class="n">startAtCol</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 10</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 11</span><span class="cl">    <span class="k">var</span> <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 12</span><span class="cl">
</span></span><span class="line"><span class="ln"> 13</span><span class="cl">    <span class="k">var</span> <span class="n">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 14</span><span class="cl">
</span></span><span class="line"><span class="ln"> 15</span><span class="cl">    <span class="k">var</span> <span class="n">lastExit</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 16</span><span class="cl">
</span></span><span class="line"><span class="ln"> 17</span><span class="cl">    <span class="k">var</span> <span class="n">exitIndex</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 18</span><span class="cl">
</span></span><span class="line"><span class="ln"> 19</span><span class="cl">    <span class="k">var</span> <span class="n">loop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 20</span><span class="cl">    <span class="k">var</span> <span class="n">loopFuse</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 21</span><span class="cl">    <span class="k">var</span> <span class="n">maxLoops</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">mazeWidth</span> <span class="o">*</span> <span class="n">mazeHeight</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 22</span><span class="cl">
</span></span><span class="line"><span class="ln"> 23</span><span class="cl">    <span class="k">var</span> <span class="n">nextPossibleCell</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 24</span><span class="cl">
</span></span><span class="line"><span class="ln"> 25</span><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">loop</span> <span class="o">&lt;</span> <span class="p">((</span><span class="n">mazeWidth</span> <span class="o">*</span> <span class="n">mazeHeight</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 26</span><span class="cl">
</span></span><span class="line"><span class="ln"> 27</span><span class="cl">        <span class="n">loopFuse</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 28</span><span class="cl">
</span></span><span class="line"><span class="ln"> 29</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">loopFuse</span> <span class="o">&gt;=</span> <span class="n">maxLoops</span><span class="p">)</span> <span class="p">{</span><span class="k">break</span><span class="p">;}</span>
</span></span><span class="line"><span class="ln"> 30</span><span class="cl">
</span></span><span class="line"><span class="ln"> 31</span><span class="cl">        <span class="n">nextExits</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="ln"> 32</span><span class="cl">
</span></span><span class="line"><span class="ln"> 33</span><span class="cl">        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">validExits</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 34</span><span class="cl">
</span></span><span class="line"><span class="ln"> 35</span><span class="cl">            <span class="k">switch</span><span class="p">(</span><span class="n">validExits</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 36</span><span class="cl">
</span></span><span class="line"><span class="ln"> 37</span><span class="cl">                <span class="k">case</span> <span class="s2">&#34;right&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 38</span><span class="cl">                    <span class="n">nextPossibleCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="p">(</span><span class="n">colIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="ln"> 39</span><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 40</span><span class="cl">
</span></span><span class="line"><span class="ln"> 41</span><span class="cl">                <span class="k">case</span> <span class="s2">&#34;left&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 42</span><span class="cl">                    <span class="n">nextPossibleCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="p">(</span><span class="n">colIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>
</span></span><span class="line"><span class="ln"> 43</span><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 44</span><span class="cl">
</span></span><span class="line"><span class="ln"> 45</span><span class="cl">                <span class="k">case</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 46</span><span class="cl">                    <span class="n">nextPossibleCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="p">(</span><span class="n">rowIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 47</span><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 48</span><span class="cl">
</span></span><span class="line"><span class="ln"> 49</span><span class="cl">                <span class="k">case</span> <span class="s2">&#34;top&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln"> 50</span><span class="cl">                    <span class="n">nextPossibleCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="p">(</span><span class="n">rowIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 51</span><span class="cl">                    <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 52</span><span class="cl">
</span></span><span class="line"><span class="ln"> 53</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 54</span><span class="cl">            
</span></span><span class="line"><span class="ln"> 55</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">nextPossibleCell</span> <span class="o">!=</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 56</span><span class="cl">
</span></span><span class="line"><span class="ln"> 57</span><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">nextPossibleCell</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s2">&#34;occupied&#34;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&#34;true&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 58</span><span class="cl">                    
</span></span><span class="line"><span class="ln"> 59</span><span class="cl">                    <span class="k">for</span> <span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">remainingExits</span><span class="p">[</span><span class="n">validExits</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span> <span class="n">t</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 60</span><span class="cl">
</span></span><span class="line"><span class="ln"> 61</span><span class="cl">                        <span class="n">nextExits</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">validExits</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln"> 62</span><span class="cl">
</span></span><span class="line"><span class="ln"> 63</span><span class="cl">                    <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 64</span><span class="cl">
</span></span><span class="line"><span class="ln"> 65</span><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 66</span><span class="cl">
</span></span><span class="line"><span class="ln"> 67</span><span class="cl">            <span class="p">}</span> 
</span></span><span class="line"><span class="ln"> 68</span><span class="cl">
</span></span><span class="line"><span class="ln"> 69</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 70</span><span class="cl">
</span></span><span class="line"><span class="ln"> 71</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">nextExits</span><span class="o">.</span><span class="n">length</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 72</span><span class="cl">
</span></span><span class="line"><span class="ln"> 73</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="n">createDetour</span> <span class="o">==</span> <span class="bp">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 74</span><span class="cl">
</span></span><span class="line"><span class="ln"> 75</span><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">colIndex</span> <span class="o">==</span> <span class="n">mazeWidth</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 76</span><span class="cl">                    <span class="n">rowIndex</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 77</span><span class="cl">                    <span class="n">colIndex</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 78</span><span class="cl">                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 79</span><span class="cl">                    <span class="n">colIndex</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 80</span><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 81</span><span class="cl">
</span></span><span class="line"><span class="ln"> 82</span><span class="cl">                <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 83</span><span class="cl">
</span></span><span class="line"><span class="ln"> 84</span><span class="cl">                <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 85</span><span class="cl">
</span></span><span class="line"><span class="ln"> 86</span><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 87</span><span class="cl">                
</span></span><span class="line"><span class="ln"> 88</span><span class="cl">                <span class="n">lastCells</span><span class="o">.</span><span class="n">splice</span><span class="p">(</span><span class="n">lastCells</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 89</span><span class="cl">
</span></span><span class="line"><span class="ln"> 90</span><span class="cl">                <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">lastCells</span><span class="p">[</span><span class="n">lastCells</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 91</span><span class="cl">                <span class="n">colIndex</span> <span class="o">=</span> <span class="n">lastCells</span><span class="p">[</span><span class="n">lastCells</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="ln"> 92</span><span class="cl">                <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 93</span><span class="cl">
</span></span><span class="line"><span class="ln"> 94</span><span class="cl">                <span class="k">continue</span><span class="p">;</span>
</span></span><span class="line"><span class="ln"> 95</span><span class="cl">            
</span></span><span class="line"><span class="ln"> 96</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln"> 97</span><span class="cl">
</span></span><span class="line"><span class="ln"> 98</span><span class="cl">        <span class="p">}</span> 
</span></span><span class="line"><span class="ln"> 99</span><span class="cl">
</span></span><span class="line"><span class="ln">100</span><span class="cl">        <span class="n">exitIndex</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">Math</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">*</span> <span class="n">nextExits</span><span class="o">.</span><span class="n">length</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">101</span><span class="cl">
</span></span><span class="line"><span class="ln">102</span><span class="cl">        <span class="n">exit</span> <span class="o">=</span> <span class="n">nextExits</span><span class="p">[</span><span class="n">exitIndex</span><span class="p">];</span>
</span></span><span class="line"><span class="ln">103</span><span class="cl">
</span></span><span class="line"><span class="ln">104</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">createDetour</span> <span class="o">==</span> <span class="bp">false</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">105</span><span class="cl">
</span></span><span class="line"><span class="ln">106</span><span class="cl">            <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-&#34;</span><span class="o">+</span><span class="n">exit</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">107</span><span class="cl">
</span></span><span class="line"><span class="ln">108</span><span class="cl">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">109</span><span class="cl">
</span></span><span class="line"><span class="ln">110</span><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">exit</span> <span class="o">==</span> <span class="s2">&#34;right&#34;</span> <span class="o">&amp;&amp;</span> <span class="n">colIndex</span> <span class="o">==</span> <span class="n">mazeWidth</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">rowIndex</span> <span class="o">==</span> <span class="n">mazeHeight</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="ln">111</span><span class="cl">                <span class="o">!</span><span class="p">(</span><span class="n">exit</span> <span class="o">==</span> <span class="s2">&#34;bottom&#34;</span> <span class="o">&amp;&amp;</span> <span class="n">colIndex</span> <span class="o">==</span> <span class="n">mazeWidth</span> <span class="o">&amp;&amp;</span> <span class="n">rowIndex</span> <span class="o">==</span> <span class="n">mazeHeight</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">112</span><span class="cl">
</span></span><span class="line"><span class="ln">113</span><span class="cl">                <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-&#34;</span><span class="o">+</span><span class="n">exit</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">114</span><span class="cl">
</span></span><span class="line"><span class="ln">115</span><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="ln">116</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">117</span><span class="cl">        
</span></span><span class="line"><span class="ln">118</span><span class="cl">        <span class="k">switch</span><span class="p">(</span><span class="n">exit</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">119</span><span class="cl">
</span></span><span class="line"><span class="ln">120</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;right&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">121</span><span class="cl">
</span></span><span class="line"><span class="ln">122</span><span class="cl">                <span class="n">colIndex</span> <span class="o">=</span> <span class="n">colIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">123</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">left</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">124</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">right</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">125</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">126</span><span class="cl">
</span></span><span class="line"><span class="ln">127</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">128</span><span class="cl">
</span></span><span class="line"><span class="ln">129</span><span class="cl">                <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">130</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">top</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">131</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">bottom</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">132</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">133</span><span class="cl">
</span></span><span class="line"><span class="ln">134</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;left&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">135</span><span class="cl">
</span></span><span class="line"><span class="ln">136</span><span class="cl">                <span class="n">colIndex</span> <span class="o">=</span> <span class="n">colIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">137</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">left</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">138</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">right</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">139</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">140</span><span class="cl">
</span></span><span class="line"><span class="ln">141</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;top&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">142</span><span class="cl">
</span></span><span class="line"><span class="ln">143</span><span class="cl">                <span class="n">rowIndex</span> <span class="o">=</span> <span class="n">rowIndex</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">144</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">top</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">145</span><span class="cl">                <span class="n">remainingExits</span><span class="o">.</span><span class="n">bottom</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">146</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">147</span><span class="cl">                
</span></span><span class="line"><span class="ln">148</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">149</span><span class="cl">
</span></span><span class="line"><span class="ln">150</span><span class="cl">        <span class="n">lastCells</span><span class="o">.</span><span class="n">push</span><span class="p">([</span><span class="n">rowIndex</span><span class="p">,</span> <span class="n">colIndex</span><span class="p">]);</span>
</span></span><span class="line"><span class="ln">151</span><span class="cl">
</span></span><span class="line"><span class="ln">152</span><span class="cl">        <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">rowIndex</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">colIndex</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">153</span><span class="cl">
</span></span><span class="line"><span class="ln">154</span><span class="cl">        <span class="k">switch</span><span class="p">(</span><span class="n">exit</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">155</span><span class="cl">
</span></span><span class="line"><span class="ln">156</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;right&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">157</span><span class="cl">
</span></span><span class="line"><span class="ln">158</span><span class="cl">                <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-left&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">159</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">160</span><span class="cl">
</span></span><span class="line"><span class="ln">161</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;bottom&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">162</span><span class="cl">
</span></span><span class="line"><span class="ln">163</span><span class="cl">                <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-top&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">164</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">165</span><span class="cl">
</span></span><span class="line"><span class="ln">166</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;left&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">167</span><span class="cl">
</span></span><span class="line"><span class="ln">168</span><span class="cl">                <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-right&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">169</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">170</span><span class="cl">
</span></span><span class="line"><span class="ln">171</span><span class="cl">            <span class="k">case</span> <span class="s2">&#34;top&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">172</span><span class="cl">
</span></span><span class="line"><span class="ln">173</span><span class="cl">                <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&#34;border-bottom&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;none&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">174</span><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">175</span><span class="cl">
</span></span><span class="line"><span class="ln">176</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">177</span><span class="cl">
</span></span><span class="line"><span class="ln">178</span><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">rowIndex</span> <span class="o">==</span> <span class="n">mazeHeight</span> <span class="o">&amp;&amp;</span> <span class="n">colIndex</span> <span class="o">==</span> <span class="n">mazeWidth</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">179</span><span class="cl">
</span></span><span class="line"><span class="ln">180</span><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">181</span><span class="cl">
</span></span><span class="line"><span class="ln">182</span><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="ln">183</span><span class="cl">
</span></span><span class="line"><span class="ln">184</span><span class="cl">        <span class="n">currentCell</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="n">backgroundColorRoute</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">185</span><span class="cl">        <span class="n">currentCell</span><span class="o">.</span><span class="n">setAttribute</span><span class="p">(</span><span class="s2">&#34;occupied&#34;</span><span class="p">,</span> <span class="s2">&#34;true&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="ln">186</span><span class="cl">
</span></span><span class="line"><span class="ln">187</span><span class="cl">        <span class="n">lastExit</span> <span class="o">=</span> <span class="n">exit</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">188</span><span class="cl">
</span></span><span class="line"><span class="ln">189</span><span class="cl">        <span class="n">loop</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">190</span><span class="cl">
</span></span><span class="line"><span class="ln">191</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">192</span><span class="cl">
</span></span><span class="line"><span class="ln">193</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>An der Funktionalität hat sich hier nicht viel geändert: Wir prüfen zuerst, welche Ausgänge von der aktuellen Zelle aus möglich sind. Direkt danach allerdings müssen wir, wenn es keine weiteren Ausgänge gibt, die Funktion verlassen - wir wollen ja diesmal explizit Sackgassen erzeugen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">if (createDetour == true) {
</span></span><span class="line"><span class="ln">2</span><span class="cl">  return false;
</span></span><span class="line"><span class="ln">3</span><span class="cl">[...]
</span></span></code></pre></div><p>Weiter unten gibt es eine weitere Besonderheit: Wenn wir den Abzweig erzeugen, darf dieser natürlich nicht &ldquo;aus Versehen&rdquo; zum Ziel führen. Wir prüfen also, ob wir uns direkt neben der Zielzelle befinden. In dem Fall wird der Rahmen nicht entfernt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[...]
</span></span><span class="line"><span class="ln">2</span><span class="cl">if (!(exit == &#34;right&#34; &amp;&amp; colIndex == mazeWidth - 1 &amp;&amp; rowIndex == mazeHeight) &amp;&amp;
</span></span><span class="line"><span class="ln">3</span><span class="cl">    !(exit == &#34;bottom&#34; &amp;&amp; colIndex == mazeWidth &amp;&amp; rowIndex == mazeHeight - 1) ) {
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl">    currentCell.style[&#34;border-&#34;+exit] = &#34;none&#34;;
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl">}
</span></span><span class="line"><span class="ln">8</span><span class="cl">[...]
</span></span></code></pre></div><p>Ganz am Ende der Schleife wird außerdem das Attribut <em>occupied</em> der Zelle auf <em>true</em> gesetzt. So müssen wir nicht mehr mit der Hintergrundfarbe arbeiten, um belegte Zellen zu erkennen:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="ln">1</span><span class="cl">[...]
</span></span><span class="line"><span class="ln">2</span><span class="cl">currentCell.setAttribute(&#34;occupied&#34;, &#34;true&#34;);
</span></span><span class="line"><span class="ln">3</span><span class="cl">[...]
</span></span></code></pre></div><p>Nun kommen wir zum Erzeugen der Abzweige. Wie schon angekündigt, durchlaufen wir einfach die Zellen, die bereits belegt (<em>occupied == true)</em> sind, um von dort aus unsere bewährte Routenerstellung - jedoch ohne Sackgassen-Schutz-Funktion, zu starten:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">mazeWidth</span> <span class="o">*</span> <span class="n">mazeHeight</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    <span class="k">var</span> <span class="n">currentCell</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getElementById</span><span class="p">(</span><span class="s2">&#34;cell_&#34;</span> <span class="o">+</span> <span class="n">startAtRow</span> <span class="o">+</span> <span class="s2">&#34;_&#34;</span> <span class="o">+</span> <span class="n">startAtCol</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">currentCell</span><span class="o">.</span><span class="n">getAttribute</span><span class="p">(</span><span class="s2">&#34;occupied&#34;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&#34;true&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        <span class="n">addRoute</span><span class="p">(</span><span class="n">startAtRow</span><span class="p">,</span> <span class="n">startAtCol</span><span class="p">,</span> <span class="bp">true</span><span class="p">);</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">startAtCol</span> <span class="o">==</span> <span class="n">mazeWidth</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">        
</span></span><span class="line"><span class="ln">13</span><span class="cl">        <span class="n">startAtRow</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">        <span class="n">startAtCol</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">        <span class="n">startAtCol</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Et voila: Ein Irrgarten:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-12-700x696.png" alt=""></p>
<p>Und auch wenn der Algorithmus teilweise etwas stumpf gestaltet ist, kann sich die Performance sehen lassen. Ein Labyrinth mit der Kantenlänge 100 x 100 dauert nur wenige Sekunden:</p>
<p><img src="/2020/2020-04-11-wie-erstelle-ich-ein-labyrinth-mit-javascript/images/grafik-13-700x699.png" alt=""></p>
<p>Natürlich gibt es an der einen oder anderen Stelle noch Optimierungspotential. Ich hab die ganze Logik noch mit einer Navigation und einer Stopp-Uhr ausgestattet. So sieht das ganze dann als Zeitvertreib für die Quarantäne aus: <a href="https://nickyreinert.github.io/maze/">https://nickyreinert.github.io/maze/</a></p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> anleitung, javascript, labyrinth</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Wie erstelle ich ein Labyrinth mit JavaScript? - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>tutorial</dc:type>
      
      
    </item><item>
      <title>Sonys Xperia Modellchaos</title>
      <link>https://nickyreinert.de/2020/2020-02-24-sonys-xperia-modellchaos/</link>
      <pubDate>Mon, 24 Feb 2020 00:00:00 +0000</pubDate>
      <author></author>
      <guid>https://nickyreinert.de/2020/2020-02-24-sonys-xperia-modellchaos/</guid>
      <description>Ich mag meine Differenzen mit Sony haben, aber trotzdem bin ich nach wie vor großer Fan der Smartphone-Serie von Sony: Xperia. Sony hat sich bisher immer ein …</description>
      
      
      <content:encoded>&lt;![CDATA[
        
        <div class="ai-summary">
          <h3>AI-Zusammenfassung</h3>
          <p>Eine kritische Analyse der verwirrenden und inkonsistenten Modellbezeichnungen von Sonys Xperia-Smartphone-Reihe. Der Autor argumentiert, dass dieses &#39;Modellchaos&#39; ein wesentlicher Grund für die schlechten Verkaufszahlen der ansonsten geschätzten Geräte ist und analysiert auch die nur mäßig erfolgreichen Versuche Sonys, die Namensgebung zu vereinfachen.</p>
          
          
          <p><strong>Hauptthemen:</strong> Smartphones, Sony, Xperia, Produktstrategie, Marketing, Markenführung</p>
          
          
          
          <p><strong>Schwierigkeitsgrad:</strong> beginner</p>
          
        </div>
        
        
        <p>Ich mag meine Differenzen mit Sony haben, aber trotzdem bin ich nach wie vor großer Fan der Smartphone-Serie von Sony: Xperia. Sony hat sich bisher immer ein wenig von der Masse abgehoben und mir war bisher nicht ganz klar, warum Sony mit seinen Smartphones so schlechte Verkaufszahlen einfährt. Die compact-Serie z.B. ist eines der selten gewordenen kleinen Smartphones, das auch in meine winzigen spillerigen Kinderfinger passt. Es bringt außerde eine recht passable Noise-Reduction mit und ist wie ganz selbstverständlich wasserdicht. Und das zu einem bisher immer sehr gutem Preis. Trotzdem ist der Absatz nach wie vor miserabel. Woran liegt das? Vermutlich an dem Dschungel aus Modellbezeichnungen der jeden ambitionierten Käufer verschreckt.</p>
<p><img src="/2020/2020-02-24-sonys-xperia-modellchaos/images/xperia-1-700x387.png" alt=""></p>
<p>Sony Xperia Modellübersicht von 2012 bis 2020</p>
<p>Sony stellt seit 2012, nach der Trennung von Ericsson, seine Geräte wieder unter eigenem Namen her. In den letzten 8 Jahren hat Sony weit über 80 Modelle vorgestellt. Allein in 2012, dem ersten Jahr der <em>Unabhängigkeit</em>, hat Sony seine Käufer mit 16 Typenbezeichnungen überrascht. Im Laufe der Jahre kam noch einige dazu, allerdings ohne erkennbares System.</p>
<p>Wie z.B. die Geräte der Mittelklasseserie &ldquo;M&rdquo;: Das M3 wurde ausgelassen, das M4 gabe s nur als &ldquo;aqua&rdquo;-Modell (also wasserdicht). Bei einer anderen (!) Mittelklasseserie namens &ldquo;C&rdquo; gibt es auch eine Lücke: C - C3 - C4 - C5 ultra. Naja&hellip; und so weiter, und so fort. Es gibt keine Modellreihe, bis auf die Low-End-Serie L, in der Sony eine Benamung konsequent durchzieht. Es scheint fast so, als gäbe es einen Jour Fixe, bei dem die Produktmanager die Typenbezeichnung würfeln.</p>
<p>Sony hat das offenbar erkannt und in 2019 angekündigt, die Bennunung zu vereinfachen:</p>
<blockquote>
<p><em>[&hellip;] we simplified our naming by using numbers for easier positioning of our product line up [&hellip;]</em></p>
<p><a href="https://sonyreconsidered.com/sony-mobile-reveals-why-they-named-their-new-phone-xperia-5-a6bba194beb8">https://sonyreconsidered.com/sony-mobile-reveals-why-they-named-their-new-phone-xperia-5-a6bba194beb8</a></p></blockquote>
<p>Und wie sieht das in der Praxis aus? Das <strong>Xperia 1</strong> ist nun das neue High-End-Modell. Das <strong>Xperia 10</strong> gehört zur Mittelklasse, mitsamt dem 10 Plus - die gehobene Mittelklasse. Daneben gibt es ein <strong>Xperia 5 -</strong> ebenfalls High-End und das <strong>Xperia 8</strong>, wiederum Mittelklasse. 1, 5, 8 und 10. Noch Fragen? Die Nachfolger für 2020 wurden übrigens auch schon angekündigt: <strong>1 Mark II</strong> und <strong>10 Mark II.</strong> Und damit Sony seiner wirren Markenstragie treu bleibt wurde Ende Februar auch ein <strong>Xperia Pro</strong> angekündigt.</p>

        
        
        <div class="tags">
          <p><strong>Tags:</strong> modelle, smartphones, sony, xperia</p>
        </div>
        
      ]]></content:encoded>
      
      
      
      <category>blog</category>
      
      
      
      
      <media:content url="https://nickyreinert.de/images/posts/placeholder.jpg" type="image/jpeg">
        <media:title>Sonys Xperia Modellchaos - Titelbild</media:title>
      </media:content>
      
      
      
      
      <dc:subject>Lesezeit: 5 Minuten</dc:subject>
      
      
      
      <dc:type>opinion_piece</dc:type>
      
      
    </item>
  </channel>
</rss>